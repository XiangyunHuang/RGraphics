<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 5 章 数据操作手 | 数据科学与 R 语言</title>
  <meta name="description" content="数据操作、数据分析、数据建模、动态报告和数据可视化" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="第 5 章 数据操作手 | 数据科学与 R 语言" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/xiangyun/RGraphics/" />
  
  <meta property="og:description" content="数据操作、数据分析、数据建模、动态报告和数据可视化" />
  <meta name="github-repo" content="XiangyunHuang/RGraphics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 5 章 数据操作手 | 数据科学与 R 语言" />
  
  <meta name="twitter:description" content="数据操作、数据分析、数据建模、动态报告和数据可视化" />
  

<meta name="author" content="黄湘云" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-import.html"/>
<link rel="next" href="data-tibble.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-7.2.1/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-7.2.1/highcharts.js"></script>
<script src="libs/highcharts-7.2.1/highcharts-3d.js"></script>
<script src="libs/highcharts-7.2.1/highcharts-more.js"></script>
<script src="libs/highcharts-7.2.1/modules/stock.js"></script>
<script src="libs/highcharts-7.2.1/modules/map.js"></script>
<script src="libs/highcharts-7.2.1/modules/annotations.js"></script>
<script src="libs/highcharts-7.2.1/modules/boost.js"></script>
<script src="libs/highcharts-7.2.1/modules/data.js"></script>
<script src="libs/highcharts-7.2.1/modules/drag-panes.js"></script>
<script src="libs/highcharts-7.2.1/modules/drilldown.js"></script>
<script src="libs/highcharts-7.2.1/modules/item-series.js"></script>
<script src="libs/highcharts-7.2.1/modules/offline-exporting.js"></script>
<script src="libs/highcharts-7.2.1/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-7.2.1/modules/exporting.js"></script>
<script src="libs/highcharts-7.2.1/modules/export-data.js"></script>
<script src="libs/highcharts-7.2.1/modules/funnel.js"></script>
<script src="libs/highcharts-7.2.1/modules/heatmap.js"></script>
<script src="libs/highcharts-7.2.1/modules/treemap.js"></script>
<script src="libs/highcharts-7.2.1/modules/sankey.js"></script>
<script src="libs/highcharts-7.2.1/modules/organization.js"></script>
<script src="libs/highcharts-7.2.1/modules/solid-gauge.js"></script>
<script src="libs/highcharts-7.2.1/modules/streamgraph.js"></script>
<script src="libs/highcharts-7.2.1/modules/sunburst.js"></script>
<script src="libs/highcharts-7.2.1/modules/vector.js"></script>
<script src="libs/highcharts-7.2.1/modules/wordcloud.js"></script>
<script src="libs/highcharts-7.2.1/modules/xrange.js"></script>
<script src="libs/highcharts-7.2.1/modules/tilemap.js"></script>
<script src="libs/highcharts-7.2.1/modules/venn.js"></script>
<script src="libs/highcharts-7.2.1/modules/gantt.js"></script>
<script src="libs/highcharts-7.2.1/modules/timeline.js"></script>
<script src="libs/highcharts-7.2.1/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-7.2.1/modules/bullet.js"></script>
<script src="libs/highcharts-7.2.1/modules/coloraxis.js"></script>
<script src="libs/highcharts-7.2.1/plugins/motion.js"></script>
<script src="libs/highcharts-7.2.1/custom/reset.js"></script>
<script src="libs/highchart-binding-0.7.0.9001/highchart.js"></script>
<script src="libs/d3-5.7.0/d3.min.js"></script>
<script src="libs/d3-lasso-0.0.5/d3-lasso.min.js"></script>
<link href="libs/ggiraphjs-0.2.0/styles.css" rel="stylesheet" />
<script src="libs/ggiraphjs-0.2.0/ggiraphjs.min.js"></script>
<script src="libs/girafe-binding-0.7.0/girafe.js"></script>
<script src="libs/dagre-0.0.1/dagre.min.js"></script>
<script src="libs/lodash-3.7.0/lodash.js"></script>
<script src="libs/nomnoml-0.2.0/nomnoml.js"></script>
<script src="libs/nomnoml-binding-0.1.0.9001/nomnoml.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">数据可视化与R语言</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>欢迎</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i>Why R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-read-this-book"><i class="fa fa-check"></i>目标读者</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#Getting-Help-with-R"><i class="fa fa-check"></i>获取帮助</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#history-of-r"><i class="fa fa-check"></i>发展历史</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i>记号约定</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#session-info"><i class="fa fa-check"></i>运行环境</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>前言</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-talk-about"><i class="fa fa-check"></i>关于本书</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#structure-of-book"><i class="fa fa-check"></i>本书结构</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-author"><i class="fa fa-check"></i>关于作者</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>1</b> 安装与配置</a><ul>
<li class="chapter" data-level="1.1" data-path="setup.html"><a href="setup.html#repo-install"><i class="fa fa-check"></i><b>1.1</b> 仓库安装</a><ul>
<li class="chapter" data-level="1.1.1" data-path="setup.html"><a href="setup.html#ubuntu"><i class="fa fa-check"></i><b>1.1.1</b> Ubuntu</a></li>
<li class="chapter" data-level="1.1.2" data-path="setup.html"><a href="setup.html#centos"><i class="fa fa-check"></i><b>1.1.2</b> CentOS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="setup.html"><a href="setup.html#source-install"><i class="fa fa-check"></i><b>1.2</b> 源码安装</a><ul>
<li class="chapter" data-level="1.2.1" data-path="setup.html"><a href="setup.html#ubuntu-1"><i class="fa fa-check"></i><b>1.2.1</b> Ubuntu</a></li>
<li class="chapter" data-level="1.2.2" data-path="setup.html"><a href="setup.html#centos-1"><i class="fa fa-check"></i><b>1.2.2</b> CentOS</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="setup.html"><a href="setup.html#ninja-install"><i class="fa fa-check"></i><b>1.3</b> 忍者安装</a></li>
<li class="chapter" data-level="1.4" data-path="setup.html"><a href="setup.html#settings"><i class="fa fa-check"></i><b>1.4</b> 配置</a><ul>
<li class="chapter" data-level="1.4.1" data-path="setup.html"><a href="setup.html#init-session"><i class="fa fa-check"></i><b>1.4.1</b> 初始会话 <code>.Rprofile</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="setup.html"><a href="setup.html#environ-vars"><i class="fa fa-check"></i><b>1.4.2</b> 环境变量 <code>.Renviron</code></a></li>
<li class="chapter" data-level="1.4.3" data-path="setup.html"><a href="setup.html#make-vars"><i class="fa fa-check"></i><b>1.4.3</b> 编译选项 <code>Makevars</code></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="setup.html"><a href="setup.html#command-line-arguments"><i class="fa fa-check"></i><b>1.5</b> 命令行参数</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="files.html"><a href="files.html"><i class="fa fa-check"></i><b>2</b> 文件管理员</a><ul>
<li class="chapter" data-level="2.1" data-path="files.html"><a href="files.html#list"><i class="fa fa-check"></i><b>2.1</b> 查看文件</a></li>
<li class="chapter" data-level="2.2" data-path="files.html"><a href="files.html#manipulation"><i class="fa fa-check"></i><b>2.2</b> 操作文件</a></li>
<li class="chapter" data-level="2.3" data-path="files.html"><a href="files.html#compression"><i class="fa fa-check"></i><b>2.3</b> 压缩文件</a></li>
<li class="chapter" data-level="2.4" data-path="files.html"><a href="files.html#paths"><i class="fa fa-check"></i><b>2.4</b> 路径操作</a></li>
<li class="chapter" data-level="2.5" data-path="files.html"><a href="files.html#find"><i class="fa fa-check"></i><b>2.5</b> 查找文件</a></li>
<li class="chapter" data-level="2.6" data-path="files.html"><a href="files.html#permissions"><i class="fa fa-check"></i><b>2.6</b> 文件权限</a></li>
<li class="chapter" data-level="2.7" data-path="files.html"><a href="files.html#locale"><i class="fa fa-check"></i><b>2.7</b> 区域设置</a></li>
<li class="chapter" data-level="2.8" data-path="files.html"><a href="files.html#process"><i class="fa fa-check"></i><b>2.8</b> 进程管理</a></li>
<li class="chapter" data-level="2.9" data-path="files.html"><a href="files.html#system-commands"><i class="fa fa-check"></i><b>2.9</b> 系统命令</a></li>
<li class="chapter" data-level="2.10" data-path="files.html"><a href="files.html#time"><i class="fa fa-check"></i><b>2.10</b> 时间管理</a></li>
<li class="chapter" data-level="2.11" data-path="files.html"><a href="files.html#package"><i class="fa fa-check"></i><b>2.11</b> R 包管理</a></li>
<li class="chapter" data-level="2.12" data-path="files.html"><a href="files.html#lookup-function"><i class="fa fa-check"></i><b>2.12</b> 查找函数</a></li>
<li class="chapter" data-level="2.13" data-path="files.html"><a href="files.html#files-session-info"><i class="fa fa-check"></i><b>2.13</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-objects.html"><a href="data-objects.html"><i class="fa fa-check"></i><b>3</b> 对象在哪里</a><ul>
<li class="chapter" data-level="3.1" data-path="data-objects.html"><a href="data-objects.html#subsec:typeof"><i class="fa fa-check"></i><b>3.1</b> 类型</a></li>
<li class="chapter" data-level="3.2" data-path="data-objects.html"><a href="data-objects.html#subsec:date-time"><i class="fa fa-check"></i><b>3.2</b> 日期</a></li>
<li class="chapter" data-level="3.3" data-path="data-objects.html"><a href="data-objects.html#subsec:null"><i class="fa fa-check"></i><b>3.3</b> 空值</a></li>
<li class="chapter" data-level="3.4" data-path="data-objects.html"><a href="data-objects.html#subsec:character"><i class="fa fa-check"></i><b>3.4</b> 字符串</a></li>
<li class="chapter" data-level="3.5" data-path="data-objects.html"><a href="data-objects.html#subsec:expression"><i class="fa fa-check"></i><b>3.5</b> 表达式</a></li>
<li class="chapter" data-level="3.6" data-path="data-objects.html"><a href="data-objects.html#oop-matrix"><i class="fa fa-check"></i><b>3.6</b> 矩阵</a></li>
<li class="chapter" data-level="3.7" data-path="data-objects.html"><a href="data-objects.html#oop-array"><i class="fa fa-check"></i><b>3.7</b> 数组</a></li>
<li class="chapter" data-level="3.8" data-path="data-objects.html"><a href="data-objects.html#oop-data.frame"><i class="fa fa-check"></i><b>3.8</b> 数据框</a></li>
<li class="chapter" data-level="3.9" data-path="data-objects.html"><a href="data-objects.html#oop-table"><i class="fa fa-check"></i><b>3.9</b> 表格</a></li>
<li class="chapter" data-level="3.10" data-path="data-objects.html"><a href="data-objects.html#oop-list"><i class="fa fa-check"></i><b>3.10</b> 列表</a></li>
<li class="chapter" data-level="3.11" data-path="data-objects.html"><a href="data-objects.html#oop-ts"><i class="fa fa-check"></i><b>3.11</b> 时间序列</a></li>
<li class="chapter" data-level="3.12" data-path="data-objects.html"><a href="data-objects.html#oop-sf"><i class="fa fa-check"></i><b>3.12</b> 空间数据</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>4</b> 数据搬运工</a><ul>
<li class="chapter" data-level="4.1" data-path="data-import.html"><a href="data-import.html#import-data"><i class="fa fa-check"></i><b>4.1</b> 导入数据</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-import.html"><a href="data-import.html#scan-file"><i class="fa fa-check"></i><b>4.1.1</b> <code>scan</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="data-import.html"><a href="data-import.html#read-write-table"><i class="fa fa-check"></i><b>4.1.2</b> <code>read.table</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="data-import.html"><a href="data-import.html#read-write-lines"><i class="fa fa-check"></i><b>4.1.3</b> <code>readLines</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="data-import.html"><a href="data-import.html#read-save-rds"><i class="fa fa-check"></i><b>4.1.4</b> <code>readRDS</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-import.html"><a href="data-import.html#other-data-source"><i class="fa fa-check"></i><b>4.2</b> 其它数据格式</a></li>
<li class="chapter" data-level="4.3" data-path="data-import.html"><a href="data-import.html#import-large-dataset"><i class="fa fa-check"></i><b>4.3</b> 导入大数据集</a></li>
<li class="chapter" data-level="4.4" data-path="data-import.html"><a href="data-import.html#import-data-from-database"><i class="fa fa-check"></i><b>4.4</b> 从数据库导入</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-import.html"><a href="data-import.html#postgresql"><i class="fa fa-check"></i><b>4.4.1</b> PostgreSQL</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-import.html"><a href="data-import.html#mysql"><i class="fa fa-check"></i><b>4.4.2</b> MySQL</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-import.html"><a href="data-import.html#spark"><i class="fa fa-check"></i><b>4.4.3</b> Spark</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-import.html"><a href="data-import.html#batch-import-data"><i class="fa fa-check"></i><b>4.5</b> 批量导入数据</a></li>
<li class="chapter" data-level="4.6" data-path="data-import.html"><a href="data-import.html#batch-export-data"><i class="fa fa-check"></i><b>4.6</b> 批量导出数据</a></li>
<li class="chapter" data-level="4.7" data-path="data-import.html"><a href="data-import.html#export-data"><i class="fa fa-check"></i><b>4.7</b> 导出数据</a><ul>
<li class="chapter" data-level="4.7.1" data-path="data-import.html"><a href="data-import.html#export-output"><i class="fa fa-check"></i><b>4.7.1</b> 导出运行结果</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-import.html"><a href="data-import.html#export-data-object"><i class="fa fa-check"></i><b>4.7.2</b> 导出数据对象</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-import.html"><a href="data-import.html#dm-session-info"><i class="fa fa-check"></i><b>4.8</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-frame.html"><a href="data-frame.html"><i class="fa fa-check"></i><b>5</b> 数据操作手</a><ul>
<li class="chapter" data-level="5.1" data-path="data-frame.html"><a href="data-frame.html#show"><i class="fa fa-check"></i><b>5.1</b> 查看数据</a></li>
<li class="chapter" data-level="5.2" data-path="data-frame.html"><a href="data-frame.html#base-reshape"><i class="fa fa-check"></i><b>5.2</b> 数据变形</a></li>
<li class="chapter" data-level="5.3" data-path="data-frame.html"><a href="data-frame.html#base-transform"><i class="fa fa-check"></i><b>5.3</b> 数据转换</a></li>
<li class="chapter" data-level="5.4" data-path="data-frame.html"><a href="data-frame.html#base-subset"><i class="fa fa-check"></i><b>5.4</b> 提取子集</a></li>
<li class="chapter" data-level="5.5" data-path="data-frame.html"><a href="data-frame.html#base-order"><i class="fa fa-check"></i><b>5.5</b> 按列排序</a></li>
<li class="chapter" data-level="5.6" data-path="data-frame.html"><a href="data-frame.html#base-split"><i class="fa fa-check"></i><b>5.6</b> 数据拆分</a></li>
<li class="chapter" data-level="5.7" data-path="data-frame.html"><a href="data-frame.html#base-merge"><i class="fa fa-check"></i><b>5.7</b> 数据合并</a></li>
<li class="chapter" data-level="5.8" data-path="data-frame.html"><a href="data-frame.html#base-duplicated"><i class="fa fa-check"></i><b>5.8</b> 数据去重</a></li>
<li class="chapter" data-level="5.9" data-path="data-frame.html"><a href="data-frame.html#base-missing"><i class="fa fa-check"></i><b>5.9</b> 数据缺失</a></li>
<li class="chapter" data-level="5.10" data-path="data-frame.html"><a href="data-frame.html#base-aggregate"><i class="fa fa-check"></i><b>5.10</b> 数据聚合</a></li>
<li class="chapter" data-level="5.11" data-path="data-frame.html"><a href="data-frame.html#base-table"><i class="fa fa-check"></i><b>5.11</b> 表格统计</a></li>
<li class="chapter" data-level="5.12" data-path="data-frame.html"><a href="data-frame.html#base-index"><i class="fa fa-check"></i><b>5.12</b> 索引访问</a></li>
<li class="chapter" data-level="5.13" data-path="data-frame.html"><a href="data-frame.html#base-array"><i class="fa fa-check"></i><b>5.13</b> 多维数组</a></li>
<li class="chapter" data-level="5.14" data-path="data-frame.html"><a href="data-frame.html#base-others"><i class="fa fa-check"></i><b>5.14</b> 其它操作</a><ul>
<li class="chapter" data-level="5.14.1" data-path="data-frame.html"><a href="data-frame.html#relist-or-unlist"><i class="fa fa-check"></i><b>5.14.1</b> 列表属性</a></li>
<li class="chapter" data-level="5.14.2" data-path="data-frame.html"><a href="data-frame.html#stack-or-unstack"><i class="fa fa-check"></i><b>5.14.2</b> 堆叠向量</a></li>
<li class="chapter" data-level="5.14.3" data-path="data-frame.html"><a href="data-frame.html#class-or-unclass"><i class="fa fa-check"></i><b>5.14.3</b> 属性转化</a></li>
<li class="chapter" data-level="5.14.4" data-path="data-frame.html"><a href="data-frame.html#attach-or-detach"><i class="fa fa-check"></i><b>5.14.4</b> 绑定环境</a></li>
<li class="chapter" data-level="5.14.5" data-path="data-frame.html"><a href="data-frame.html#with-or-within"><i class="fa fa-check"></i><b>5.14.5</b> 数据环境</a></li>
</ul></li>
<li class="chapter" data-level="5.15" data-path="data-frame.html"><a href="data-frame.html#dm-base-session-info"><i class="fa fa-check"></i><b>5.15</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-tibble.html"><a href="data-tibble.html"><i class="fa fa-check"></i><b>6</b> 净土化操作</a><ul>
<li class="chapter" data-level="6.1" data-path="data-tibble.html"><a href="data-tibble.html#common-operations"><i class="fa fa-check"></i><b>6.1</b> 常用操作</a><ul>
<li class="chapter" data-level="6.1.1" data-path="data-tibble.html"><a href="data-tibble.html#tibble-show"><i class="fa fa-check"></i><b>6.1.1</b> 查看</a></li>
<li class="chapter" data-level="6.1.2" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-filter"><i class="fa fa-check"></i><b>6.1.2</b> 筛选</a></li>
<li class="chapter" data-level="6.1.3" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-arrange"><i class="fa fa-check"></i><b>6.1.3</b> 排序</a></li>
<li class="chapter" data-level="6.1.4" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-summarise"><i class="fa fa-check"></i><b>6.1.4</b> 聚合</a></li>
<li class="chapter" data-level="6.1.5" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-merge"><i class="fa fa-check"></i><b>6.1.5</b> 合并</a></li>
<li class="chapter" data-level="6.1.6" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-mutate"><i class="fa fa-check"></i><b>6.1.6</b> 变换</a></li>
<li class="chapter" data-level="6.1.7" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-duplicated"><i class="fa fa-check"></i><b>6.1.7</b> 去重</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-tibble.html"><a href="data-tibble.html#common-dataframe-operations"><i class="fa fa-check"></i><b>6.2</b> 高频问题</a><ul>
<li class="chapter" data-level="6.2.1" data-path="data-tibble.html"><a href="data-tibble.html#create-empty-dataframe"><i class="fa fa-check"></i><b>6.2.1</b> 初始化数据框</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-tibble.html"><a href="data-tibble.html#remove-missing-values"><i class="fa fa-check"></i><b>6.2.2</b> 移除缺失记录</a></li>
<li class="chapter" data-level="6.2.3" data-path="data-tibble.html"><a href="data-tibble.html#coerce-data-type"><i class="fa fa-check"></i><b>6.2.3</b> 数据类型转化</a></li>
<li class="chapter" data-level="6.2.4" data-path="data-tibble.html"><a href="data-tibble.html#cross-group-by"><i class="fa fa-check"></i><b>6.2.4</b> 跨列分组求和</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-tibble.html"><a href="data-tibble.html#pipe-manipulation"><i class="fa fa-check"></i><b>6.3</b> 管道操作</a></li>
<li class="chapter" data-level="6.4" data-path="data-tibble.html"><a href="data-tibble.html#dm-dplyr-rsession"><i class="fa fa-check"></i><b>6.4</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-table.html"><a href="data-table.html"><i class="fa fa-check"></i><b>7</b> 高级数据操作</a><ul>
<li class="chapter" data-level="7.1" data-path="data-table.html"><a href="data-table.html#subsec:select-j"><i class="fa fa-check"></i><b>7.1</b> 选择</a></li>
<li class="chapter" data-level="7.2" data-path="data-table.html"><a href="data-table.html#subsec:filter-i"><i class="fa fa-check"></i><b>7.2</b> 过滤</a></li>
<li class="chapter" data-level="7.3" data-path="data-table.html"><a href="data-table.html#subsec:mutate-j"><i class="fa fa-check"></i><b>7.3</b> 变换</a></li>
<li class="chapter" data-level="7.4" data-path="data-table.html"><a href="data-table.html#subsec:summarise-j"><i class="fa fa-check"></i><b>7.4</b> 聚合</a></li>
<li class="chapter" data-level="7.5" data-path="data-table.html"><a href="data-table.html#subsec:duplicated-i"><i class="fa fa-check"></i><b>7.5</b> 去重</a></li>
<li class="chapter" data-level="7.6" data-path="data-table.html"><a href="data-table.html#subsec:setname"><i class="fa fa-check"></i><b>7.6</b> 命名</a></li>
<li class="chapter" data-level="7.7" data-path="data-table.html"><a href="data-table.html#subsec:order-by-j"><i class="fa fa-check"></i><b>7.7</b> 排序</a></li>
<li class="chapter" data-level="7.8" data-path="data-table.html"><a href="data-table.html#subsec:reshape"><i class="fa fa-check"></i><b>7.8</b> 变形</a></li>
<li class="chapter" data-level="7.9" data-path="data-table.html"><a href="data-table.html#subsec:group-by"><i class="fa fa-check"></i><b>7.9</b> 分组</a></li>
<li class="chapter" data-level="7.10" data-path="data-table.html"><a href="data-table.html#subsec:merge"><i class="fa fa-check"></i><b>7.10</b> 合并</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-parallel.html"><a href="data-parallel.html"><i class="fa fa-check"></i><b>8</b> 并行化操作</a><ul>
<li class="chapter" data-level="8.1" data-path="data-parallel.html"><a href="data-parallel.html#apply"><i class="fa fa-check"></i><b>8.1</b> apply</a></li>
<li class="chapter" data-level="8.2" data-path="data-parallel.html"><a href="data-parallel.html#map-reduce"><i class="fa fa-check"></i><b>8.2</b> MapReduce</a></li>
<li class="chapter" data-level="8.3" data-path="data-parallel.html"><a href="data-parallel.html#parallel"><i class="fa fa-check"></i><b>8.3</b> parallel</a></li>
<li class="chapter" data-level="8.4" data-path="data-parallel.html"><a href="data-parallel.html#rmpi"><i class="fa fa-check"></i><b>8.4</b> Rmpi</a></li>
<li class="chapter" data-level="8.5" data-path="data-parallel.html"><a href="data-parallel.html#gpur"><i class="fa fa-check"></i><b>8.5</b> gpuR</a></li>
<li class="chapter" data-level="8.6" data-path="data-parallel.html"><a href="data-parallel.html#dm-parallel-session-info"><i class="fa fa-check"></i><b>8.6</b> 本章运行环境</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html"><i class="fa fa-check"></i><b>9</b> 字符串操作</a><ul>
<li class="chapter" data-level="9.1" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-count"><i class="fa fa-check"></i><b>9.1</b> 字符数统计</a></li>
<li class="chapter" data-level="9.2" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-translations"><i class="fa fa-check"></i><b>9.2</b> 字符串翻译</a></li>
<li class="chapter" data-level="9.3" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-concatenate"><i class="fa fa-check"></i><b>9.3</b> 字符串连接</a></li>
<li class="chapter" data-level="9.4" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-strsplit"><i class="fa fa-check"></i><b>9.4</b> 字符串拆分</a></li>
<li class="chapter" data-level="9.5" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-match"><i class="fa fa-check"></i><b>9.5</b> 字符串匹配</a></li>
<li class="chapter" data-level="9.6" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-search"><i class="fa fa-check"></i><b>9.6</b> 字符串查询</a></li>
<li class="chapter" data-level="9.7" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-replacement"><i class="fa fa-check"></i><b>9.7</b> 字符串替换</a></li>
<li class="chapter" data-level="9.8" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-extract"><i class="fa fa-check"></i><b>9.8</b> 字符串提取</a></li>
<li class="chapter" data-level="9.9" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:named-capture"><i class="fa fa-check"></i><b>9.9</b> 命名捕捉</a></li>
<li class="chapter" data-level="9.10" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:exact-match"><i class="fa fa-check"></i><b>9.10</b> 精确匹配</a></li>
<li class="chapter" data-level="9.11" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:fuzzy-match"><i class="fa fa-check"></i><b>9.11</b> 模糊匹配</a></li>
<li class="chapter" data-level="9.12" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:replace"><i class="fa fa-check"></i><b>9.12</b> 高级的替换</a></li>
<li class="chapter" data-level="9.13" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:extract"><i class="fa fa-check"></i><b>9.13</b> 高级的提取</a></li>
<li class="chapter" data-level="9.14" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#other-string-op"><i class="fa fa-check"></i><b>9.14</b> 其它操作</a><ul>
<li class="chapter" data-level="9.14.1" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#strwrap"><i class="fa fa-check"></i><b>9.14.1</b> strwrap</a></li>
<li class="chapter" data-level="9.14.2" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#strtrim"><i class="fa fa-check"></i><b>9.14.2</b> strtrim</a></li>
<li class="chapter" data-level="9.14.3" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#strrep"><i class="fa fa-check"></i><b>9.14.3</b> strrep</a></li>
<li class="chapter" data-level="9.14.4" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#trimws"><i class="fa fa-check"></i><b>9.14.4</b> trimws</a></li>
</ul></li>
<li class="chapter" data-level="9.15" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#string-session-info"><i class="fa fa-check"></i><b>9.15</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html"><i class="fa fa-check"></i><b>10</b> 正则表达式</a><ul>
<li class="chapter" data-level="10.1" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#character-constants"><i class="fa fa-check"></i><b>10.1</b> 字符常量</a></li>
<li class="chapter" data-level="10.2" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#environments"><i class="fa fa-check"></i><b>10.2</b> 软件环境</a></li>
<li class="chapter" data-level="10.3" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#foundations"><i class="fa fa-check"></i><b>10.3</b> 基本概念</a></li>
<li class="chapter" data-level="10.4" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#match"><i class="fa fa-check"></i><b>10.4</b> 字符串匹配</a></li>
<li class="chapter" data-level="10.5" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#concatenation"><i class="fa fa-check"></i><b>10.5</b> 级联表达式</a></li>
<li class="chapter" data-level="10.6" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#backreference"><i class="fa fa-check"></i><b>10.6</b> 反向引用</a></li>
<li class="chapter" data-level="10.7" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#named-capture"><i class="fa fa-check"></i><b>10.7</b> 命名捕捉</a></li>
<li class="chapter" data-level="10.8" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#comment"><i class="fa fa-check"></i><b>10.8</b> 表达式注释</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dv-plot.html"><a href="dv-plot.html"><i class="fa fa-check"></i><b>11</b> 绘图素材库</a><ul>
<li class="chapter" data-level="11.1" data-path="dv-plot.html"><a href="dv-plot.html#elements"><i class="fa fa-check"></i><b>11.1</b> 基本要素</a><ul>
<li class="chapter" data-level="11.1.1" data-path="dv-plot.html"><a href="dv-plot.html#base-points"><i class="fa fa-check"></i><b>11.1.1</b> 点线</a></li>
<li class="chapter" data-level="11.1.2" data-path="dv-plot.html"><a href="dv-plot.html#base-rect"><i class="fa fa-check"></i><b>11.1.2</b> 区域</a></li>
<li class="chapter" data-level="11.1.3" data-path="dv-plot.html"><a href="dv-plot.html#base-lines"><i class="fa fa-check"></i><b>11.1.3</b> 参考线</a></li>
<li class="chapter" data-level="11.1.4" data-path="dv-plot.html"><a href="dv-plot.html#base-axis"><i class="fa fa-check"></i><b>11.1.4</b> 坐标轴</a></li>
<li class="chapter" data-level="11.1.5" data-path="dv-plot.html"><a href="dv-plot.html#base-tick"><i class="fa fa-check"></i><b>11.1.5</b> 刻度线</a></li>
<li class="chapter" data-level="11.1.6" data-path="dv-plot.html"><a href="dv-plot.html#base-title"><i class="fa fa-check"></i><b>11.1.6</b> 标题</a></li>
<li class="chapter" data-level="11.1.7" data-path="dv-plot.html"><a href="dv-plot.html#base-annotation"><i class="fa fa-check"></i><b>11.1.7</b> 注释</a></li>
<li class="chapter" data-level="11.1.8" data-path="dv-plot.html"><a href="dv-plot.html#base-legend"><i class="fa fa-check"></i><b>11.1.8</b> 图例</a></li>
<li class="chapter" data-level="11.1.9" data-path="dv-plot.html"><a href="dv-plot.html#base-par"><i class="fa fa-check"></i><b>11.1.9</b> 边空</a></li>
<li class="chapter" data-level="11.1.10" data-path="dv-plot.html"><a href="dv-plot.html#base-layer"><i class="fa fa-check"></i><b>11.1.10</b> 图层</a></li>
<li class="chapter" data-level="11.1.11" data-path="dv-plot.html"><a href="dv-plot.html#base-layout"><i class="fa fa-check"></i><b>11.1.11</b> 布局</a></li>
<li class="chapter" data-level="11.1.12" data-path="dv-plot.html"><a href="dv-plot.html#base-combine"><i class="fa fa-check"></i><b>11.1.12</b> 组合</a></li>
<li class="chapter" data-level="11.1.13" data-path="dv-plot.html"><a href="dv-plot.html#base-screen"><i class="fa fa-check"></i><b>11.1.13</b> 分屏</a></li>
<li class="chapter" data-level="11.1.14" data-path="dv-plot.html"><a href="dv-plot.html#identify-locator"><i class="fa fa-check"></i><b>11.1.14</b> 交互</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="dv-plot.html"><a href="dv-plot.html#plot-gallary"><i class="fa fa-check"></i><b>11.2</b> 统计图形</a><ul>
<li class="chapter" data-level="11.2.1" data-path="dv-plot.html"><a href="dv-plot.html#plot-bar"><i class="fa fa-check"></i><b>11.2.1</b> 条形图</a></li>
<li class="chapter" data-level="11.2.2" data-path="dv-plot.html"><a href="dv-plot.html#plot-hist"><i class="fa fa-check"></i><b>11.2.2</b> 直方图</a></li>
<li class="chapter" data-level="11.2.3" data-path="dv-plot.html"><a href="dv-plot.html#plot-density"><i class="fa fa-check"></i><b>11.2.3</b> 密度图</a></li>
<li class="chapter" data-level="11.2.4" data-path="dv-plot.html"><a href="dv-plot.html#plot-ecdf"><i class="fa fa-check"></i><b>11.2.4</b> 经验图</a></li>
<li class="chapter" data-level="11.2.5" data-path="dv-plot.html"><a href="dv-plot.html#plot-qqnorm"><i class="fa fa-check"></i><b>11.2.5</b> QQ 图</a></li>
<li class="chapter" data-level="11.2.6" data-path="dv-plot.html"><a href="dv-plot.html#plot-ts"><i class="fa fa-check"></i><b>11.2.6</b> 时序图</a></li>
<li class="chapter" data-level="11.2.7" data-path="dv-plot.html"><a href="dv-plot.html#plot-pie"><i class="fa fa-check"></i><b>11.2.7</b> 饼图</a></li>
<li class="chapter" data-level="11.2.8" data-path="dv-plot.html"><a href="dv-plot.html#plot-stem-leaf"><i class="fa fa-check"></i><b>11.2.8</b> 茎叶图</a></li>
<li class="chapter" data-level="11.2.9" data-path="dv-plot.html"><a href="dv-plot.html#plot-scatter"><i class="fa fa-check"></i><b>11.2.9</b> 散点图</a></li>
<li class="chapter" data-level="11.2.10" data-path="dv-plot.html"><a href="dv-plot.html#base-jitter"><i class="fa fa-check"></i><b>11.2.10</b> 抖动图</a></li>
<li class="chapter" data-level="11.2.11" data-path="dv-plot.html"><a href="dv-plot.html#plot-box"><i class="fa fa-check"></i><b>11.2.11</b> 箱线图</a></li>
<li class="chapter" data-level="11.2.12" data-path="dv-plot.html"><a href="dv-plot.html#error-bars"><i class="fa fa-check"></i><b>11.2.12</b> 残差图</a></li>
<li class="chapter" data-level="11.2.13" data-path="dv-plot.html"><a href="dv-plot.html#plot-violin"><i class="fa fa-check"></i><b>11.2.13</b> 提琴图</a></li>
<li class="chapter" data-level="11.2.14" data-path="dv-plot.html"><a href="dv-plot.html#plot-contour"><i class="fa fa-check"></i><b>11.2.14</b> 轮廓图</a></li>
<li class="chapter" data-level="11.2.15" data-path="dv-plot.html"><a href="dv-plot.html#plot-line"><i class="fa fa-check"></i><b>11.2.15</b> 折线图</a></li>
<li class="chapter" data-level="11.2.16" data-path="dv-plot.html"><a href="dv-plot.html#function"><i class="fa fa-check"></i><b>11.2.16</b> 函数图</a></li>
<li class="chapter" data-level="11.2.17" data-path="dv-plot.html"><a href="dv-plot.html#plot-mosaic"><i class="fa fa-check"></i><b>11.2.17</b> 马赛克图</a></li>
<li class="chapter" data-level="11.2.18" data-path="dv-plot.html"><a href="dv-plot.html#plot-dotchart"><i class="fa fa-check"></i><b>11.2.18</b> 克利夫兰点图</a></li>
<li class="chapter" data-level="11.2.19" data-path="dv-plot.html"><a href="dv-plot.html#plot-matrix"><i class="fa fa-check"></i><b>11.2.19</b> 矩阵图</a></li>
<li class="chapter" data-level="11.2.20" data-path="dv-plot.html"><a href="dv-plot.html#plot-radar"><i class="fa fa-check"></i><b>11.2.20</b> 雷达图</a></li>
<li class="chapter" data-level="11.2.21" data-path="dv-plot.html"><a href="dv-plot.html#plot-rose"><i class="fa fa-check"></i><b>11.2.21</b> 玫瑰图</a></li>
<li class="chapter" data-level="11.2.22" data-path="dv-plot.html"><a href="dv-plot.html#plot-map"><i class="fa fa-check"></i><b>11.2.22</b> 地形图</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="dv-plot.html"><a href="dv-plot.html#plot-session-info"><i class="fa fa-check"></i><b>11.3</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html"><i class="fa fa-check"></i><b>12</b> 数据可视化</a><ul>
<li class="chapter" data-level="12.1" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#intro-ggplot2"><i class="fa fa-check"></i><b>12.1</b> 基础语法</a><ul>
<li class="chapter" data-level="12.1.1" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-layer"><i class="fa fa-check"></i><b>12.1.1</b> 图层</a></li>
<li class="chapter" data-level="12.1.2" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-theme"><i class="fa fa-check"></i><b>12.1.2</b> 主题</a></li>
<li class="chapter" data-level="12.1.3" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-color"><i class="fa fa-check"></i><b>12.1.3</b> 配色</a></li>
<li class="chapter" data-level="12.1.4" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-scale"><i class="fa fa-check"></i><b>12.1.4</b> 刻度</a></li>
<li class="chapter" data-level="12.1.5" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-annotate"><i class="fa fa-check"></i><b>12.1.5</b> 注释</a></li>
<li class="chapter" data-level="12.1.6" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-legend"><i class="fa fa-check"></i><b>12.1.6</b> 图例</a></li>
<li class="chapter" data-level="12.1.7" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-grid"><i class="fa fa-check"></i><b>12.1.7</b> 组合</a></li>
<li class="chapter" data-level="12.1.8" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-coord"><i class="fa fa-check"></i><b>12.1.8</b> 坐标系</a></li>
<li class="chapter" data-level="12.1.9" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-axes"><i class="fa fa-check"></i><b>12.1.9</b> 坐标轴</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-gallary"><i class="fa fa-check"></i><b>12.2</b> 统计图形</a><ul>
<li class="chapter" data-level="12.2.1" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-scatter"><i class="fa fa-check"></i><b>12.2.1</b> 散点图</a></li>
<li class="chapter" data-level="12.2.2" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-boxplot"><i class="fa fa-check"></i><b>12.2.2</b> 箱线图</a></li>
<li class="chapter" data-level="12.2.3" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-barplot"><i class="fa fa-check"></i><b>12.2.3</b> 条形图</a></li>
<li class="chapter" data-level="12.2.4" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-line"><i class="fa fa-check"></i><b>12.2.4</b> 折线图</a></li>
<li class="chapter" data-level="12.2.5" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-histogram"><i class="fa fa-check"></i><b>12.2.5</b> 直方图</a></li>
<li class="chapter" data-level="12.2.6" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-violin"><i class="fa fa-check"></i><b>12.2.6</b> 提琴图</a></li>
<li class="chapter" data-level="12.2.7" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-jitter"><i class="fa fa-check"></i><b>12.2.7</b> 抖动图</a></li>
<li class="chapter" data-level="12.2.8" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-ridge"><i class="fa fa-check"></i><b>12.2.8</b> 密度图</a></li>
<li class="chapter" data-level="12.2.9" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-rose"><i class="fa fa-check"></i><b>12.2.9</b> 玫瑰图</a></li>
<li class="chapter" data-level="12.2.10" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-wordcloud"><i class="fa fa-check"></i><b>12.2.10</b> 词云图</a></li>
<li class="chapter" data-level="12.2.11" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#calendar-map"><i class="fa fa-check"></i><b>12.2.11</b> 日历图</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-session-info"><i class="fa fa-check"></i><b>12.3</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dv-plotly.html"><a href="dv-plotly.html"><i class="fa fa-check"></i><b>13</b> 交互式图形</a><ul>
<li class="chapter" data-level="13.1" data-path="dv-plotly.html"><a href="dv-plotly.html#plotly"><i class="fa fa-check"></i><b>13.1</b> plotly</a></li>
<li class="chapter" data-level="13.2" data-path="dv-plotly.html"><a href="dv-plotly.html#sec:pie"><i class="fa fa-check"></i><b>13.2</b> 饼图</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="dv-plot3d.html"><a href="dv-plot3d.html"><i class="fa fa-check"></i><b>14</b> 三维可视化</a><ul>
<li class="chapter" data-level="14.1" data-path="dv-plot3d.html"><a href="dv-plot3d.html#pie-3d"><i class="fa fa-check"></i><b>14.1</b> 饼图</a></li>
<li class="chapter" data-level="14.2" data-path="dv-plot3d.html"><a href="dv-plot3d.html#bar-3d"><i class="fa fa-check"></i><b>14.2</b> 柱形图</a></li>
<li class="chapter" data-level="14.3" data-path="dv-plot3d.html"><a href="dv-plot3d.html#scatter-3d"><i class="fa fa-check"></i><b>14.3</b> 散点图</a></li>
<li class="chapter" data-level="14.4" data-path="dv-plot3d.html"><a href="dv-plot3d.html#curve-3d"><i class="fa fa-check"></i><b>14.4</b> 函数图</a></li>
<li class="chapter" data-level="14.5" data-path="dv-plot3d.html"><a href="dv-plot3d.html#persp-3d"><i class="fa fa-check"></i><b>14.5</b> 透视图</a></li>
<li class="chapter" data-level="14.6" data-path="dv-plot3d.html"><a href="dv-plot3d.html#tikz"><i class="fa fa-check"></i><b>14.6</b> TikZ 绘图</a></li>
<li class="chapter" data-level="14.7" data-path="dv-plot3d.html"><a href="dv-plot3d.html#export-save"><i class="fa fa-check"></i><b>14.7</b> 图形导出</a></li>
<li class="chapter" data-level="14.8" data-path="dv-plot3d.html"><a href="dv-plot3d.html#plot3d-sessionInfo"><i class="fa fa-check"></i><b>14.8</b> 软件信息</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="dv-colors-fonts.html"><a href="dv-colors-fonts.html"><i class="fa fa-check"></i><b>15</b> 色彩与字体</a><ul>
<li class="chapter" data-level="15.1" data-path="dv-colors-fonts.html"><a href="dv-colors-fonts.html#colors-in-r"><i class="fa fa-check"></i><b>15.1</b> 颜色</a></li>
<li class="chapter" data-level="15.2" data-path="dv-colors-fonts.html"><a href="dv-colors-fonts.html#choose-colors"><i class="fa fa-check"></i><b>15.2</b> 配色</a><ul>
<li class="chapter" data-level="15.2.1" data-path="dv-colors-fonts.html"><a href="dv-colors-fonts.html#colourlovers"><i class="fa fa-check"></i><b>15.2.1</b> colourlovers</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="dv-colors-fonts.html"><a href="dv-colors-fonts.html#fonts"><i class="fa fa-check"></i><b>15.3</b> 字体</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dv-highcharter.html"><a href="dv-highcharter.html"><i class="fa fa-check"></i><b>16</b> highcharter 图形</a><ul>
<li class="chapter" data-level="16.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-line"><i class="fa fa-check"></i><b>16.1</b> 折线图</a><ul>
<li class="chapter" data-level="16.1.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:simple-hc-line"><i class="fa fa-check"></i><b>16.1.1</b> 简单折线图</a></li>
<li class="chapter" data-level="16.1.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:group-hc-line"><i class="fa fa-check"></i><b>16.1.2</b> 分组折线图</a></li>
<li class="chapter" data-level="16.1.3" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:ts-hc-line"><i class="fa fa-check"></i><b>16.1.3</b> 时间序列图</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-scatter"><i class="fa fa-check"></i><b>16.2</b> 散点图</a><ul>
<li class="chapter" data-level="16.2.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:simple-hc-scatter"><i class="fa fa-check"></i><b>16.2.1</b> 简单散点图</a></li>
<li class="chapter" data-level="16.2.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:group-hc-scatter"><i class="fa fa-check"></i><b>16.2.2</b> 分组散点图</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-bar"><i class="fa fa-check"></i><b>16.3</b> 条形图</a><ul>
<li class="chapter" data-level="16.3.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:simple-hc-bar"><i class="fa fa-check"></i><b>16.3.1</b> 简单条形图</a></li>
<li class="chapter" data-level="16.3.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:dodge-hc-bar"><i class="fa fa-check"></i><b>16.3.2</b> 复合条形图</a></li>
<li class="chapter" data-level="16.3.3" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:stack-hc-bar"><i class="fa fa-check"></i><b>16.3.3</b> 堆积条形图</a></li>
<li class="chapter" data-level="16.3.4" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:fill-hc-bar"><i class="fa fa-check"></i><b>16.3.4</b> 百分比条形图</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-boxplot"><i class="fa fa-check"></i><b>16.4</b> 箱线图</a><ul>
<li class="chapter" data-level="16.4.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:simple-hc-boxplot"><i class="fa fa-check"></i><b>16.4.1</b> 简单箱线图</a></li>
<li class="chapter" data-level="16.4.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subssubsec:dodge-hc-boxplot"><i class="fa fa-check"></i><b>16.4.2</b> 复合箱线图</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-density"><i class="fa fa-check"></i><b>16.5</b> 密度图</a></li>
<li class="chapter" data-level="16.6" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-hist"><i class="fa fa-check"></i><b>16.6</b> 直方图</a></li>
<li class="chapter" data-level="16.7" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-survival"><i class="fa fa-check"></i><b>16.7</b> 生存图</a></li>
<li class="chapter" data-level="16.8" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-heatmap"><i class="fa fa-check"></i><b>16.8</b> 等高图</a></li>
<li class="chapter" data-level="16.9" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-corrplot"><i class="fa fa-check"></i><b>16.9</b> 相关图</a></li>
<li class="chapter" data-level="16.10" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-treemap"><i class="fa fa-check"></i><b>16.10</b> 矩阵图</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="dv-lattice.html"><a href="dv-lattice.html"><i class="fa fa-check"></i><b>17</b> Lattice 图形</a><ul>
<li class="chapter" data-level="17.1" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:boxplot"><i class="fa fa-check"></i><b>17.1</b> 箱线图</a></li>
<li class="chapter" data-level="17.2" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:line"><i class="fa fa-check"></i><b>17.2</b> 折线图</a></li>
<li class="chapter" data-level="17.3" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:smooth"><i class="fa fa-check"></i><b>17.3</b> 平滑图</a></li>
<li class="chapter" data-level="17.4" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:dotplot"><i class="fa fa-check"></i><b>17.4</b> 点图</a></li>
<li class="chapter" data-level="17.5" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:step"><i class="fa fa-check"></i><b>17.5</b> 阶梯图</a></li>
<li class="chapter" data-level="17.6" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:facet"><i class="fa fa-check"></i><b>17.6</b> 分面图</a></li>
<li class="chapter" data-level="17.7" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:contour"><i class="fa fa-check"></i><b>17.7</b> 等高线图</a></li>
<li class="chapter" data-level="17.8" data-path="dv-lattice.html"><a href="dv-lattice.html#sub:map"><i class="fa fa-check"></i><b>17.8</b> 地图</a></li>
<li class="chapter" data-level="17.9" data-path="dv-lattice.html"><a href="dv-lattice.html#sub:cluster"><i class="fa fa-check"></i><b>17.9</b> 聚类图</a></li>
<li class="chapter" data-level="17.10" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:lattice-sessioninfo"><i class="fa fa-check"></i><b>17.10</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="dv-network.html"><a href="dv-network.html"><i class="fa fa-check"></i><b>18</b> 网络数据</a></li>
<li class="chapter" data-level="19" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html"><i class="fa fa-check"></i><b>19</b> 时空可视化</a><ul>
<li class="chapter" data-level="19.1" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#map"><i class="fa fa-check"></i><b>19.1</b> 地图</a><ul>
<li class="chapter" data-level="19.1.1" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#project-orientation"><i class="fa fa-check"></i><b>19.1.1</b> 投影和观察方位</a></li>
<li class="chapter" data-level="19.1.2" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#USA-crime-rates"><i class="fa fa-check"></i><b>19.1.2</b> 美国各州犯罪率</a></li>
<li class="chapter" data-level="19.1.3" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#fiji-earthquake-map"><i class="fa fa-check"></i><b>19.1.3</b> 斐济地震带</a></li>
<li class="chapter" data-level="19.1.4" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#USA-unemployment-ratio"><i class="fa fa-check"></i><b>19.1.4</b> 美国各城镇失业率</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#spatial-op"><i class="fa fa-check"></i><b>19.2</b> 空间数据对象</a><ul>
<li class="chapter" data-level="19.2.1" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#ggplot2-sp"><i class="fa fa-check"></i><b>19.2.1</b> sp</a></li>
<li class="chapter" data-level="19.2.2" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#ggplot2-raster"><i class="fa fa-check"></i><b>19.2.2</b> raster</a></li>
<li class="chapter" data-level="19.2.3" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#ggplot2-sf"><i class="fa fa-check"></i><b>19.2.3</b> sf</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="dynamic-documents.html"><a href="dynamic-documents.html"><i class="fa fa-check"></i><b>20</b> 动态性文档</a><ul>
<li class="chapter" data-level="" data-path="dynamic-documents.html"><a href="dynamic-documents.html#r-call-python"><i class="fa fa-check"></i>R 调用 Python</a></li>
<li class="chapter" data-level="20.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown"><i class="fa fa-check"></i><b>20.1</b> Markdown</a><ul>
<li class="chapter" data-level="20.1.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown-list"><i class="fa fa-check"></i><b>20.1.1</b> 列表</a></li>
<li class="chapter" data-level="20.1.2" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown-emphasis"><i class="fa fa-check"></i><b>20.1.2</b> 强调</a></li>
<li class="chapter" data-level="20.1.3" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown-quote"><i class="fa fa-check"></i><b>20.1.3</b> 引用</a></li>
<li class="chapter" data-level="20.1.4" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown-table"><i class="fa fa-check"></i><b>20.1.4</b> 表格</a></li>
<li class="chapter" data-level="20.1.5" data-path="dynamic-documents.html"><a href="dynamic-documents.html#image"><i class="fa fa-check"></i><b>20.1.5</b> 图片</a></li>
<li class="chapter" data-level="20.1.6" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown-math"><i class="fa fa-check"></i><b>20.1.6</b> 公式</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="dynamic-documents.html"><a href="dynamic-documents.html#pandoc-markdown"><i class="fa fa-check"></i><b>20.2</b> Pandoc’s Markdown</a></li>
<li class="chapter" data-level="20.3" data-path="dynamic-documents.html"><a href="dynamic-documents.html#r-markdown"><i class="fa fa-check"></i><b>20.3</b> R Markdown</a><ul>
<li class="chapter" data-level="20.3.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#语法高亮"><i class="fa fa-check"></i><b>20.3.1</b> 语法高亮</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="dynamic-documents.html"><a href="dynamic-documents.html#table-style"><i class="fa fa-check"></i><b>20.4</b> 表格样式</a><ul>
<li class="chapter" data-level="20.4.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#table-html"><i class="fa fa-check"></i><b>20.4.1</b> HTML 样式</a></li>
<li class="chapter" data-level="20.4.2" data-path="dynamic-documents.html"><a href="dynamic-documents.html#table-latex"><i class="fa fa-check"></i><b>20.4.2</b> LaTeX 样式</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="dynamic-documents.html"><a href="dynamic-documents.html#rmarkdown-addins"><i class="fa fa-check"></i><b>20.5</b> 插件</a></li>
<li class="chapter" data-level="20.6" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:rmarkdown"><i class="fa fa-check"></i><b>20.6</b> 报告</a></li>
<li class="chapter" data-level="20.7" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:pagedown"><i class="fa fa-check"></i><b>20.7</b> 简历</a></li>
<li class="chapter" data-level="20.8" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:bookdown"><i class="fa fa-check"></i><b>20.8</b> 书籍</a></li>
<li class="chapter" data-level="20.9" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:blogdown"><i class="fa fa-check"></i><b>20.9</b> 网站</a></li>
<li class="chapter" data-level="20.10" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:dashboard"><i class="fa fa-check"></i><b>20.10</b> Shiny</a></li>
<li class="chapter" data-level="20.11" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:xaringan"><i class="fa fa-check"></i><b>20.11</b> 幻灯片</a></li>
<li class="chapter" data-level="20.12" data-path="dynamic-documents.html"><a href="dynamic-documents.html#sec:animation-video"><i class="fa fa-check"></i><b>20.12</b> 动画视频</a></li>
<li class="chapter" data-level="20.13" data-path="dynamic-documents.html"><a href="dynamic-documents.html#sec:diagram-table"><i class="fa fa-check"></i><b>20.13</b> 图表</a><ul>
<li class="chapter" data-level="20.13.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#tikz-1"><i class="fa fa-check"></i><b>20.13.1</b> TikZ</a></li>
<li class="chapter" data-level="20.13.2" data-path="dynamic-documents.html"><a href="dynamic-documents.html#dot"><i class="fa fa-check"></i><b>20.13.2</b> DOT</a></li>
<li class="chapter" data-level="20.13.3" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:uml"><i class="fa fa-check"></i><b>20.13.3</b> UML</a></li>
<li class="chapter" data-level="20.13.4" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:table"><i class="fa fa-check"></i><b>20.13.4</b> 表格</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="animated-graphics.html"><a href="animated-graphics.html"><i class="fa fa-check"></i><b>21</b> 动画</a><ul>
<li class="chapter" data-level="21.1" data-path="animated-graphics.html"><a href="animated-graphics.html#gganimate"><i class="fa fa-check"></i><b>21.1</b> gganimate</a></li>
<li class="chapter" data-level="21.2" data-path="animated-graphics.html"><a href="animated-graphics.html#magick"><i class="fa fa-check"></i><b>21.2</b> magick</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="interactive-graphics.html"><a href="interactive-graphics.html"><i class="fa fa-check"></i><b>22</b> 交互式图形</a><ul>
<li class="chapter" data-level="22.1" data-path="interactive-graphics.html"><a href="interactive-graphics.html#rgl"><i class="fa fa-check"></i><b>22.1</b> rgl</a></li>
<li class="chapter" data-level="22.2" data-path="interactive-graphics.html"><a href="interactive-graphics.html#plotly-1"><i class="fa fa-check"></i><b>22.2</b> plotly</a><ul>
<li class="chapter" data-level="22.2.1" data-path="interactive-graphics.html"><a href="interactive-graphics.html#plotly-histogram"><i class="fa fa-check"></i><b>22.2.1</b> 直方图</a></li>
<li class="chapter" data-level="22.2.2" data-path="interactive-graphics.html"><a href="interactive-graphics.html#plotly-map"><i class="fa fa-check"></i><b>22.2.2</b> 地图</a></li>
<li class="chapter" data-level="22.2.3" data-path="interactive-graphics.html"><a href="interactive-graphics.html#plotly-heatmap"><i class="fa fa-check"></i><b>22.2.3</b> 热力图</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="interactive-graphics.html"><a href="interactive-graphics.html#leaflet"><i class="fa fa-check"></i><b>22.3</b> leaflet</a></li>
<li class="chapter" data-level="22.4" data-path="interactive-graphics.html"><a href="interactive-graphics.html#highcharter"><i class="fa fa-check"></i><b>22.4</b> highcharter</a><ul>
<li class="chapter" data-level="22.4.1" data-path="interactive-graphics.html"><a href="interactive-graphics.html#highcharter-ts"><i class="fa fa-check"></i><b>22.4.1</b> 时序图</a></li>
<li class="chapter" data-level="22.4.2" data-path="interactive-graphics.html"><a href="interactive-graphics.html#highcharter-scatter"><i class="fa fa-check"></i><b>22.4.2</b> 散点图</a></li>
<li class="chapter" data-level="22.4.3" data-path="interactive-graphics.html"><a href="interactive-graphics.html#highcharter-map"><i class="fa fa-check"></i><b>22.4.3</b> 地图</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="interactive-graphics.html"><a href="interactive-graphics.html#vegawidget"><i class="fa fa-check"></i><b>22.5</b> vegawidget</a></li>
<li class="chapter" data-level="22.6" data-path="interactive-graphics.html"><a href="interactive-graphics.html#network"><i class="fa fa-check"></i><b>22.6</b> 网络图</a></li>
<li class="chapter" data-level="22.7" data-path="interactive-graphics.html"><a href="interactive-graphics.html#threejs"><i class="fa fa-check"></i><b>22.7</b> threejs</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="cs-cran-network.html"><a href="cs-cran-network.html"><i class="fa fa-check"></i><b>23</b> 案例：分析 CRAN</a><ul>
<li class="chapter" data-level="23.1" data-path="cs-cran-network.html"><a href="cs-cran-network.html#R-Core-Team"><i class="fa fa-check"></i><b>23.1</b> R 核心团队</a></li>
<li class="chapter" data-level="23.2" data-path="cs-cran-network.html"><a href="cs-cran-network.html#Top-Creators"><i class="fa fa-check"></i><b>23.2</b> 高产的开发者</a></li>
<li class="chapter" data-level="23.3" data-path="cs-cran-network.html"><a href="cs-cran-network.html#R-Package-Developers"><i class="fa fa-check"></i><b>23.3</b> 社区开发者</a></li>
<li class="chapter" data-level="23.4" data-path="cs-cran-network.html"><a href="cs-cran-network.html#first-commit"><i class="fa fa-check"></i><b>23.4</b> 首次贡献 R 包</a></li>
<li class="chapter" data-level="23.5" data-path="cs-cran-network.html"><a href="cs-cran-network.html#Contribution-Network"><i class="fa fa-check"></i><b>23.5</b> 贡献关系网络</a></li>
<li class="chapter" data-level="23.6" data-path="cs-cran-network.html"><a href="cs-cran-network.html#CRAN-Update-Packages"><i class="fa fa-check"></i><b>23.6</b> 更新知多少</a></li>
<li class="chapter" data-level="23.7" data-path="cs-cran-network.html"><a href="cs-cran-network.html#Package-Licenses"><i class="fa fa-check"></i><b>23.7</b> 使用许可证</a></li>
<li class="chapter" data-level="23.8" data-path="cs-cran-network.html"><a href="cs-cran-network.html#r-包增长速度"><i class="fa fa-check"></i><b>23.8</b> R 包增长速度</a></li>
<li class="chapter" data-level="23.9" data-path="cs-cran-network.html"><a href="cs-cran-network.html#Choose-Package"><i class="fa fa-check"></i><b>23.9</b> 选择 R 包</a></li>
<li class="chapter" data-level="23.10" data-path="cs-cran-network.html"><a href="cs-cran-network.html#cs-network-session-info"><i class="fa fa-check"></i><b>23.10</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="99-references.html"><a href="99-references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://r-graphics.netlify.com/" target="blank">Published with netlify</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">数据科学与 R 语言</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-manipulator" class="section level1">
<h1><span class="header-section-number">第 5 章</span> 数据操作手</h1>
<blockquote>
<p>参考 Data Manipulation With R <span class="citation">(Spector <a href="#ref-Spector_2008_Manipulation" role="doc-biblioref">2008</a>)</span> 重新捋一遍本章
本章的操作对象是 data.frame</p>
</blockquote>
<div class="sidebar">
<p>介绍 Base R 提供的数据操作，关于采用 Base R 还是 tidyverse 做数据操作的 <a href="https://d.cosx.org/d/420697">讨论</a></p>
<p>数据操作的动画展示参考 <a href="https://github.com/gadenbuie/tidyexplain" class="uri">https://github.com/gadenbuie/tidyexplain</a> 提供 Base R 对应的实现</p>
</div>
<p>什么是 Base R? Base R 指的是 R 语言/软件的核心组件，由 R Core Team 维护</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="data-frame.html#cb215-1"></a>Pkgs &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">list.files</span>(<span class="kw">R.home</span>(<span class="st">&quot;library&quot;</span>)), <span class="cf">function</span>(x)</span>
<span id="cb215-2"><a href="data-frame.html#cb215-2"></a>  <span class="kw">packageDescription</span>(<span class="dt">pkg =</span> x, <span class="dt">fields =</span> <span class="st">&quot;Priority&quot;</span>))</span>
<span id="cb215-3"><a href="data-frame.html#cb215-3"></a><span class="kw">names</span>(Pkgs[Pkgs <span class="op">==</span><span class="st"> &quot;base&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(Pkgs)])</span>
<span id="cb215-4"><a href="data-frame.html#cb215-4"></a><span class="co">#&gt;  [1] &quot;base&quot;      &quot;compiler&quot;  &quot;datasets&quot;  &quot;graphics&quot;  &quot;grDevices&quot; &quot;grid&quot;     </span></span>
<span id="cb215-5"><a href="data-frame.html#cb215-5"></a><span class="co">#&gt;  [7] &quot;methods&quot;   &quot;parallel&quot;  &quot;splines&quot;   &quot;stats&quot;     &quot;stats4&quot;    &quot;tcltk&quot;    </span></span>
<span id="cb215-6"><a href="data-frame.html#cb215-6"></a><span class="co">#&gt; [13] &quot;tools&quot;     &quot;utils&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="data-frame.html#cb216-1"></a><span class="kw">names</span>(Pkgs[Pkgs <span class="op">==</span><span class="st"> &quot;recommended&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(Pkgs)])</span>
<span id="cb216-2"><a href="data-frame.html#cb216-2"></a><span class="co">#&gt;  [1] &quot;boot&quot;       &quot;class&quot;      &quot;cluster&quot;    &quot;codetools&quot;  &quot;foreign&quot;   </span></span>
<span id="cb216-3"><a href="data-frame.html#cb216-3"></a><span class="co">#&gt;  [6] &quot;KernSmooth&quot; &quot;lattice&quot;    &quot;MASS&quot;       &quot;Matrix&quot;     &quot;mgcv&quot;      </span></span>
<span id="cb216-4"><a href="data-frame.html#cb216-4"></a><span class="co">#&gt; [11] &quot;nlme&quot;       &quot;nnet&quot;       &quot;rpart&quot;      &quot;spatial&quot;    &quot;survival&quot;</span></span></code></pre></div>
<p>数据变形，分组统计聚合等，用以作为模型的输入，绘图的对象，操作的数据对象是数据框(data.frame)类型的，而且如果没有特别说明，文中出现的数据集都是 Base R 内置的，第三方 R 包或者来源于网上的数据集都会加以说明。</p>
<div id="show" class="section level2">
<h2><span class="header-section-number">5.1</span> 查看数据</h2>
<p>查看属性</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="data-frame.html#cb217-1"></a><span class="kw">str</span>(iris)</span>
<span id="cb217-2"><a href="data-frame.html#cb217-2"></a><span class="co">#&gt; &#39;data.frame&#39;:    150 obs. of  5 variables:</span></span>
<span id="cb217-3"><a href="data-frame.html#cb217-3"></a><span class="co">#&gt;  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...</span></span>
<span id="cb217-4"><a href="data-frame.html#cb217-4"></a><span class="co">#&gt;  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...</span></span>
<span id="cb217-5"><a href="data-frame.html#cb217-5"></a><span class="co">#&gt;  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...</span></span>
<span id="cb217-6"><a href="data-frame.html#cb217-6"></a><span class="co">#&gt;  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...</span></span>
<span id="cb217-7"><a href="data-frame.html#cb217-7"></a><span class="co">#&gt;  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1..</span></span></code></pre></div>
<p>查看部分数据集</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="data-frame.html#cb218-1"></a><span class="kw">head</span>(iris, <span class="dv">5</span>)</span>
<span id="cb218-2"><a href="data-frame.html#cb218-2"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb218-3"><a href="data-frame.html#cb218-3"></a><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span id="cb218-4"><a href="data-frame.html#cb218-4"></a><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span id="cb218-5"><a href="data-frame.html#cb218-5"></a><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span id="cb218-6"><a href="data-frame.html#cb218-6"></a><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span id="cb218-7"><a href="data-frame.html#cb218-7"></a><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span id="cb218-8"><a href="data-frame.html#cb218-8"></a><span class="kw">tail</span>(iris, <span class="dv">5</span>)</span>
<span id="cb218-9"><a href="data-frame.html#cb218-9"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span></span>
<span id="cb218-10"><a href="data-frame.html#cb218-10"></a><span class="co">#&gt; 146          6.7         3.0          5.2         2.3 virginica</span></span>
<span id="cb218-11"><a href="data-frame.html#cb218-11"></a><span class="co">#&gt; 147          6.3         2.5          5.0         1.9 virginica</span></span>
<span id="cb218-12"><a href="data-frame.html#cb218-12"></a><span class="co">#&gt; 148          6.5         3.0          5.2         2.0 virginica</span></span>
<span id="cb218-13"><a href="data-frame.html#cb218-13"></a><span class="co">#&gt; 149          6.2         3.4          5.4         2.3 virginica</span></span>
<span id="cb218-14"><a href="data-frame.html#cb218-14"></a><span class="co">#&gt; 150          5.9         3.0          5.1         1.8 virginica</span></span></code></pre></div>
<p>查看文件前（后）5行</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb219-1"><a href="data-frame.html#cb219-1"></a><span class="fu">head</span> -n 5 test.csv</span>
<span id="cb219-2"><a href="data-frame.html#cb219-2"></a><span class="fu">tail</span> -n 5 test.csv</span></code></pre></div>
<p>对象的类型，存储方式</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="data-frame.html#cb220-1"></a><span class="kw">class</span>(iris)</span>
<span id="cb220-2"><a href="data-frame.html#cb220-2"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span>
<span id="cb220-3"><a href="data-frame.html#cb220-3"></a><span class="kw">mode</span>(iris)</span>
<span id="cb220-4"><a href="data-frame.html#cb220-4"></a><span class="co">#&gt; [1] &quot;list&quot;</span></span>
<span id="cb220-5"><a href="data-frame.html#cb220-5"></a><span class="kw">typeof</span>(iris)</span>
<span id="cb220-6"><a href="data-frame.html#cb220-6"></a><span class="co">#&gt; [1] &quot;list&quot;</span></span></code></pre></div>
<p>查看对象在R环境中所占空间的大小</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="data-frame.html#cb221-1"></a><span class="kw">object.size</span>(iris)</span>
<span id="cb221-2"><a href="data-frame.html#cb221-2"></a><span class="co">#&gt; 7256 bytes</span></span>
<span id="cb221-3"><a href="data-frame.html#cb221-3"></a><span class="kw">object.size</span>(letters)</span>
<span id="cb221-4"><a href="data-frame.html#cb221-4"></a><span class="co">#&gt; 1712 bytes</span></span>
<span id="cb221-5"><a href="data-frame.html#cb221-5"></a><span class="kw">object.size</span>(ls)</span>
<span id="cb221-6"><a href="data-frame.html#cb221-6"></a><span class="co">#&gt; 89880 bytes</span></span>
<span id="cb221-7"><a href="data-frame.html#cb221-7"></a><span class="kw">format</span>(<span class="kw">object.size</span>(library), <span class="dt">units =</span> <span class="st">&quot;auto&quot;</span>)</span>
<span id="cb221-8"><a href="data-frame.html#cb221-8"></a><span class="co">#&gt; [1] &quot;1.8 Mb&quot;</span></span></code></pre></div>
</div>
<div id="base-reshape" class="section level2">
<h2><span class="header-section-number">5.2</span> 数据变形</h2>
<p>重复测量数据的变形 Reshape Grouped Data，将宽格式 wide 的数据框变长格式 long的，反之也行。reshape 还支持正则表达式</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="data-frame.html#cb222-1"></a><span class="kw">str</span>(Indometh)</span>
<span id="cb222-2"><a href="data-frame.html#cb222-2"></a><span class="co">#&gt; Classes &#39;nfnGroupedData&#39;, &#39;nfGroupedData&#39;, &#39;groupedData&#39; and &#39;data.frame&#39;:   66 obs. of  3 variables:</span></span>
<span id="cb222-3"><a href="data-frame.html#cb222-3"></a><span class="co">#&gt;  $ Subject: Ord.factor w/ 6 levels &quot;1&quot;&lt;&quot;4&quot;&lt;&quot;2&quot;&lt;&quot;5&quot;&lt;..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb222-4"><a href="data-frame.html#cb222-4"></a><span class="co">#&gt;  $ time   : num  0.25 0.5 0.75 1 1.25 2 3 4 5 6 ...</span></span>
<span id="cb222-5"><a href="data-frame.html#cb222-5"></a><span class="co">#&gt;  $ conc   : num  1.5 0.94 0.78 0.48 0.37 0.19 0.12 0.11 0.08 0.07 ...</span></span>
<span id="cb222-6"><a href="data-frame.html#cb222-6"></a><span class="co">#&gt;  - attr(*, &quot;formula&quot;)=Class &#39;formula&#39;  language conc ~ time | Subject</span></span>
<span id="cb222-7"><a href="data-frame.html#cb222-7"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_EmptyEnv&gt; </span></span>
<span id="cb222-8"><a href="data-frame.html#cb222-8"></a><span class="co">#&gt;  - attr(*, &quot;labels&quot;)=List of 2</span></span>
<span id="cb222-9"><a href="data-frame.html#cb222-9"></a><span class="co">#&gt;   ..$ x: chr &quot;Time since drug administration&quot;</span></span>
<span id="cb222-10"><a href="data-frame.html#cb222-10"></a><span class="co">#&gt;   ..$ y: chr &quot;Indomethacin concentration&quot;</span></span>
<span id="cb222-11"><a href="data-frame.html#cb222-11"></a><span class="co">#&gt;  - attr(*, &quot;units&quot;)=List of 2</span></span>
<span id="cb222-12"><a href="data-frame.html#cb222-12"></a><span class="co">#&gt;   ..$ x: chr &quot;(hr)&quot;</span></span>
<span id="cb222-13"><a href="data-frame.html#cb222-13"></a><span class="co">#&gt;   ..$ y: chr &quot;(mcg/ml)&quot;</span></span>
<span id="cb222-14"><a href="data-frame.html#cb222-14"></a><span class="kw">summary</span>(Indometh)</span>
<span id="cb222-15"><a href="data-frame.html#cb222-15"></a><span class="co">#&gt;  Subject      time            conc       </span></span>
<span id="cb222-16"><a href="data-frame.html#cb222-16"></a><span class="co">#&gt;  1:11    Min.   :0.250   Min.   :0.0500  </span></span>
<span id="cb222-17"><a href="data-frame.html#cb222-17"></a><span class="co">#&gt;  4:11    1st Qu.:0.750   1st Qu.:0.1100  </span></span>
<span id="cb222-18"><a href="data-frame.html#cb222-18"></a><span class="co">#&gt;  2:11    Median :2.000   Median :0.3400  </span></span>
<span id="cb222-19"><a href="data-frame.html#cb222-19"></a><span class="co">#&gt;  5:11    Mean   :2.886   Mean   :0.5918  </span></span>
<span id="cb222-20"><a href="data-frame.html#cb222-20"></a><span class="co">#&gt;  6:11    3rd Qu.:5.000   3rd Qu.:0.8325  </span></span>
<span id="cb222-21"><a href="data-frame.html#cb222-21"></a><span class="co">#&gt;  3:11    Max.   :8.000   Max.   :2.7200</span></span></code></pre></div>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="data-frame.html#cb223-1"></a><span class="co"># 长的变宽</span></span>
<span id="cb223-2"><a href="data-frame.html#cb223-2"></a>wide &lt;-<span class="st"> </span><span class="kw">reshape</span>(Indometh,</span>
<span id="cb223-3"><a href="data-frame.html#cb223-3"></a>  <span class="dt">v.names =</span> <span class="st">&quot;conc&quot;</span>, <span class="dt">idvar =</span> <span class="st">&quot;Subject&quot;</span>,</span>
<span id="cb223-4"><a href="data-frame.html#cb223-4"></a>  <span class="dt">timevar =</span> <span class="st">&quot;time&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;wide&quot;</span></span>
<span id="cb223-5"><a href="data-frame.html#cb223-5"></a>)</span>
<span id="cb223-6"><a href="data-frame.html#cb223-6"></a>wide[, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]</span>
<span id="cb223-7"><a href="data-frame.html#cb223-7"></a><span class="co">#&gt;    Subject conc.0.25 conc.0.5 conc.0.75 conc.1 conc.1.25</span></span>
<span id="cb223-8"><a href="data-frame.html#cb223-8"></a><span class="co">#&gt; 1        1      1.50     0.94      0.78   0.48      0.37</span></span>
<span id="cb223-9"><a href="data-frame.html#cb223-9"></a><span class="co">#&gt; 12       2      2.03     1.63      0.71   0.70      0.64</span></span>
<span id="cb223-10"><a href="data-frame.html#cb223-10"></a><span class="co">#&gt; 23       3      2.72     1.49      1.16   0.80      0.80</span></span>
<span id="cb223-11"><a href="data-frame.html#cb223-11"></a><span class="co">#&gt; 34       4      1.85     1.39      1.02   0.89      0.59</span></span>
<span id="cb223-12"><a href="data-frame.html#cb223-12"></a><span class="co">#&gt; 45       5      2.05     1.04      0.81   0.39      0.30</span></span>
<span id="cb223-13"><a href="data-frame.html#cb223-13"></a>....</span>
<span id="cb223-14"><a href="data-frame.html#cb223-14"></a></span>
<span id="cb223-15"><a href="data-frame.html#cb223-15"></a><span class="co"># 宽的变长</span></span>
<span id="cb223-16"><a href="data-frame.html#cb223-16"></a><span class="kw">reshape</span>(wide, <span class="dt">direction =</span> <span class="st">&quot;long&quot;</span>)</span>
<span id="cb223-17"><a href="data-frame.html#cb223-17"></a><span class="co">#&gt;        Subject time conc</span></span>
<span id="cb223-18"><a href="data-frame.html#cb223-18"></a><span class="co">#&gt; 1.0.25       1 0.25 1.50</span></span>
<span id="cb223-19"><a href="data-frame.html#cb223-19"></a><span class="co">#&gt; 2.0.25       2 0.25 2.03</span></span>
<span id="cb223-20"><a href="data-frame.html#cb223-20"></a><span class="co">#&gt; 3.0.25       3 0.25 2.72</span></span>
<span id="cb223-21"><a href="data-frame.html#cb223-21"></a><span class="co">#&gt; 4.0.25       4 0.25 1.85</span></span>
<span id="cb223-22"><a href="data-frame.html#cb223-22"></a><span class="co">#&gt; 5.0.25       5 0.25 2.05</span></span>
<span id="cb223-23"><a href="data-frame.html#cb223-23"></a>....</span></code></pre></div>
<p>宽的格式变成长的格式 <a href="https://stackoverflow.com/questions/2185252" class="uri">https://stackoverflow.com/questions/2185252</a></p>
<p>长的格式变成宽的格式 <a href="https://stackoverflow.com/questions/5890584/" class="uri">https://stackoverflow.com/questions/5890584/</a></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="data-frame.html#cb224-1"></a><span class="kw">set.seed</span>(<span class="dv">45</span>)</span>
<span id="cb224-2"><a href="data-frame.html#cb224-2"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb224-3"><a href="data-frame.html#cb224-3"></a>    <span class="dt">name =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Orange&quot;</span>, <span class="st">&quot;Apple&quot;</span>), <span class="dt">each=</span><span class="dv">4</span>),</span>
<span id="cb224-4"><a href="data-frame.html#cb224-4"></a>    <span class="dt">numbers =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb224-5"><a href="data-frame.html#cb224-5"></a>    <span class="dt">value =</span> <span class="kw">rnorm</span>(<span class="dv">8</span>))</span>
<span id="cb224-6"><a href="data-frame.html#cb224-6"></a>dat</span>
<span id="cb224-7"><a href="data-frame.html#cb224-7"></a><span class="co">#&gt;     name numbers      value</span></span>
<span id="cb224-8"><a href="data-frame.html#cb224-8"></a><span class="co">#&gt; 1 Orange       1  0.3407997</span></span>
<span id="cb224-9"><a href="data-frame.html#cb224-9"></a><span class="co">#&gt; 2 Orange       2 -0.7033403</span></span>
<span id="cb224-10"><a href="data-frame.html#cb224-10"></a><span class="co">#&gt; 3 Orange       3 -0.3795377</span></span>
<span id="cb224-11"><a href="data-frame.html#cb224-11"></a><span class="co">#&gt; 4 Orange       4 -0.7460474</span></span>
<span id="cb224-12"><a href="data-frame.html#cb224-12"></a><span class="co">#&gt; 5  Apple       1 -0.8981073</span></span>
<span id="cb224-13"><a href="data-frame.html#cb224-13"></a><span class="co">#&gt; 6  Apple       2 -0.3347941</span></span>
<span id="cb224-14"><a href="data-frame.html#cb224-14"></a><span class="co">#&gt; 7  Apple       3 -0.5013782</span></span>
<span id="cb224-15"><a href="data-frame.html#cb224-15"></a><span class="co">#&gt; 8  Apple       4 -0.1745357</span></span>
<span id="cb224-16"><a href="data-frame.html#cb224-16"></a></span>
<span id="cb224-17"><a href="data-frame.html#cb224-17"></a><span class="kw">reshape</span>(dat, <span class="dt">idvar =</span> <span class="st">&quot;name&quot;</span>, <span class="dt">timevar =</span> <span class="st">&quot;numbers&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;wide&quot;</span>)</span>
<span id="cb224-18"><a href="data-frame.html#cb224-18"></a><span class="co">#&gt;     name    value.1    value.2    value.3    value.4</span></span>
<span id="cb224-19"><a href="data-frame.html#cb224-19"></a><span class="co">#&gt; 1 Orange  0.3407997 -0.7033403 -0.3795377 -0.7460474</span></span>
<span id="cb224-20"><a href="data-frame.html#cb224-20"></a><span class="co">#&gt; 5  Apple -0.8981073 -0.3347941 -0.5013782 -0.1745357</span></span></code></pre></div>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="data-frame.html#cb225-1"></a><span class="co">## times need not be numeric</span></span>
<span id="cb225-2"><a href="data-frame.html#cb225-2"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">4</span>)),</span>
<span id="cb225-3"><a href="data-frame.html#cb225-3"></a>                 <span class="dt">visit =</span> <span class="kw">I</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Before&quot;</span>,<span class="st">&quot;After&quot;</span>), <span class="dv">4</span>)),</span>
<span id="cb225-4"><a href="data-frame.html#cb225-4"></a>                 <span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">4</span>), <span class="dt">y =</span> <span class="kw">runif</span>(<span class="dv">4</span>))</span>
<span id="cb225-5"><a href="data-frame.html#cb225-5"></a>df</span>
<span id="cb225-6"><a href="data-frame.html#cb225-6"></a><span class="co">#&gt;   id  visit          x          y</span></span>
<span id="cb225-7"><a href="data-frame.html#cb225-7"></a><span class="co">#&gt; 1  1 Before  1.8090374 0.89106978</span></span>
<span id="cb225-8"><a href="data-frame.html#cb225-8"></a><span class="co">#&gt; 2  1  After -0.2301050 0.06920426</span></span>
<span id="cb225-9"><a href="data-frame.html#cb225-9"></a><span class="co">#&gt; 3  2 Before -1.1304182 0.94623103</span></span>
<span id="cb225-10"><a href="data-frame.html#cb225-10"></a><span class="co">#&gt; 4  2  After  0.2159889 0.74850150</span></span>
<span id="cb225-11"><a href="data-frame.html#cb225-11"></a><span class="co">#&gt; 5  3 Before  1.8090374 0.89106978</span></span>
<span id="cb225-12"><a href="data-frame.html#cb225-12"></a><span class="co">#&gt; 6  3  After -0.2301050 0.06920426</span></span>
<span id="cb225-13"><a href="data-frame.html#cb225-13"></a><span class="co">#&gt; 7  4 Before -1.1304182 0.94623103</span></span>
<span id="cb225-14"><a href="data-frame.html#cb225-14"></a><span class="co">#&gt; 8  4  After  0.2159889 0.74850150</span></span>
<span id="cb225-15"><a href="data-frame.html#cb225-15"></a><span class="kw">reshape</span>(df, <span class="dt">timevar =</span> <span class="st">&quot;visit&quot;</span>, <span class="dt">idvar =</span> <span class="st">&quot;id&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;wide&quot;</span>)</span>
<span id="cb225-16"><a href="data-frame.html#cb225-16"></a><span class="co">#&gt;   id  x.Before  y.Before    x.After    y.After</span></span>
<span id="cb225-17"><a href="data-frame.html#cb225-17"></a><span class="co">#&gt; 1  1  1.809037 0.8910698 -0.2301050 0.06920426</span></span>
<span id="cb225-18"><a href="data-frame.html#cb225-18"></a><span class="co">#&gt; 3  2 -1.130418 0.9462310  0.2159889 0.74850150</span></span>
<span id="cb225-19"><a href="data-frame.html#cb225-19"></a><span class="co">#&gt; 5  3  1.809037 0.8910698 -0.2301050 0.06920426</span></span>
<span id="cb225-20"><a href="data-frame.html#cb225-20"></a><span class="co">#&gt; 7  4 -1.130418 0.9462310  0.2159889 0.74850150</span></span>
<span id="cb225-21"><a href="data-frame.html#cb225-21"></a><span class="co">## warns that y is really varying</span></span>
<span id="cb225-22"><a href="data-frame.html#cb225-22"></a><span class="kw">reshape</span>(df, <span class="dt">timevar =</span> <span class="st">&quot;visit&quot;</span>, <span class="dt">idvar =</span> <span class="st">&quot;id&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;wide&quot;</span>, <span class="dt">v.names =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb225-23"><a href="data-frame.html#cb225-23"></a><span class="co">#&gt; Warning in reshapeWide(data, idvar = idvar, timevar = timevar, varying =</span></span>
<span id="cb225-24"><a href="data-frame.html#cb225-24"></a><span class="co">#&gt; varying, : some constant variables (y) are really varying</span></span>
<span id="cb225-25"><a href="data-frame.html#cb225-25"></a><span class="co">#&gt;   id         y  x.Before    x.After</span></span>
<span id="cb225-26"><a href="data-frame.html#cb225-26"></a><span class="co">#&gt; 1  1 0.8910698  1.809037 -0.2301050</span></span>
<span id="cb225-27"><a href="data-frame.html#cb225-27"></a><span class="co">#&gt; 3  2 0.9462310 -1.130418  0.2159889</span></span>
<span id="cb225-28"><a href="data-frame.html#cb225-28"></a><span class="co">#&gt; 5  3 0.8910698  1.809037 -0.2301050</span></span>
<span id="cb225-29"><a href="data-frame.html#cb225-29"></a><span class="co">#&gt; 7  4 0.9462310 -1.130418  0.2159889</span></span></code></pre></div>
<p>更加复杂的例子， gambia 数据集，重塑的效果是使得个体水平的长格式变为村庄水平的宽格式</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="data-frame.html#cb226-1"></a><span class="co"># data(gambia, package = &quot;geoR&quot;)</span></span>
<span id="cb226-2"><a href="data-frame.html#cb226-2"></a><span class="co"># 在线下载数据集</span></span>
<span id="cb226-3"><a href="data-frame.html#cb226-3"></a>gambia &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb226-4"><a href="data-frame.html#cb226-4"></a>  <span class="dt">file =</span></span>
<span id="cb226-5"><a href="data-frame.html#cb226-5"></a>    <span class="kw">paste</span>(<span class="st">&quot;http://www.leg.ufpr.br/lib/exe/fetch.php&quot;</span>,</span>
<span id="cb226-6"><a href="data-frame.html#cb226-6"></a>      <span class="st">&quot;pessoais:paulojus:mbgbook:datasets:gambia.txt&quot;</span>,</span>
<span id="cb226-7"><a href="data-frame.html#cb226-7"></a>      <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span></span>
<span id="cb226-8"><a href="data-frame.html#cb226-8"></a>    ), <span class="dt">header =</span> <span class="ot">TRUE</span></span>
<span id="cb226-9"><a href="data-frame.html#cb226-9"></a>)</span>
<span id="cb226-10"><a href="data-frame.html#cb226-10"></a><span class="kw">head</span>(gambia)</span>
<span id="cb226-11"><a href="data-frame.html#cb226-11"></a><span class="co"># Building a &quot;village-level&quot; data frame</span></span>
<span id="cb226-12"><a href="data-frame.html#cb226-12"></a>ind &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;x&quot;</span>, gambia[, <span class="dv">1</span>], <span class="st">&quot;y&quot;</span>, gambia[, <span class="dv">2</span>], <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb226-13"><a href="data-frame.html#cb226-13"></a>village &lt;-<span class="st"> </span>gambia[<span class="op">!</span><span class="kw">duplicated</span>(ind), <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">7</span><span class="op">:</span><span class="dv">8</span>)]</span>
<span id="cb226-14"><a href="data-frame.html#cb226-14"></a>village<span class="op">$</span>prev &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">tapply</span>(gambia<span class="op">$</span>pos, ind, mean))</span>
<span id="cb226-15"><a href="data-frame.html#cb226-15"></a><span class="kw">head</span>(village)</span></code></pre></div>
</div>
<div id="base-transform" class="section level2">
<h2><span class="header-section-number">5.3</span> 数据转换</h2>
<p>transform 对数据框中的某些列做计算，取对数，将计算的结果单存一列加到数据框中</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="data-frame.html#cb227-1"></a><span class="kw">transform</span>(iris, <span class="dt">scale.sl =</span> (<span class="kw">max</span>(Sepal.Length) <span class="op">-</span><span class="st"> </span>Sepal.Length) <span class="op">/</span><span class="st"> </span>(<span class="kw">max</span>(Sepal.Length) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Sepal.Length)))</span>
<span id="cb227-2"><a href="data-frame.html#cb227-2"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species   scale.sl</span></span>
<span id="cb227-3"><a href="data-frame.html#cb227-3"></a><span class="co">#&gt; 1            5.1         3.5          1.4         0.2     setosa 0.77777778</span></span>
<span id="cb227-4"><a href="data-frame.html#cb227-4"></a><span class="co">#&gt; 2            4.9         3.0          1.4         0.2     setosa 0.83333333</span></span>
<span id="cb227-5"><a href="data-frame.html#cb227-5"></a><span class="co">#&gt; 3            4.7         3.2          1.3         0.2     setosa 0.88888889</span></span>
<span id="cb227-6"><a href="data-frame.html#cb227-6"></a><span class="co">#&gt; 4            4.6         3.1          1.5         0.2     setosa 0.91666667</span></span>
<span id="cb227-7"><a href="data-frame.html#cb227-7"></a><span class="co">#&gt; 5            5.0         3.6          1.4         0.2     setosa 0.80555556</span></span>
<span id="cb227-8"><a href="data-frame.html#cb227-8"></a>....</span></code></pre></div>
<p>验证一下 <code>scale.sl</code> 变量的第一个值</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="data-frame.html#cb228-1"></a>(<span class="kw">max</span>(iris<span class="op">$</span>Sepal.Length) <span class="op">-</span><span class="st"> </span><span class="fl">5.1</span>) <span class="op">/</span><span class="st"> </span>(<span class="kw">max</span>(iris<span class="op">$</span>Sepal.Length) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(iris<span class="op">$</span>Sepal.Length))</span>
<span id="cb228-2"><a href="data-frame.html#cb228-2"></a><span class="co">#&gt; [1] 0.7777778</span></span></code></pre></div>
<div class="sidebar">
<p>Warning: This is a convenience function intended for use interactively. For programming it is better to use the standard subsetting arithmetic functions, and in particular the non-standard evaluation of argument <code>transform</code> can have unanticipated consequences.</p>
</div>
</div>
<div id="base-subset" class="section level2">
<h2><span class="header-section-number">5.4</span> 提取子集</h2>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="data-frame.html#cb229-1"></a><span class="kw">subset</span>(x, subset, select, <span class="dt">drop =</span> <span class="ot">FALSE</span>, ...)</span></code></pre></div>
<p>参数 <code>subset</code>代表行操作，<code>select</code> 代表列操作，函数 <code>subset</code> 从数据框中提取部分数据</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="data-frame.html#cb230-1"></a><span class="kw">subset</span>(iris, Species <span class="op">==</span><span class="st"> &quot;virginica&quot;</span>)</span>
<span id="cb230-2"><a href="data-frame.html#cb230-2"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span></span>
<span id="cb230-3"><a href="data-frame.html#cb230-3"></a><span class="co">#&gt; 101          6.3         3.3          6.0         2.5 virginica</span></span>
<span id="cb230-4"><a href="data-frame.html#cb230-4"></a><span class="co">#&gt; 102          5.8         2.7          5.1         1.9 virginica</span></span>
<span id="cb230-5"><a href="data-frame.html#cb230-5"></a><span class="co">#&gt; 103          7.1         3.0          5.9         2.1 virginica</span></span>
<span id="cb230-6"><a href="data-frame.html#cb230-6"></a><span class="co">#&gt; 104          6.3         2.9          5.6         1.8 virginica</span></span>
<span id="cb230-7"><a href="data-frame.html#cb230-7"></a><span class="co">#&gt; 105          6.5         3.0          5.8         2.2 virginica</span></span>
<span id="cb230-8"><a href="data-frame.html#cb230-8"></a>....</span>
<span id="cb230-9"><a href="data-frame.html#cb230-9"></a><span class="co"># summary(iris$Sepal.Length)  mean(iris$Sepal.Length)</span></span>
<span id="cb230-10"><a href="data-frame.html#cb230-10"></a><span class="co"># 且的逻辑</span></span>
<span id="cb230-11"><a href="data-frame.html#cb230-11"></a><span class="co"># subset(iris, Species == &quot;virginica&quot; &amp; Sepal.Length &gt; 5.84333)</span></span>
<span id="cb230-12"><a href="data-frame.html#cb230-12"></a><span class="kw">subset</span>(iris, Species <span class="op">==</span><span class="st"> &quot;virginica&quot;</span> <span class="op">&amp;</span></span>
<span id="cb230-13"><a href="data-frame.html#cb230-13"></a><span class="st">  </span>Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(Sepal.Length))</span>
<span id="cb230-14"><a href="data-frame.html#cb230-14"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span></span>
<span id="cb230-15"><a href="data-frame.html#cb230-15"></a><span class="co">#&gt; 101          6.3         3.3          6.0         2.5 virginica</span></span>
<span id="cb230-16"><a href="data-frame.html#cb230-16"></a><span class="co">#&gt; 103          7.1         3.0          5.9         2.1 virginica</span></span>
<span id="cb230-17"><a href="data-frame.html#cb230-17"></a><span class="co">#&gt; 104          6.3         2.9          5.6         1.8 virginica</span></span>
<span id="cb230-18"><a href="data-frame.html#cb230-18"></a><span class="co">#&gt; 105          6.5         3.0          5.8         2.2 virginica</span></span>
<span id="cb230-19"><a href="data-frame.html#cb230-19"></a><span class="co">#&gt; 106          7.6         3.0          6.6         2.1 virginica</span></span>
<span id="cb230-20"><a href="data-frame.html#cb230-20"></a>....</span>
<span id="cb230-21"><a href="data-frame.html#cb230-21"></a><span class="co"># 在行的子集范围内</span></span>
<span id="cb230-22"><a href="data-frame.html#cb230-22"></a><span class="kw">subset</span>(iris, Species <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;virginica&quot;</span>, <span class="st">&quot;versicolor&quot;</span>) <span class="op">&amp;</span></span>
<span id="cb230-23"><a href="data-frame.html#cb230-23"></a><span class="st">  </span>Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(Sepal.Length))</span>
<span id="cb230-24"><a href="data-frame.html#cb230-24"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span></span>
<span id="cb230-25"><a href="data-frame.html#cb230-25"></a><span class="co">#&gt; 51           7.0         3.2          4.7         1.4 versicolor</span></span>
<span id="cb230-26"><a href="data-frame.html#cb230-26"></a><span class="co">#&gt; 52           6.4         3.2          4.5         1.5 versicolor</span></span>
<span id="cb230-27"><a href="data-frame.html#cb230-27"></a><span class="co">#&gt; 53           6.9         3.1          4.9         1.5 versicolor</span></span>
<span id="cb230-28"><a href="data-frame.html#cb230-28"></a><span class="co">#&gt; 55           6.5         2.8          4.6         1.5 versicolor</span></span>
<span id="cb230-29"><a href="data-frame.html#cb230-29"></a><span class="co">#&gt; 57           6.3         3.3          4.7         1.6 versicolor</span></span>
<span id="cb230-30"><a href="data-frame.html#cb230-30"></a>....</span>
<span id="cb230-31"><a href="data-frame.html#cb230-31"></a><span class="co"># 在列的子集内 先选中列</span></span>
<span id="cb230-32"><a href="data-frame.html#cb230-32"></a><span class="kw">subset</span>(iris, Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(Sepal.Length),</span>
<span id="cb230-33"><a href="data-frame.html#cb230-33"></a>  <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Species&quot;</span>)</span>
<span id="cb230-34"><a href="data-frame.html#cb230-34"></a>)</span>
<span id="cb230-35"><a href="data-frame.html#cb230-35"></a><span class="co">#&gt;     Sepal.Length    Species</span></span>
<span id="cb230-36"><a href="data-frame.html#cb230-36"></a><span class="co">#&gt; 51           7.0 versicolor</span></span>
<span id="cb230-37"><a href="data-frame.html#cb230-37"></a><span class="co">#&gt; 52           6.4 versicolor</span></span>
<span id="cb230-38"><a href="data-frame.html#cb230-38"></a><span class="co">#&gt; 53           6.9 versicolor</span></span>
<span id="cb230-39"><a href="data-frame.html#cb230-39"></a><span class="co">#&gt; 55           6.5 versicolor</span></span>
<span id="cb230-40"><a href="data-frame.html#cb230-40"></a><span class="co">#&gt; 57           6.3 versicolor</span></span>
<span id="cb230-41"><a href="data-frame.html#cb230-41"></a>....</span></code></pre></div>
<p>高级操作：加入正则表达式筛选</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="data-frame.html#cb231-1"></a><span class="co">## sometimes requiring a logical &#39;subset&#39; argument is a nuisance</span></span>
<span id="cb231-2"><a href="data-frame.html#cb231-2"></a>nm &lt;-<span class="st"> </span><span class="kw">rownames</span>(state.x77)</span>
<span id="cb231-3"><a href="data-frame.html#cb231-3"></a>start_with_M &lt;-<span class="st"> </span>nm <span class="op">%in%</span><span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;^M&quot;</span>, nm, <span class="dt">value =</span> <span class="ot">TRUE</span>)</span>
<span id="cb231-4"><a href="data-frame.html#cb231-4"></a><span class="kw">subset</span>(state.x77, start_with_M, Illiteracy<span class="op">:</span>Murder)</span>
<span id="cb231-5"><a href="data-frame.html#cb231-5"></a><span class="co">#&gt;               Illiteracy Life Exp Murder</span></span>
<span id="cb231-6"><a href="data-frame.html#cb231-6"></a><span class="co">#&gt; Maine                0.7    70.39    2.7</span></span>
<span id="cb231-7"><a href="data-frame.html#cb231-7"></a><span class="co">#&gt; Maryland             0.9    70.22    8.5</span></span>
<span id="cb231-8"><a href="data-frame.html#cb231-8"></a><span class="co">#&gt; Massachusetts        1.1    71.83    3.3</span></span>
<span id="cb231-9"><a href="data-frame.html#cb231-9"></a><span class="co">#&gt; Michigan             0.9    70.63   11.1</span></span>
<span id="cb231-10"><a href="data-frame.html#cb231-10"></a><span class="co">#&gt; Minnesota            0.6    72.96    2.3</span></span>
<span id="cb231-11"><a href="data-frame.html#cb231-11"></a><span class="co">#&gt; Mississippi          2.4    68.09   12.5</span></span>
<span id="cb231-12"><a href="data-frame.html#cb231-12"></a><span class="co">#&gt; Missouri             0.8    70.69    9.3</span></span>
<span id="cb231-13"><a href="data-frame.html#cb231-13"></a><span class="co">#&gt; Montana              0.6    70.56    5.0</span></span>
<span id="cb231-14"><a href="data-frame.html#cb231-14"></a><span class="co"># 简化</span></span>
<span id="cb231-15"><a href="data-frame.html#cb231-15"></a><span class="kw">subset</span>(state.x77, <span class="dt">subset =</span> <span class="kw">grepl</span>(<span class="st">&quot;^M&quot;</span>, <span class="kw">rownames</span>(state.x77)), <span class="dt">select =</span> Illiteracy<span class="op">:</span>Murder)</span>
<span id="cb231-16"><a href="data-frame.html#cb231-16"></a><span class="co">#&gt;               Illiteracy Life Exp Murder</span></span>
<span id="cb231-17"><a href="data-frame.html#cb231-17"></a><span class="co">#&gt; Maine                0.7    70.39    2.7</span></span>
<span id="cb231-18"><a href="data-frame.html#cb231-18"></a><span class="co">#&gt; Maryland             0.9    70.22    8.5</span></span>
<span id="cb231-19"><a href="data-frame.html#cb231-19"></a><span class="co">#&gt; Massachusetts        1.1    71.83    3.3</span></span>
<span id="cb231-20"><a href="data-frame.html#cb231-20"></a><span class="co">#&gt; Michigan             0.9    70.63   11.1</span></span>
<span id="cb231-21"><a href="data-frame.html#cb231-21"></a><span class="co">#&gt; Minnesota            0.6    72.96    2.3</span></span>
<span id="cb231-22"><a href="data-frame.html#cb231-22"></a><span class="co">#&gt; Mississippi          2.4    68.09   12.5</span></span>
<span id="cb231-23"><a href="data-frame.html#cb231-23"></a><span class="co">#&gt; Missouri             0.8    70.69    9.3</span></span>
<span id="cb231-24"><a href="data-frame.html#cb231-24"></a><span class="co">#&gt; Montana              0.6    70.56    5.0</span></span>
<span id="cb231-25"><a href="data-frame.html#cb231-25"></a><span class="co"># 继续简化</span></span>
<span id="cb231-26"><a href="data-frame.html#cb231-26"></a><span class="kw">subset</span>(state.x77, <span class="kw">grepl</span>(<span class="st">&quot;^M&quot;</span>, <span class="kw">rownames</span>(state.x77)), Illiteracy<span class="op">:</span>Murder)</span>
<span id="cb231-27"><a href="data-frame.html#cb231-27"></a><span class="co">#&gt;               Illiteracy Life Exp Murder</span></span>
<span id="cb231-28"><a href="data-frame.html#cb231-28"></a><span class="co">#&gt; Maine                0.7    70.39    2.7</span></span>
<span id="cb231-29"><a href="data-frame.html#cb231-29"></a><span class="co">#&gt; Maryland             0.9    70.22    8.5</span></span>
<span id="cb231-30"><a href="data-frame.html#cb231-30"></a><span class="co">#&gt; Massachusetts        1.1    71.83    3.3</span></span>
<span id="cb231-31"><a href="data-frame.html#cb231-31"></a><span class="co">#&gt; Michigan             0.9    70.63   11.1</span></span>
<span id="cb231-32"><a href="data-frame.html#cb231-32"></a><span class="co">#&gt; Minnesota            0.6    72.96    2.3</span></span>
<span id="cb231-33"><a href="data-frame.html#cb231-33"></a><span class="co">#&gt; Mississippi          2.4    68.09   12.5</span></span>
<span id="cb231-34"><a href="data-frame.html#cb231-34"></a><span class="co">#&gt; Missouri             0.8    70.69    9.3</span></span>
<span id="cb231-35"><a href="data-frame.html#cb231-35"></a><span class="co">#&gt; Montana              0.6    70.56    5.0</span></span></code></pre></div>
<div class="sidebar">
<p>警告：这是一个为了交互使用打造的便捷函数。对于编程，最好使用标准的子集函数，如 <code>[</code>，特别地，参数 <code>subset</code> 的非标准计算(non-standard evaluation)<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a> 可能带来意想不到的后果。</p>
</div>
<p>使用索引 <code>[</code></p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="data-frame.html#cb232-1"></a>iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;virginica&quot;</span>, ]</span>
<span id="cb232-2"><a href="data-frame.html#cb232-2"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span></span>
<span id="cb232-3"><a href="data-frame.html#cb232-3"></a><span class="co">#&gt; 101          6.3         3.3          6.0         2.5 virginica</span></span>
<span id="cb232-4"><a href="data-frame.html#cb232-4"></a><span class="co">#&gt; 102          5.8         2.7          5.1         1.9 virginica</span></span>
<span id="cb232-5"><a href="data-frame.html#cb232-5"></a><span class="co">#&gt; 103          7.1         3.0          5.9         2.1 virginica</span></span>
<span id="cb232-6"><a href="data-frame.html#cb232-6"></a><span class="co">#&gt; 104          6.3         2.9          5.6         1.8 virginica</span></span>
<span id="cb232-7"><a href="data-frame.html#cb232-7"></a><span class="co">#&gt; 105          6.5         3.0          5.8         2.2 virginica</span></span>
<span id="cb232-8"><a href="data-frame.html#cb232-8"></a>....</span>
<span id="cb232-9"><a href="data-frame.html#cb232-9"></a>iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;virginica&quot;</span> <span class="op">&amp;</span></span>
<span id="cb232-10"><a href="data-frame.html#cb232-10"></a><span class="st">  </span>iris<span class="op">$</span>Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(iris<span class="op">$</span>Sepal.Length), ]</span>
<span id="cb232-11"><a href="data-frame.html#cb232-11"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span></span>
<span id="cb232-12"><a href="data-frame.html#cb232-12"></a><span class="co">#&gt; 101          6.3         3.3          6.0         2.5 virginica</span></span>
<span id="cb232-13"><a href="data-frame.html#cb232-13"></a><span class="co">#&gt; 103          7.1         3.0          5.9         2.1 virginica</span></span>
<span id="cb232-14"><a href="data-frame.html#cb232-14"></a><span class="co">#&gt; 104          6.3         2.9          5.6         1.8 virginica</span></span>
<span id="cb232-15"><a href="data-frame.html#cb232-15"></a><span class="co">#&gt; 105          6.5         3.0          5.8         2.2 virginica</span></span>
<span id="cb232-16"><a href="data-frame.html#cb232-16"></a><span class="co">#&gt; 106          7.6         3.0          6.6         2.1 virginica</span></span>
<span id="cb232-17"><a href="data-frame.html#cb232-17"></a>....</span>
<span id="cb232-18"><a href="data-frame.html#cb232-18"></a></span>
<span id="cb232-19"><a href="data-frame.html#cb232-19"></a>iris[</span>
<span id="cb232-20"><a href="data-frame.html#cb232-20"></a>  iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;virginica&quot;</span> <span class="op">&amp;</span></span>
<span id="cb232-21"><a href="data-frame.html#cb232-21"></a><span class="st">    </span>iris<span class="op">$</span>Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(iris<span class="op">$</span>Sepal.Length),</span>
<span id="cb232-22"><a href="data-frame.html#cb232-22"></a>  <span class="kw">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Species&quot;</span>)</span>
<span id="cb232-23"><a href="data-frame.html#cb232-23"></a>]</span>
<span id="cb232-24"><a href="data-frame.html#cb232-24"></a><span class="co">#&gt;     Sepal.Length   Species</span></span>
<span id="cb232-25"><a href="data-frame.html#cb232-25"></a><span class="co">#&gt; 101          6.3 virginica</span></span>
<span id="cb232-26"><a href="data-frame.html#cb232-26"></a><span class="co">#&gt; 103          7.1 virginica</span></span>
<span id="cb232-27"><a href="data-frame.html#cb232-27"></a><span class="co">#&gt; 104          6.3 virginica</span></span>
<span id="cb232-28"><a href="data-frame.html#cb232-28"></a><span class="co">#&gt; 105          6.5 virginica</span></span>
<span id="cb232-29"><a href="data-frame.html#cb232-29"></a><span class="co">#&gt; 106          7.6 virginica</span></span>
<span id="cb232-30"><a href="data-frame.html#cb232-30"></a>....</span></code></pre></div>
</div>
<div id="base-order" class="section level2">
<h2><span class="header-section-number">5.5</span> 按列排序</h2>
<p>在数据框内，根据(order)某一列或几列对行进行排序(sort)，根据鸢尾花(iris)的类别(Species)对萼片(sepal)的长度进行排序，其余的列随之变化</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="data-frame.html#cb233-1"></a><span class="co"># 对萼片的长度排序</span></span>
<span id="cb233-2"><a href="data-frame.html#cb233-2"></a>iris[<span class="kw">order</span>(iris<span class="op">$</span>Species, iris<span class="op">$</span>Sepal.Length), ]</span>
<span id="cb233-3"><a href="data-frame.html#cb233-3"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span></span>
<span id="cb233-4"><a href="data-frame.html#cb233-4"></a><span class="co">#&gt; 14           4.3         3.0          1.1         0.1     setosa</span></span>
<span id="cb233-5"><a href="data-frame.html#cb233-5"></a><span class="co">#&gt; 9            4.4         2.9          1.4         0.2     setosa</span></span>
<span id="cb233-6"><a href="data-frame.html#cb233-6"></a><span class="co">#&gt; 39           4.4         3.0          1.3         0.2     setosa</span></span>
<span id="cb233-7"><a href="data-frame.html#cb233-7"></a><span class="co">#&gt; 43           4.4         3.2          1.3         0.2     setosa</span></span>
<span id="cb233-8"><a href="data-frame.html#cb233-8"></a><span class="co">#&gt; 42           4.5         2.3          1.3         0.3     setosa</span></span>
<span id="cb233-9"><a href="data-frame.html#cb233-9"></a>....</span>
<span id="cb233-10"><a href="data-frame.html#cb233-10"></a><span class="co"># 对花瓣的长度排序</span></span>
<span id="cb233-11"><a href="data-frame.html#cb233-11"></a>iris[<span class="kw">order</span>(iris<span class="op">$</span>Species, iris<span class="op">$</span>Petal.Length), ]</span>
<span id="cb233-12"><a href="data-frame.html#cb233-12"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span></span>
<span id="cb233-13"><a href="data-frame.html#cb233-13"></a><span class="co">#&gt; 23           4.6         3.6          1.0         0.2     setosa</span></span>
<span id="cb233-14"><a href="data-frame.html#cb233-14"></a><span class="co">#&gt; 14           4.3         3.0          1.1         0.1     setosa</span></span>
<span id="cb233-15"><a href="data-frame.html#cb233-15"></a><span class="co">#&gt; 15           5.8         4.0          1.2         0.2     setosa</span></span>
<span id="cb233-16"><a href="data-frame.html#cb233-16"></a><span class="co">#&gt; 36           5.0         3.2          1.2         0.2     setosa</span></span>
<span id="cb233-17"><a href="data-frame.html#cb233-17"></a><span class="co">#&gt; 3            4.7         3.2          1.3         0.2     setosa</span></span>
<span id="cb233-18"><a href="data-frame.html#cb233-18"></a>....</span>
<span id="cb233-19"><a href="data-frame.html#cb233-19"></a><span class="co"># 先对花瓣的宽度排序，再对花瓣的长度排序</span></span>
<span id="cb233-20"><a href="data-frame.html#cb233-20"></a>iris[<span class="kw">order</span>(iris<span class="op">$</span>Petal.Width, iris<span class="op">$</span>Petal.Length), ]</span>
<span id="cb233-21"><a href="data-frame.html#cb233-21"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span></span>
<span id="cb233-22"><a href="data-frame.html#cb233-22"></a><span class="co">#&gt; 14           4.3         3.0          1.1         0.1     setosa</span></span>
<span id="cb233-23"><a href="data-frame.html#cb233-23"></a><span class="co">#&gt; 13           4.8         3.0          1.4         0.1     setosa</span></span>
<span id="cb233-24"><a href="data-frame.html#cb233-24"></a><span class="co">#&gt; 38           4.9         3.6          1.4         0.1     setosa</span></span>
<span id="cb233-25"><a href="data-frame.html#cb233-25"></a><span class="co">#&gt; 10           4.9         3.1          1.5         0.1     setosa</span></span>
<span id="cb233-26"><a href="data-frame.html#cb233-26"></a><span class="co">#&gt; 33           5.2         4.1          1.5         0.1     setosa</span></span>
<span id="cb233-27"><a href="data-frame.html#cb233-27"></a>....</span></code></pre></div>
<p>sort/ordered 排序， 默认是升序</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="data-frame.html#cb234-1"></a>dd &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb234-2"><a href="data-frame.html#cb234-2"></a>  <span class="dt">b =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;Hi&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;Hi&quot;</span>, <span class="st">&quot;Low&quot;</span>),</span>
<span id="cb234-3"><a href="data-frame.html#cb234-3"></a>    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;Hi&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span></span>
<span id="cb234-4"><a href="data-frame.html#cb234-4"></a>  ),</span>
<span id="cb234-5"><a href="data-frame.html#cb234-5"></a>  <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">9</span>),</span>
<span id="cb234-6"><a href="data-frame.html#cb234-6"></a>  <span class="dt">z =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb234-7"><a href="data-frame.html#cb234-7"></a>)</span>
<span id="cb234-8"><a href="data-frame.html#cb234-8"></a><span class="kw">str</span>(dd)</span>
<span id="cb234-9"><a href="data-frame.html#cb234-9"></a><span class="co">#&gt; &#39;data.frame&#39;:    4 obs. of  4 variables:</span></span>
<span id="cb234-10"><a href="data-frame.html#cb234-10"></a><span class="co">#&gt;  $ b: Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;Hi&quot;: 3 2 3 1</span></span>
<span id="cb234-11"><a href="data-frame.html#cb234-11"></a><span class="co">#&gt;  $ x: chr  &quot;A&quot; &quot;D&quot; &quot;A&quot; &quot;C&quot;</span></span>
<span id="cb234-12"><a href="data-frame.html#cb234-12"></a><span class="co">#&gt;  $ y: num  8 3 9 9</span></span>
<span id="cb234-13"><a href="data-frame.html#cb234-13"></a><span class="co">#&gt;  $ z: num  1 1 1 2</span></span>
<span id="cb234-14"><a href="data-frame.html#cb234-14"></a>dd[<span class="kw">order</span>(<span class="op">-</span>dd[,<span class="dv">4</span>], dd[,<span class="dv">1</span>]), ]</span>
<span id="cb234-15"><a href="data-frame.html#cb234-15"></a><span class="co">#&gt;     b x y z</span></span>
<span id="cb234-16"><a href="data-frame.html#cb234-16"></a><span class="co">#&gt; 4 Low C 9 2</span></span>
<span id="cb234-17"><a href="data-frame.html#cb234-17"></a><span class="co">#&gt; 2 Med D 3 1</span></span>
<span id="cb234-18"><a href="data-frame.html#cb234-18"></a><span class="co">#&gt; 1  Hi A 8 1</span></span>
<span id="cb234-19"><a href="data-frame.html#cb234-19"></a><span class="co">#&gt; 3  Hi A 9 1</span></span></code></pre></div>
<p>根据变量 z</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="data-frame.html#cb235-1"></a>dd[<span class="kw">order</span>(dd<span class="op">$</span>z, dd<span class="op">$</span>b), ]</span>
<span id="cb235-2"><a href="data-frame.html#cb235-2"></a><span class="co">#&gt;     b x y z</span></span>
<span id="cb235-3"><a href="data-frame.html#cb235-3"></a><span class="co">#&gt; 2 Med D 3 1</span></span>
<span id="cb235-4"><a href="data-frame.html#cb235-4"></a><span class="co">#&gt; 1  Hi A 8 1</span></span>
<span id="cb235-5"><a href="data-frame.html#cb235-5"></a><span class="co">#&gt; 3  Hi A 9 1</span></span>
<span id="cb235-6"><a href="data-frame.html#cb235-6"></a><span class="co">#&gt; 4 Low C 9 2</span></span></code></pre></div>
</div>
<div id="base-split" class="section level2">
<h2><span class="header-section-number">5.6</span> 数据拆分</h2>
<p>数据拆分通常是按找某一个分类变量分组，分完组就是计算，计算完就把结果按照原来的分组方式合并</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="data-frame.html#cb236-1"></a><span class="co">## Notice that assignment form is not used since a variable is being added</span></span>
<span id="cb236-2"><a href="data-frame.html#cb236-2"></a>g &lt;-<span class="st"> </span>airquality<span class="op">$</span>Month</span>
<span id="cb236-3"><a href="data-frame.html#cb236-3"></a>l &lt;-<span class="st"> </span><span class="kw">split</span>(airquality, g) <span class="co"># 分组</span></span>
<span id="cb236-4"><a href="data-frame.html#cb236-4"></a>l &lt;-<span class="st"> </span><span class="kw">lapply</span>(l, transform, <span class="dt">Oz.Z =</span> <span class="kw">scale</span>(Ozone)) <span class="co"># 计算：按月对 Ozone 标准化</span></span>
<span id="cb236-5"><a href="data-frame.html#cb236-5"></a>aq2 &lt;-<span class="st"> </span><span class="kw">unsplit</span>(l, g) <span class="co"># 合并</span></span>
<span id="cb236-6"><a href="data-frame.html#cb236-6"></a><span class="kw">head</span>(aq2)</span>
<span id="cb236-7"><a href="data-frame.html#cb236-7"></a><span class="co">#&gt;   Ozone Solar.R Wind Temp Month Day       Oz.Z</span></span>
<span id="cb236-8"><a href="data-frame.html#cb236-8"></a><span class="co">#&gt; 1    41     190  7.4   67     5   1  0.7822293</span></span>
<span id="cb236-9"><a href="data-frame.html#cb236-9"></a><span class="co">#&gt; 2    36     118  8.0   72     5   2  0.5572518</span></span>
<span id="cb236-10"><a href="data-frame.html#cb236-10"></a><span class="co">#&gt; 3    12     149 12.6   74     5   3 -0.5226399</span></span>
<span id="cb236-11"><a href="data-frame.html#cb236-11"></a><span class="co">#&gt; 4    18     313 11.5   62     5   4 -0.2526670</span></span>
<span id="cb236-12"><a href="data-frame.html#cb236-12"></a><span class="co">#&gt; 5    NA      NA 14.3   56     5   5         NA</span></span>
<span id="cb236-13"><a href="data-frame.html#cb236-13"></a><span class="co">#&gt; 6    28      NA 14.9   66     5   6  0.1972879</span></span></code></pre></div>
<p>tapply 自带分组的功能，按月份 Month 对 Ozone 中心标准化，其返回一个列表</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="data-frame.html#cb237-1"></a><span class="kw">with</span>(airquality, <span class="kw">tapply</span>(Ozone, Month, scale))</span>
<span id="cb237-2"><a href="data-frame.html#cb237-2"></a><span class="co">#&gt; $`5`</span></span>
<span id="cb237-3"><a href="data-frame.html#cb237-3"></a><span class="co">#&gt;              [,1]</span></span>
<span id="cb237-4"><a href="data-frame.html#cb237-4"></a><span class="co">#&gt;  [1,]  0.78222929</span></span>
<span id="cb237-5"><a href="data-frame.html#cb237-5"></a><span class="co">#&gt;  [2,]  0.55725184</span></span>
<span id="cb237-6"><a href="data-frame.html#cb237-6"></a><span class="co">#&gt;  [3,] -0.52263993</span></span>
<span id="cb237-7"><a href="data-frame.html#cb237-7"></a><span class="co">#&gt;  [4,] -0.25266698</span></span>
<span id="cb237-8"><a href="data-frame.html#cb237-8"></a><span class="co">#&gt;  [5,]          NA</span></span>
<span id="cb237-9"><a href="data-frame.html#cb237-9"></a><span class="co">#&gt;  [6,]  0.19728792</span></span>
<span id="cb237-10"><a href="data-frame.html#cb237-10"></a><span class="co">#&gt;  [7,] -0.02768953</span></span>
<span id="cb237-11"><a href="data-frame.html#cb237-11"></a><span class="co">#&gt;  [8,] -0.20767149</span></span>
<span id="cb237-12"><a href="data-frame.html#cb237-12"></a>....</span></code></pre></div>
<p>上面的过程等价于</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="data-frame.html#cb238-1"></a><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="kw">lapply</span>(<span class="kw">split</span>(airquality, airquality<span class="op">$</span>Month), transform, <span class="dt">Oz.Z =</span> <span class="kw">scale</span>(Ozone)))</span>
<span id="cb238-2"><a href="data-frame.html#cb238-2"></a><span class="co">#&gt;       Ozone Solar.R Wind Temp Month Day         Oz.Z</span></span>
<span id="cb238-3"><a href="data-frame.html#cb238-3"></a><span class="co">#&gt; 5.1      41     190  7.4   67     5   1  0.782229293</span></span>
<span id="cb238-4"><a href="data-frame.html#cb238-4"></a><span class="co">#&gt; 5.2      36     118  8.0   72     5   2  0.557251841</span></span>
<span id="cb238-5"><a href="data-frame.html#cb238-5"></a><span class="co">#&gt; 5.3      12     149 12.6   74     5   3 -0.522639926</span></span>
<span id="cb238-6"><a href="data-frame.html#cb238-6"></a><span class="co">#&gt; 5.4      18     313 11.5   62     5   4 -0.252666984</span></span>
<span id="cb238-7"><a href="data-frame.html#cb238-7"></a><span class="co">#&gt; 5.5      NA      NA 14.3   56     5   5           NA</span></span>
<span id="cb238-8"><a href="data-frame.html#cb238-8"></a><span class="co">#&gt; 5.6      28      NA 14.9   66     5   6  0.197287919</span></span>
<span id="cb238-9"><a href="data-frame.html#cb238-9"></a><span class="co">#&gt; 5.7      23     299  8.6   65     5   7 -0.027689532</span></span>
<span id="cb238-10"><a href="data-frame.html#cb238-10"></a><span class="co">#&gt; 5.8      19      99 13.8   59     5   8 -0.207671494</span></span>
<span id="cb238-11"><a href="data-frame.html#cb238-11"></a><span class="co">#&gt; 5.9       8      19 20.1   61     5   9 -0.702621887</span></span>
<span id="cb238-12"><a href="data-frame.html#cb238-12"></a>....</span></code></pre></div>
<p>由于上面对 Ozone 正态标准化，所以标准化后的 <code>Oz.z</code> 再按月分组计算方差自然每个月都是 1，而均值都是 0。</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="data-frame.html#cb239-1"></a><span class="kw">with</span>(aq2, <span class="kw">tapply</span>(Oz.Z, Month, sd, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb239-2"><a href="data-frame.html#cb239-2"></a><span class="co">#&gt; 5 6 7 8 9 </span></span>
<span id="cb239-3"><a href="data-frame.html#cb239-3"></a><span class="co">#&gt; 1 1 1 1 1</span></span>
<span id="cb239-4"><a href="data-frame.html#cb239-4"></a><span class="kw">with</span>(aq2, <span class="kw">tapply</span>(Oz.Z, Month, mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb239-5"><a href="data-frame.html#cb239-5"></a><span class="co">#&gt;             5             6             7             8             9 </span></span>
<span id="cb239-6"><a href="data-frame.html#cb239-6"></a><span class="co">#&gt; -4.240273e-17  1.052760e-16  5.841432e-17  5.898060e-17  2.571709e-17</span></span></code></pre></div>
<blockquote>
<p>循着这个思路，我们可以用 tapply 实现分组计算，上面函数 <code>sd</code> 和 <code>mean</code> 完全可以用自定义的更加复杂的函数替代</p>
</blockquote>
<p><code>cut</code> 函数可以将连续型变量划分为分类变量</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="data-frame.html#cb240-1"></a><span class="kw">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb240-2"><a href="data-frame.html#cb240-2"></a>Z &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb240-3"><a href="data-frame.html#cb240-3"></a><span class="kw">cut</span>(Z, <span class="dt">breaks =</span> <span class="dv">-6</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb240-4"><a href="data-frame.html#cb240-4"></a><span class="co">#&gt;  [1] (0,1]   (-1,0]  (-2,-1] (0,1]   (-2,-1] (0,1]   (-1,0]  (0,1]   (-2,-1]</span></span>
<span id="cb240-5"><a href="data-frame.html#cb240-5"></a><span class="co">#&gt; [10] (-1,0] </span></span>
<span id="cb240-6"><a href="data-frame.html#cb240-6"></a><span class="co">#&gt; 12 Levels: (-6,-5] (-5,-4] (-4,-3] (-3,-2] (-2,-1] (-1,0] (0,1] ... (5,6]</span></span>
<span id="cb240-7"><a href="data-frame.html#cb240-7"></a><span class="co"># labels = FALSE 返回每个数所落的区间位置</span></span>
<span id="cb240-8"><a href="data-frame.html#cb240-8"></a><span class="kw">cut</span>(Z, <span class="dt">breaks =</span> <span class="dv">-6</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>)</span>
<span id="cb240-9"><a href="data-frame.html#cb240-9"></a><span class="co">#&gt;  [1] 7 6 5 7 5 7 6 7 5 6</span></span></code></pre></div>
<p>我们还可以指定参数 <code>dig.lab</code> 设置分组的精度，<code>ordered</code> 将分组变量看作是有序的，<code>breaks</code> 传递单个数时，表示分组数，而不是断点</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="data-frame.html#cb241-1"></a><span class="kw">cut</span>(Z, <span class="dt">breaks =</span> <span class="dv">3</span>, <span class="dt">dig.lab =</span> <span class="dv">4</span>, <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</span>
<span id="cb241-2"><a href="data-frame.html#cb241-2"></a><span class="co">#&gt;  [1] (0.06396,0.9186]  (-0.7881,0.06396] (-1.643,-0.7881]  (0.06396,0.9186] </span></span>
<span id="cb241-3"><a href="data-frame.html#cb241-3"></a><span class="co">#&gt;  [5] (-1.643,-0.7881]  (0.06396,0.9186]  (-0.7881,0.06396] (0.06396,0.9186] </span></span>
<span id="cb241-4"><a href="data-frame.html#cb241-4"></a><span class="co">#&gt;  [9] (-1.643,-0.7881]  (-0.7881,0.06396]</span></span>
<span id="cb241-5"><a href="data-frame.html#cb241-5"></a><span class="co">#&gt; Levels: (-1.643,-0.7881] &lt; (-0.7881,0.06396] &lt; (0.06396,0.9186]</span></span></code></pre></div>
<p>此时，统计每组的频数，如图 <a href="data-frame.html#fig:cut">5.1</a></p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="data-frame.html#cb242-1"></a><span class="co"># 条形图</span></span>
<span id="cb242-2"><a href="data-frame.html#cb242-2"></a><span class="kw">plot</span>(<span class="kw">cut</span>(Z, <span class="dt">breaks =</span> <span class="dv">-6</span><span class="op">:</span><span class="dv">6</span>))</span>
<span id="cb242-3"><a href="data-frame.html#cb242-3"></a><span class="co"># 直方图</span></span>
<span id="cb242-4"><a href="data-frame.html#cb242-4"></a><span class="kw">hist</span>(Z, <span class="dt">breaks =</span> <span class="dv">-6</span><span class="op">:</span><span class="dv">6</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cut"></span>
<img src="data-frame_files/figure-html/cut-1.png" alt="连续型变量分组统计" width="35%" /><img src="data-frame_files/figure-html/cut-2.png" alt="连续型变量分组统计" width="35%" />
<p class="caption">
图 5.1: 连续型变量分组统计
</p>
</div>
<p>在指定分组数的情况下，我们还想获取分组的断点</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="data-frame.html#cb243-1"></a>labs &lt;-<span class="st"> </span><span class="kw">levels</span>(<span class="kw">cut</span>(Z, <span class="dv">3</span>))</span>
<span id="cb243-2"><a href="data-frame.html#cb243-2"></a>labs</span>
<span id="cb243-3"><a href="data-frame.html#cb243-3"></a><span class="co">#&gt; [1] &quot;(-1.64,-0.788]&quot; &quot;(-0.788,0.064]&quot; &quot;(0.064,0.919]&quot;</span></span></code></pre></div>
<p>用正则表达式抽取断点</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="data-frame.html#cb244-1"></a><span class="kw">cbind</span>(</span>
<span id="cb244-2"><a href="data-frame.html#cb244-2"></a>  <span class="dt">lower =</span> <span class="kw">as.numeric</span>(<span class="kw">sub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">((.+),.*&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>, labs)),</span>
<span id="cb244-3"><a href="data-frame.html#cb244-3"></a>  <span class="dt">upper =</span> <span class="kw">as.numeric</span>(<span class="kw">sub</span>(<span class="st">&quot;[^,]*,([^]]*)</span><span class="ch">\\</span><span class="st">]&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>, labs))</span>
<span id="cb244-4"><a href="data-frame.html#cb244-4"></a>)</span>
<span id="cb244-5"><a href="data-frame.html#cb244-5"></a><span class="co">#&gt;       lower  upper</span></span>
<span id="cb244-6"><a href="data-frame.html#cb244-6"></a><span class="co">#&gt; [1,] -1.640 -0.788</span></span>
<span id="cb244-7"><a href="data-frame.html#cb244-7"></a><span class="co">#&gt; [2,] -0.788  0.064</span></span>
<span id="cb244-8"><a href="data-frame.html#cb244-8"></a><span class="co">#&gt; [3,]  0.064  0.919</span></span></code></pre></div>
<p>更多相关函数可以参考 <code>findInterval</code> 和 <code>embed</code></p>
<p>tabulate 和 table 有所不同，它表示排列</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="data-frame.html#cb245-1"></a><span class="kw">t</span>(<span class="kw">combn</span>(<span class="dv">8</span>, <span class="dv">4</span>, tabulate, <span class="dt">nbins =</span> <span class="dv">8</span>))</span>
<span id="cb245-2"><a href="data-frame.html#cb245-2"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span></span>
<span id="cb245-3"><a href="data-frame.html#cb245-3"></a><span class="co">#&gt;  [1,]    1    1    1    1    0    0    0    0</span></span>
<span id="cb245-4"><a href="data-frame.html#cb245-4"></a><span class="co">#&gt;  [2,]    1    1    1    0    1    0    0    0</span></span>
<span id="cb245-5"><a href="data-frame.html#cb245-5"></a><span class="co">#&gt;  [3,]    1    1    1    0    0    1    0    0</span></span>
<span id="cb245-6"><a href="data-frame.html#cb245-6"></a><span class="co">#&gt;  [4,]    1    1    1    0    0    0    1    0</span></span>
<span id="cb245-7"><a href="data-frame.html#cb245-7"></a><span class="co">#&gt;  [5,]    1    1    1    0    0    0    0    1</span></span>
<span id="cb245-8"><a href="data-frame.html#cb245-8"></a>....</span></code></pre></div>
</div>
<div id="base-merge" class="section level2">
<h2><span class="header-section-number">5.7</span> 数据合并</h2>
<p>merge 合并两个数据框</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="data-frame.html#cb246-1"></a>authors &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb246-2"><a href="data-frame.html#cb246-2"></a>  <span class="co">## I(*) : use character columns of names to get sensible sort order</span></span>
<span id="cb246-3"><a href="data-frame.html#cb246-3"></a>  <span class="dt">surname =</span> <span class="kw">I</span>(<span class="kw">c</span>(<span class="st">&quot;Tukey&quot;</span>, <span class="st">&quot;Venables&quot;</span>, <span class="st">&quot;Tierney&quot;</span>, <span class="st">&quot;Ripley&quot;</span>, <span class="st">&quot;McNeil&quot;</span>)),</span>
<span id="cb246-4"><a href="data-frame.html#cb246-4"></a>  <span class="dt">nationality =</span> <span class="kw">c</span>(<span class="st">&quot;US&quot;</span>, <span class="st">&quot;Australia&quot;</span>, <span class="st">&quot;US&quot;</span>, <span class="st">&quot;UK&quot;</span>, <span class="st">&quot;Australia&quot;</span>),</span>
<span id="cb246-5"><a href="data-frame.html#cb246-5"></a>  <span class="dt">deceased =</span> <span class="kw">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;no&quot;</span>, <span class="dv">4</span>))</span>
<span id="cb246-6"><a href="data-frame.html#cb246-6"></a>)</span>
<span id="cb246-7"><a href="data-frame.html#cb246-7"></a>authorN &lt;-<span class="st"> </span><span class="kw">within</span>(authors, {</span>
<span id="cb246-8"><a href="data-frame.html#cb246-8"></a>  name &lt;-<span class="st"> </span>surname</span>
<span id="cb246-9"><a href="data-frame.html#cb246-9"></a>  <span class="kw">rm</span>(surname)</span>
<span id="cb246-10"><a href="data-frame.html#cb246-10"></a>})</span>
<span id="cb246-11"><a href="data-frame.html#cb246-11"></a>books &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb246-12"><a href="data-frame.html#cb246-12"></a>  <span class="dt">name =</span> <span class="kw">I</span>(<span class="kw">c</span>(</span>
<span id="cb246-13"><a href="data-frame.html#cb246-13"></a>    <span class="st">&quot;Tukey&quot;</span>, <span class="st">&quot;Venables&quot;</span>, <span class="st">&quot;Tierney&quot;</span>,</span>
<span id="cb246-14"><a href="data-frame.html#cb246-14"></a>    <span class="st">&quot;Ripley&quot;</span>, <span class="st">&quot;Ripley&quot;</span>, <span class="st">&quot;McNeil&quot;</span>, <span class="st">&quot;R Core&quot;</span></span>
<span id="cb246-15"><a href="data-frame.html#cb246-15"></a>  )),</span>
<span id="cb246-16"><a href="data-frame.html#cb246-16"></a>  <span class="dt">title =</span> <span class="kw">c</span>(</span>
<span id="cb246-17"><a href="data-frame.html#cb246-17"></a>    <span class="st">&quot;Exploratory Data Analysis&quot;</span>,</span>
<span id="cb246-18"><a href="data-frame.html#cb246-18"></a>    <span class="st">&quot;Modern Applied Statistics ...&quot;</span>,</span>
<span id="cb246-19"><a href="data-frame.html#cb246-19"></a>    <span class="st">&quot;LISP-STAT&quot;</span>,</span>
<span id="cb246-20"><a href="data-frame.html#cb246-20"></a>    <span class="st">&quot;Spatial Statistics&quot;</span>, <span class="st">&quot;Stochastic Simulation&quot;</span>,</span>
<span id="cb246-21"><a href="data-frame.html#cb246-21"></a>    <span class="st">&quot;Interactive Data Analysis&quot;</span>,</span>
<span id="cb246-22"><a href="data-frame.html#cb246-22"></a>    <span class="st">&quot;An Introduction to R&quot;</span></span>
<span id="cb246-23"><a href="data-frame.html#cb246-23"></a>  ),</span>
<span id="cb246-24"><a href="data-frame.html#cb246-24"></a>  <span class="dt">other.author =</span> <span class="kw">c</span>(</span>
<span id="cb246-25"><a href="data-frame.html#cb246-25"></a>    <span class="ot">NA</span>, <span class="st">&quot;Ripley&quot;</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>,</span>
<span id="cb246-26"><a href="data-frame.html#cb246-26"></a>    <span class="st">&quot;Venables &amp; Smith&quot;</span></span>
<span id="cb246-27"><a href="data-frame.html#cb246-27"></a>  )</span>
<span id="cb246-28"><a href="data-frame.html#cb246-28"></a>)</span>
<span id="cb246-29"><a href="data-frame.html#cb246-29"></a></span>
<span id="cb246-30"><a href="data-frame.html#cb246-30"></a>authors</span>
<span id="cb246-31"><a href="data-frame.html#cb246-31"></a><span class="co">#&gt;    surname nationality deceased</span></span>
<span id="cb246-32"><a href="data-frame.html#cb246-32"></a><span class="co">#&gt; 1    Tukey          US      yes</span></span>
<span id="cb246-33"><a href="data-frame.html#cb246-33"></a><span class="co">#&gt; 2 Venables   Australia       no</span></span>
<span id="cb246-34"><a href="data-frame.html#cb246-34"></a><span class="co">#&gt; 3  Tierney          US       no</span></span>
<span id="cb246-35"><a href="data-frame.html#cb246-35"></a><span class="co">#&gt; 4   Ripley          UK       no</span></span>
<span id="cb246-36"><a href="data-frame.html#cb246-36"></a><span class="co">#&gt; 5   McNeil   Australia       no</span></span>
<span id="cb246-37"><a href="data-frame.html#cb246-37"></a>authorN</span>
<span id="cb246-38"><a href="data-frame.html#cb246-38"></a><span class="co">#&gt;   nationality deceased     name</span></span>
<span id="cb246-39"><a href="data-frame.html#cb246-39"></a><span class="co">#&gt; 1          US      yes    Tukey</span></span>
<span id="cb246-40"><a href="data-frame.html#cb246-40"></a><span class="co">#&gt; 2   Australia       no Venables</span></span>
<span id="cb246-41"><a href="data-frame.html#cb246-41"></a><span class="co">#&gt; 3          US       no  Tierney</span></span>
<span id="cb246-42"><a href="data-frame.html#cb246-42"></a><span class="co">#&gt; 4          UK       no   Ripley</span></span>
<span id="cb246-43"><a href="data-frame.html#cb246-43"></a><span class="co">#&gt; 5   Australia       no   McNeil</span></span>
<span id="cb246-44"><a href="data-frame.html#cb246-44"></a>books</span>
<span id="cb246-45"><a href="data-frame.html#cb246-45"></a><span class="co">#&gt;       name                         title     other.author</span></span>
<span id="cb246-46"><a href="data-frame.html#cb246-46"></a><span class="co">#&gt; 1    Tukey     Exploratory Data Analysis             &lt;NA&gt;</span></span>
<span id="cb246-47"><a href="data-frame.html#cb246-47"></a><span class="co">#&gt; 2 Venables Modern Applied Statistics ...           Ripley</span></span>
<span id="cb246-48"><a href="data-frame.html#cb246-48"></a><span class="co">#&gt; 3  Tierney                     LISP-STAT             &lt;NA&gt;</span></span>
<span id="cb246-49"><a href="data-frame.html#cb246-49"></a><span class="co">#&gt; 4   Ripley            Spatial Statistics             &lt;NA&gt;</span></span>
<span id="cb246-50"><a href="data-frame.html#cb246-50"></a><span class="co">#&gt; 5   Ripley         Stochastic Simulation             &lt;NA&gt;</span></span>
<span id="cb246-51"><a href="data-frame.html#cb246-51"></a><span class="co">#&gt; 6   McNeil     Interactive Data Analysis             &lt;NA&gt;</span></span>
<span id="cb246-52"><a href="data-frame.html#cb246-52"></a><span class="co">#&gt; 7   R Core          An Introduction to R Venables &amp; Smith</span></span></code></pre></div>
<p>默认找到同名的列，然后是同名的行合并，多余的没有匹配到的就丢掉</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="data-frame.html#cb247-1"></a><span class="kw">merge</span>(authorN, books)</span>
<span id="cb247-2"><a href="data-frame.html#cb247-2"></a><span class="co">#&gt;       name nationality deceased                         title other.author</span></span>
<span id="cb247-3"><a href="data-frame.html#cb247-3"></a><span class="co">#&gt; 1   McNeil   Australia       no     Interactive Data Analysis         &lt;NA&gt;</span></span>
<span id="cb247-4"><a href="data-frame.html#cb247-4"></a><span class="co">#&gt; 2   Ripley          UK       no            Spatial Statistics         &lt;NA&gt;</span></span>
<span id="cb247-5"><a href="data-frame.html#cb247-5"></a><span class="co">#&gt; 3   Ripley          UK       no         Stochastic Simulation         &lt;NA&gt;</span></span>
<span id="cb247-6"><a href="data-frame.html#cb247-6"></a><span class="co">#&gt; 4  Tierney          US       no                     LISP-STAT         &lt;NA&gt;</span></span>
<span id="cb247-7"><a href="data-frame.html#cb247-7"></a><span class="co">#&gt; 5    Tukey          US      yes     Exploratory Data Analysis         &lt;NA&gt;</span></span>
<span id="cb247-8"><a href="data-frame.html#cb247-8"></a><span class="co">#&gt; 6 Venables   Australia       no Modern Applied Statistics ...       Ripley</span></span></code></pre></div>
<p>还可以指定合并的列，先按照 surname 合并，留下 surname</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="data-frame.html#cb248-1"></a><span class="kw">merge</span>(authors, books, <span class="dt">by.x =</span> <span class="st">&quot;surname&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;name&quot;</span>)</span>
<span id="cb248-2"><a href="data-frame.html#cb248-2"></a><span class="co">#&gt;    surname nationality deceased                         title other.author</span></span>
<span id="cb248-3"><a href="data-frame.html#cb248-3"></a><span class="co">#&gt; 1   McNeil   Australia       no     Interactive Data Analysis         &lt;NA&gt;</span></span>
<span id="cb248-4"><a href="data-frame.html#cb248-4"></a><span class="co">#&gt; 2   Ripley          UK       no            Spatial Statistics         &lt;NA&gt;</span></span>
<span id="cb248-5"><a href="data-frame.html#cb248-5"></a><span class="co">#&gt; 3   Ripley          UK       no         Stochastic Simulation         &lt;NA&gt;</span></span>
<span id="cb248-6"><a href="data-frame.html#cb248-6"></a><span class="co">#&gt; 4  Tierney          US       no                     LISP-STAT         &lt;NA&gt;</span></span>
<span id="cb248-7"><a href="data-frame.html#cb248-7"></a><span class="co">#&gt; 5    Tukey          US      yes     Exploratory Data Analysis         &lt;NA&gt;</span></span>
<span id="cb248-8"><a href="data-frame.html#cb248-8"></a><span class="co">#&gt; 6 Venables   Australia       no Modern Applied Statistics ...       Ripley</span></span></code></pre></div>
<p>留下的是 name</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="data-frame.html#cb249-1"></a><span class="kw">merge</span>(books, authors, <span class="dt">by.x =</span> <span class="st">&quot;name&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;surname&quot;</span>)</span>
<span id="cb249-2"><a href="data-frame.html#cb249-2"></a><span class="co">#&gt;       name                         title other.author nationality deceased</span></span>
<span id="cb249-3"><a href="data-frame.html#cb249-3"></a><span class="co">#&gt; 1   McNeil     Interactive Data Analysis         &lt;NA&gt;   Australia       no</span></span>
<span id="cb249-4"><a href="data-frame.html#cb249-4"></a><span class="co">#&gt; 2   Ripley            Spatial Statistics         &lt;NA&gt;          UK       no</span></span>
<span id="cb249-5"><a href="data-frame.html#cb249-5"></a><span class="co">#&gt; 3   Ripley         Stochastic Simulation         &lt;NA&gt;          UK       no</span></span>
<span id="cb249-6"><a href="data-frame.html#cb249-6"></a><span class="co">#&gt; 4  Tierney                     LISP-STAT         &lt;NA&gt;          US       no</span></span>
<span id="cb249-7"><a href="data-frame.html#cb249-7"></a><span class="co">#&gt; 5    Tukey     Exploratory Data Analysis         &lt;NA&gt;          US      yes</span></span>
<span id="cb249-8"><a href="data-frame.html#cb249-8"></a><span class="co">#&gt; 6 Venables Modern Applied Statistics ...       Ripley   Australia       no</span></span></code></pre></div>
<p>为了比较清楚地观察几种合并的区别，这里提供对应的动画展示 <a href="https://github.com/gadenbuie/tidyexplain" class="uri">https://github.com/gadenbuie/tidyexplain</a></p>
<p>(inner, outer, left, right, cross) join 共5种合并方式详情请看 <a href="https://stackoverflow.com/questions/1299871" class="uri">https://stackoverflow.com/questions/1299871</a></p>
<p>cbind 和 rbind 分别是按列和行合并数据框</p>
</div>
<div id="base-duplicated" class="section level2">
<h2><span class="header-section-number">5.8</span> 数据去重</h2>
<p>单个数值型向量去重，此时和 unique 函数作用一样</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="data-frame.html#cb250-1"></a>(x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span><span class="op">:</span><span class="dv">20</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">0</span><span class="op">:</span><span class="dv">8</span>))</span>
<span id="cb250-2"><a href="data-frame.html#cb250-2"></a><span class="co">#&gt;  [1]  9 10 11 12 13 14 15 16 17 18 19 20  1  2  3  4  5  3  4  5  6  7  0  1  2</span></span>
<span id="cb250-3"><a href="data-frame.html#cb250-3"></a><span class="co">#&gt; [26]  3  4  5  6  7  8</span></span>
<span id="cb250-4"><a href="data-frame.html#cb250-4"></a><span class="co">## extract unique elements</span></span>
<span id="cb250-5"><a href="data-frame.html#cb250-5"></a>x[<span class="op">!</span><span class="kw">duplicated</span>(x)]</span>
<span id="cb250-6"><a href="data-frame.html#cb250-6"></a><span class="co">#&gt;  [1]  9 10 11 12 13 14 15 16 17 18 19 20  1  2  3  4  5  6  7  0  8</span></span>
<span id="cb250-7"><a href="data-frame.html#cb250-7"></a><span class="kw">unique</span>(x)</span>
<span id="cb250-8"><a href="data-frame.html#cb250-8"></a><span class="co">#&gt;  [1]  9 10 11 12 13 14 15 16 17 18 19 20  1  2  3  4  5  6  7  0  8</span></span></code></pre></div>
<p>数据框类型数据中，去除重复的行，这个重复可以是多个变量对应的向量</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="data-frame.html#cb251-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb251-2"><a href="data-frame.html#cb251-2"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb251-3"><a href="data-frame.html#cb251-3"></a>  <span class="dt">x =</span> <span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">10</span>, <span class="dt">replace =</span> T),</span>
<span id="cb251-4"><a href="data-frame.html#cb251-4"></a>  <span class="dt">y =</span> <span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">10</span>, <span class="dt">replace =</span> T),</span>
<span id="cb251-5"><a href="data-frame.html#cb251-5"></a>  <span class="dt">z =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb251-6"><a href="data-frame.html#cb251-6"></a>)</span>
<span id="cb251-7"><a href="data-frame.html#cb251-7"></a>df</span>
<span id="cb251-8"><a href="data-frame.html#cb251-8"></a><span class="co">#&gt;    x y  z</span></span>
<span id="cb251-9"><a href="data-frame.html#cb251-9"></a><span class="co">#&gt; 1  0 1  1</span></span>
<span id="cb251-10"><a href="data-frame.html#cb251-10"></a><span class="co">#&gt; 2  0 1  2</span></span>
<span id="cb251-11"><a href="data-frame.html#cb251-11"></a><span class="co">#&gt; 3  0 1  3</span></span>
<span id="cb251-12"><a href="data-frame.html#cb251-12"></a><span class="co">#&gt; 4  1 0  4</span></span>
<span id="cb251-13"><a href="data-frame.html#cb251-13"></a><span class="co">#&gt; 5  0 1  5</span></span>
<span id="cb251-14"><a href="data-frame.html#cb251-14"></a><span class="co">#&gt; 6  1 0  6</span></span>
<span id="cb251-15"><a href="data-frame.html#cb251-15"></a><span class="co">#&gt; 7  1 1  7</span></span>
<span id="cb251-16"><a href="data-frame.html#cb251-16"></a><span class="co">#&gt; 8  1 0  8</span></span>
<span id="cb251-17"><a href="data-frame.html#cb251-17"></a><span class="co">#&gt; 9  0 0  9</span></span>
<span id="cb251-18"><a href="data-frame.html#cb251-18"></a><span class="co">#&gt; 10 0 0 10</span></span>
<span id="cb251-19"><a href="data-frame.html#cb251-19"></a>df[<span class="op">!</span><span class="kw">duplicated</span>(df[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), ]</span>
<span id="cb251-20"><a href="data-frame.html#cb251-20"></a><span class="co">#&gt;   x y z</span></span>
<span id="cb251-21"><a href="data-frame.html#cb251-21"></a><span class="co">#&gt; 1 0 1 1</span></span>
<span id="cb251-22"><a href="data-frame.html#cb251-22"></a><span class="co">#&gt; 4 1 0 4</span></span>
<span id="cb251-23"><a href="data-frame.html#cb251-23"></a><span class="co">#&gt; 7 1 1 7</span></span>
<span id="cb251-24"><a href="data-frame.html#cb251-24"></a><span class="co">#&gt; 9 0 0 9</span></span></code></pre></div>
</div>
<div id="base-missing" class="section level2">
<h2><span class="header-section-number">5.9</span> 数据缺失</h2>
<p>缺失数据操作</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="data-frame.html#cb252-1"></a><span class="kw">data</span>(<span class="st">&quot;airquality&quot;</span>)</span>
<span id="cb252-2"><a href="data-frame.html#cb252-2"></a><span class="kw">head</span>(airquality)</span>
<span id="cb252-3"><a href="data-frame.html#cb252-3"></a><span class="co">#&gt;   Ozone Solar.R Wind Temp Month Day</span></span>
<span id="cb252-4"><a href="data-frame.html#cb252-4"></a><span class="co">#&gt; 1    41     190  7.4   67     5   1</span></span>
<span id="cb252-5"><a href="data-frame.html#cb252-5"></a><span class="co">#&gt; 2    36     118  8.0   72     5   2</span></span>
<span id="cb252-6"><a href="data-frame.html#cb252-6"></a><span class="co">#&gt; 3    12     149 12.6   74     5   3</span></span>
<span id="cb252-7"><a href="data-frame.html#cb252-7"></a><span class="co">#&gt; 4    18     313 11.5   62     5   4</span></span>
<span id="cb252-8"><a href="data-frame.html#cb252-8"></a><span class="co">#&gt; 5    NA      NA 14.3   56     5   5</span></span>
<span id="cb252-9"><a href="data-frame.html#cb252-9"></a><span class="co">#&gt; 6    28      NA 14.9   66     5   6</span></span></code></pre></div>
<p>对缺失值的处理默认是 <code>na.action = na.omit</code></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="data-frame.html#cb253-1"></a><span class="co"># Ozone 最高的那天</span></span>
<span id="cb253-2"><a href="data-frame.html#cb253-2"></a><span class="kw">aggregate</span>(<span class="dt">data =</span> airquality, Ozone <span class="op">~</span><span class="st"> </span>Month, max)</span>
<span id="cb253-3"><a href="data-frame.html#cb253-3"></a><span class="co">#&gt;   Month Ozone</span></span>
<span id="cb253-4"><a href="data-frame.html#cb253-4"></a><span class="co">#&gt; 1     5   115</span></span>
<span id="cb253-5"><a href="data-frame.html#cb253-5"></a><span class="co">#&gt; 2     6    71</span></span>
<span id="cb253-6"><a href="data-frame.html#cb253-6"></a><span class="co">#&gt; 3     7   135</span></span>
<span id="cb253-7"><a href="data-frame.html#cb253-7"></a><span class="co">#&gt; 4     8   168</span></span>
<span id="cb253-8"><a href="data-frame.html#cb253-8"></a><span class="co">#&gt; 5     9    96</span></span>
<span id="cb253-9"><a href="data-frame.html#cb253-9"></a><span class="co"># 每月 Ozone, Solar.R, Wind, Temp 平均值</span></span>
<span id="cb253-10"><a href="data-frame.html#cb253-10"></a><span class="kw">aggregate</span>(<span class="dt">data =</span> airquality, Ozone <span class="op">~</span><span class="st"> </span>Month, mean)</span>
<span id="cb253-11"><a href="data-frame.html#cb253-11"></a><span class="co">#&gt;   Month    Ozone</span></span>
<span id="cb253-12"><a href="data-frame.html#cb253-12"></a><span class="co">#&gt; 1     5 23.61538</span></span>
<span id="cb253-13"><a href="data-frame.html#cb253-13"></a><span class="co">#&gt; 2     6 29.44444</span></span>
<span id="cb253-14"><a href="data-frame.html#cb253-14"></a><span class="co">#&gt; 3     7 59.11538</span></span>
<span id="cb253-15"><a href="data-frame.html#cb253-15"></a><span class="co">#&gt; 4     8 59.96154</span></span>
<span id="cb253-16"><a href="data-frame.html#cb253-16"></a><span class="co">#&gt; 5     9 31.44828</span></span></code></pre></div>
<p>缺失值处理</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="data-frame.html#cb254-1"></a><span class="kw">library</span>(DataExplorer)</span>
<span id="cb254-2"><a href="data-frame.html#cb254-2"></a><span class="kw">plot_missing</span>(airquality)</span></code></pre></div>
<p>查看包含缺失的记录，不完整的记录</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="data-frame.html#cb255-1"></a>airquality[<span class="op">!</span><span class="kw">complete.cases</span>(airquality), ]</span>
<span id="cb255-2"><a href="data-frame.html#cb255-2"></a><span class="co">#&gt;     Ozone Solar.R Wind Temp Month Day</span></span>
<span id="cb255-3"><a href="data-frame.html#cb255-3"></a><span class="co">#&gt; 5      NA      NA 14.3   56     5   5</span></span>
<span id="cb255-4"><a href="data-frame.html#cb255-4"></a><span class="co">#&gt; 6      28      NA 14.9   66     5   6</span></span>
<span id="cb255-5"><a href="data-frame.html#cb255-5"></a><span class="co">#&gt; 10     NA     194  8.6   69     5  10</span></span>
<span id="cb255-6"><a href="data-frame.html#cb255-6"></a><span class="co">#&gt; 11      7      NA  6.9   74     5  11</span></span>
<span id="cb255-7"><a href="data-frame.html#cb255-7"></a><span class="co">#&gt; 25     NA      66 16.6   57     5  25</span></span>
<span id="cb255-8"><a href="data-frame.html#cb255-8"></a><span class="co">#&gt; 26     NA     266 14.9   58     5  26</span></span>
<span id="cb255-9"><a href="data-frame.html#cb255-9"></a><span class="co">#&gt; 27     NA      NA  8.0   57     5  27</span></span>
<span id="cb255-10"><a href="data-frame.html#cb255-10"></a><span class="co">#&gt; 32     NA     286  8.6   78     6   1</span></span>
<span id="cb255-11"><a href="data-frame.html#cb255-11"></a><span class="co">#&gt; 33     NA     287  9.7   74     6   2</span></span>
<span id="cb255-12"><a href="data-frame.html#cb255-12"></a><span class="co">#&gt; 34     NA     242 16.1   67     6   3</span></span>
<span id="cb255-13"><a href="data-frame.html#cb255-13"></a><span class="co">#&gt; 35     NA     186  9.2   84     6   4</span></span>
<span id="cb255-14"><a href="data-frame.html#cb255-14"></a><span class="co">#&gt; 36     NA     220  8.6   85     6   5</span></span>
<span id="cb255-15"><a href="data-frame.html#cb255-15"></a><span class="co">#&gt; 37     NA     264 14.3   79     6   6</span></span>
<span id="cb255-16"><a href="data-frame.html#cb255-16"></a><span class="co">#&gt; 39     NA     273  6.9   87     6   8</span></span>
<span id="cb255-17"><a href="data-frame.html#cb255-17"></a><span class="co">#&gt; 42     NA     259 10.9   93     6  11</span></span>
<span id="cb255-18"><a href="data-frame.html#cb255-18"></a><span class="co">#&gt; 43     NA     250  9.2   92     6  12</span></span>
<span id="cb255-19"><a href="data-frame.html#cb255-19"></a><span class="co">#&gt; 45     NA     332 13.8   80     6  14</span></span>
<span id="cb255-20"><a href="data-frame.html#cb255-20"></a><span class="co">#&gt; 46     NA     322 11.5   79     6  15</span></span>
<span id="cb255-21"><a href="data-frame.html#cb255-21"></a><span class="co">#&gt; 52     NA     150  6.3   77     6  21</span></span>
<span id="cb255-22"><a href="data-frame.html#cb255-22"></a><span class="co">#&gt; 53     NA      59  1.7   76     6  22</span></span>
<span id="cb255-23"><a href="data-frame.html#cb255-23"></a><span class="co">#&gt; 54     NA      91  4.6   76     6  23</span></span>
<span id="cb255-24"><a href="data-frame.html#cb255-24"></a><span class="co">#&gt; 55     NA     250  6.3   76     6  24</span></span>
<span id="cb255-25"><a href="data-frame.html#cb255-25"></a><span class="co">#&gt; 56     NA     135  8.0   75     6  25</span></span>
<span id="cb255-26"><a href="data-frame.html#cb255-26"></a><span class="co">#&gt; 57     NA     127  8.0   78     6  26</span></span>
<span id="cb255-27"><a href="data-frame.html#cb255-27"></a><span class="co">#&gt; 58     NA      47 10.3   73     6  27</span></span>
<span id="cb255-28"><a href="data-frame.html#cb255-28"></a><span class="co">#&gt; 59     NA      98 11.5   80     6  28</span></span>
<span id="cb255-29"><a href="data-frame.html#cb255-29"></a><span class="co">#&gt; 60     NA      31 14.9   77     6  29</span></span>
<span id="cb255-30"><a href="data-frame.html#cb255-30"></a><span class="co">#&gt; 61     NA     138  8.0   83     6  30</span></span>
<span id="cb255-31"><a href="data-frame.html#cb255-31"></a><span class="co">#&gt; 65     NA     101 10.9   84     7   4</span></span>
<span id="cb255-32"><a href="data-frame.html#cb255-32"></a><span class="co">#&gt; 72     NA     139  8.6   82     7  11</span></span>
<span id="cb255-33"><a href="data-frame.html#cb255-33"></a><span class="co">#&gt; 75     NA     291 14.9   91     7  14</span></span>
<span id="cb255-34"><a href="data-frame.html#cb255-34"></a><span class="co">#&gt; 83     NA     258  9.7   81     7  22</span></span>
<span id="cb255-35"><a href="data-frame.html#cb255-35"></a><span class="co">#&gt; 84     NA     295 11.5   82     7  23</span></span>
<span id="cb255-36"><a href="data-frame.html#cb255-36"></a><span class="co">#&gt; 96     78      NA  6.9   86     8   4</span></span>
<span id="cb255-37"><a href="data-frame.html#cb255-37"></a><span class="co">#&gt; 97     35      NA  7.4   85     8   5</span></span>
<span id="cb255-38"><a href="data-frame.html#cb255-38"></a><span class="co">#&gt; 98     66      NA  4.6   87     8   6</span></span>
<span id="cb255-39"><a href="data-frame.html#cb255-39"></a><span class="co">#&gt; 102    NA     222  8.6   92     8  10</span></span>
<span id="cb255-40"><a href="data-frame.html#cb255-40"></a><span class="co">#&gt; 103    NA     137 11.5   86     8  11</span></span>
<span id="cb255-41"><a href="data-frame.html#cb255-41"></a><span class="co">#&gt; 107    NA      64 11.5   79     8  15</span></span>
<span id="cb255-42"><a href="data-frame.html#cb255-42"></a><span class="co">#&gt; 115    NA     255 12.6   75     8  23</span></span>
<span id="cb255-43"><a href="data-frame.html#cb255-43"></a><span class="co">#&gt; 119    NA     153  5.7   88     8  27</span></span>
<span id="cb255-44"><a href="data-frame.html#cb255-44"></a><span class="co">#&gt; 150    NA     145 13.2   77     9  27</span></span></code></pre></div>
<p>Ozone 和 Solar.R 同时包含缺失值的行</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="data-frame.html#cb256-1"></a>airquality[<span class="kw">is.na</span>(airquality<span class="op">$</span>Ozone) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(airquality<span class="op">$</span>Solar.R), ]</span>
<span id="cb256-2"><a href="data-frame.html#cb256-2"></a><span class="co">#&gt;    Ozone Solar.R Wind Temp Month Day</span></span>
<span id="cb256-3"><a href="data-frame.html#cb256-3"></a><span class="co">#&gt; 5     NA      NA 14.3   56     5   5</span></span>
<span id="cb256-4"><a href="data-frame.html#cb256-4"></a><span class="co">#&gt; 27    NA      NA  8.0   57     5  27</span></span></code></pre></div>
</div>
<div id="base-aggregate" class="section level2">
<h2><span class="header-section-number">5.10</span> 数据聚合</h2>
<p>分组求和 <a href="https://stackoverflow.com/questions/1660124" class="uri">https://stackoverflow.com/questions/1660124</a></p>
<p>主要是分组统计</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="data-frame.html#cb257-1"></a><span class="kw">apropos</span>(<span class="st">&quot;apply&quot;</span>)</span>
<span id="cb257-2"><a href="data-frame.html#cb257-2"></a><span class="co">#&gt;  [1] &quot;apply&quot;      &quot;dendrapply&quot; &quot;eapply&quot;     &quot;kernapply&quot;  &quot;lapply&quot;    </span></span>
<span id="cb257-3"><a href="data-frame.html#cb257-3"></a><span class="co">#&gt;  [6] &quot;mapply&quot;     &quot;rapply&quot;     &quot;sapply&quot;     &quot;tapply&quot;     &quot;vapply&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="data-frame.html#cb258-1"></a><span class="co"># 分组求和 colSums colMeans max</span></span>
<span id="cb258-2"><a href="data-frame.html#cb258-2"></a><span class="kw">unique</span>(iris<span class="op">$</span>Species)</span>
<span id="cb258-3"><a href="data-frame.html#cb258-3"></a><span class="co">#&gt; [1] setosa     versicolor virginica </span></span>
<span id="cb258-4"><a href="data-frame.html#cb258-4"></a><span class="co">#&gt; Levels: setosa versicolor virginica</span></span>
<span id="cb258-5"><a href="data-frame.html#cb258-5"></a><span class="co"># 分类求和</span></span>
<span id="cb258-6"><a href="data-frame.html#cb258-6"></a><span class="co"># colSums(iris[iris$Species == &quot;setosa&quot;, -5])</span></span>
<span id="cb258-7"><a href="data-frame.html#cb258-7"></a><span class="co"># colSums(iris[iris$Species == &quot;virginica&quot;, -5])</span></span>
<span id="cb258-8"><a href="data-frame.html#cb258-8"></a><span class="kw">colSums</span>(iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;versicolor&quot;</span>, <span class="dv">-5</span>])</span>
<span id="cb258-9"><a href="data-frame.html#cb258-9"></a><span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span id="cb258-10"><a href="data-frame.html#cb258-10"></a><span class="co">#&gt;        296.8        138.5        213.0         66.3</span></span>
<span id="cb258-11"><a href="data-frame.html#cb258-11"></a><span class="co"># apply(iris[iris$Species == &quot;setosa&quot;, -5], 2, sum)</span></span>
<span id="cb258-12"><a href="data-frame.html#cb258-12"></a><span class="co"># apply(iris[iris$Species == &quot;setosa&quot;, -5], 2, mean)</span></span>
<span id="cb258-13"><a href="data-frame.html#cb258-13"></a><span class="co"># apply(iris[iris$Species == &quot;setosa&quot;, -5], 2, min)</span></span>
<span id="cb258-14"><a href="data-frame.html#cb258-14"></a><span class="co"># apply(iris[iris$Species == &quot;setosa&quot;, -5], 2, max)</span></span>
<span id="cb258-15"><a href="data-frame.html#cb258-15"></a><span class="kw">apply</span>(iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;setosa&quot;</span>, <span class="dv">-5</span>], <span class="dv">2</span>, quantile)</span>
<span id="cb258-16"><a href="data-frame.html#cb258-16"></a><span class="co">#&gt;      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb258-17"><a href="data-frame.html#cb258-17"></a><span class="co">#&gt; 0%            4.3       2.300        1.000         0.1</span></span>
<span id="cb258-18"><a href="data-frame.html#cb258-18"></a><span class="co">#&gt; 25%           4.8       3.200        1.400         0.2</span></span>
<span id="cb258-19"><a href="data-frame.html#cb258-19"></a><span class="co">#&gt; 50%           5.0       3.400        1.500         0.2</span></span>
<span id="cb258-20"><a href="data-frame.html#cb258-20"></a><span class="co">#&gt; 75%           5.2       3.675        1.575         0.3</span></span>
<span id="cb258-21"><a href="data-frame.html#cb258-21"></a><span class="co">#&gt; 100%          5.8       4.400        1.900         0.6</span></span></code></pre></div>
<p>aggregate: Compute Summary Statistics of Data Subsets</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="data-frame.html#cb259-1"></a><span class="co"># 按分类变量 Species 分组求和</span></span>
<span id="cb259-2"><a href="data-frame.html#cb259-2"></a><span class="co"># aggregate(subset(iris, select = -Species), by = list(iris[, &quot;Species&quot;]), FUN = sum)</span></span>
<span id="cb259-3"><a href="data-frame.html#cb259-3"></a><span class="kw">aggregate</span>(iris[, <span class="dv">-5</span>], <span class="kw">list</span>(iris[, <span class="dv">5</span>]), sum)</span>
<span id="cb259-4"><a href="data-frame.html#cb259-4"></a><span class="co">#&gt;      Group.1 Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb259-5"><a href="data-frame.html#cb259-5"></a><span class="co">#&gt; 1     setosa        250.3       171.4         73.1        12.3</span></span>
<span id="cb259-6"><a href="data-frame.html#cb259-6"></a><span class="co">#&gt; 2 versicolor        296.8       138.5        213.0        66.3</span></span>
<span id="cb259-7"><a href="data-frame.html#cb259-7"></a><span class="co">#&gt; 3  virginica        329.4       148.7        277.6       101.3</span></span>
<span id="cb259-8"><a href="data-frame.html#cb259-8"></a><span class="co"># 先确定位置，假设有很多分类变量</span></span>
<span id="cb259-9"><a href="data-frame.html#cb259-9"></a>ind &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="st">&quot;Species&quot;</span> <span class="op">==</span><span class="st"> </span><span class="kw">colnames</span>(iris))</span>
<span id="cb259-10"><a href="data-frame.html#cb259-10"></a><span class="co"># 分组统计</span></span>
<span id="cb259-11"><a href="data-frame.html#cb259-11"></a><span class="kw">aggregate</span>(iris[, <span class="op">-</span>ind], <span class="kw">list</span>(iris[, ind]), sum)</span>
<span id="cb259-12"><a href="data-frame.html#cb259-12"></a><span class="co">#&gt;      Group.1 Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb259-13"><a href="data-frame.html#cb259-13"></a><span class="co">#&gt; 1     setosa        250.3       171.4         73.1        12.3</span></span>
<span id="cb259-14"><a href="data-frame.html#cb259-14"></a><span class="co">#&gt; 2 versicolor        296.8       138.5        213.0        66.3</span></span>
<span id="cb259-15"><a href="data-frame.html#cb259-15"></a><span class="co">#&gt; 3  virginica        329.4       148.7        277.6       101.3</span></span></code></pre></div>
<p>按照 Species 划分的类别，分组计算，使用公式表示形式，右边一定是分类变量，否则会报错误或者警告，输出奇怪的结果，请读者尝试运行<code>aggregate(Species ~ Sepal.Length, data = iris, mean)</code>。公式法表示分组计算，<code>~</code> 左手边可以做加 <code>+</code> 减 <code>-</code> 乘 <code>*</code> 除 <code>/</code> 取余 <code>%%</code> 等数学运算。下面以数据集 iris 为例，只对 Sepal.Length 按 Species 分组计算</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="data-frame.html#cb260-1"></a><span class="kw">aggregate</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data =</span> iris, mean)</span>
<span id="cb260-2"><a href="data-frame.html#cb260-2"></a><span class="co">#&gt;      Species Sepal.Length</span></span>
<span id="cb260-3"><a href="data-frame.html#cb260-3"></a><span class="co">#&gt; 1     setosa        5.006</span></span>
<span id="cb260-4"><a href="data-frame.html#cb260-4"></a><span class="co">#&gt; 2 versicolor        5.936</span></span>
<span id="cb260-5"><a href="data-frame.html#cb260-5"></a><span class="co">#&gt; 3  virginica        6.588</span></span></code></pre></div>
<p>与上述分组统计结果一样的命令，在大数据集上， 与 aggregate 相比，tapply 要快很多，by 是 tapply 的包裹，处理速度差不多。读者可以构造伪随机数据集验证。</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="data-frame.html#cb261-1"></a><span class="co"># tapply(iris$Sepal.Length, list(iris$Species), mean)</span></span>
<span id="cb261-2"><a href="data-frame.html#cb261-2"></a><span class="kw">with</span>(iris, <span class="kw">tapply</span>(Sepal.Length, Species, mean))</span>
<span id="cb261-3"><a href="data-frame.html#cb261-3"></a><span class="co">#&gt;     setosa versicolor  virginica </span></span>
<span id="cb261-4"><a href="data-frame.html#cb261-4"></a><span class="co">#&gt;      5.006      5.936      6.588</span></span>
<span id="cb261-5"><a href="data-frame.html#cb261-5"></a><span class="kw">by</span>(iris<span class="op">$</span>Sepal.Length, iris<span class="op">$</span>Species, mean)</span>
<span id="cb261-6"><a href="data-frame.html#cb261-6"></a><span class="co">#&gt; iris$Species: setosa</span></span>
<span id="cb261-7"><a href="data-frame.html#cb261-7"></a><span class="co">#&gt; [1] 5.006</span></span>
<span id="cb261-8"><a href="data-frame.html#cb261-8"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb261-9"><a href="data-frame.html#cb261-9"></a><span class="co">#&gt; iris$Species: versicolor</span></span>
<span id="cb261-10"><a href="data-frame.html#cb261-10"></a><span class="co">#&gt; [1] 5.936</span></span>
<span id="cb261-11"><a href="data-frame.html#cb261-11"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb261-12"><a href="data-frame.html#cb261-12"></a><span class="co">#&gt; iris$Species: virginica</span></span>
<span id="cb261-13"><a href="data-frame.html#cb261-13"></a><span class="co">#&gt; [1] 6.588</span></span></code></pre></div>
<p>对所有变量按 Species 分组计算</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="data-frame.html#cb262-1"></a><span class="kw">aggregate</span>(. <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data =</span> iris, mean)</span>
<span id="cb262-2"><a href="data-frame.html#cb262-2"></a><span class="co">#&gt;      Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb262-3"><a href="data-frame.html#cb262-3"></a><span class="co">#&gt; 1     setosa        5.006       3.428        1.462       0.246</span></span>
<span id="cb262-4"><a href="data-frame.html#cb262-4"></a><span class="co">#&gt; 2 versicolor        5.936       2.770        4.260       1.326</span></span>
<span id="cb262-5"><a href="data-frame.html#cb262-5"></a><span class="co">#&gt; 3  virginica        6.588       2.974        5.552       2.026</span></span></code></pre></div>
<p>对变量 Sepal.Length 和 Sepal.Width 求和后，按 Species 分组计算</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="data-frame.html#cb263-1"></a><span class="kw">aggregate</span>(Sepal.Length <span class="op">+</span><span class="st"> </span>Sepal.Width <span class="op">~</span><span class="st"> </span>Species, <span class="dt">data =</span> iris, mean)</span>
<span id="cb263-2"><a href="data-frame.html#cb263-2"></a><span class="co">#&gt;      Species Sepal.Length + Sepal.Width</span></span>
<span id="cb263-3"><a href="data-frame.html#cb263-3"></a><span class="co">#&gt; 1     setosa                      8.434</span></span>
<span id="cb263-4"><a href="data-frame.html#cb263-4"></a><span class="co">#&gt; 2 versicolor                      8.706</span></span>
<span id="cb263-5"><a href="data-frame.html#cb263-5"></a><span class="co">#&gt; 3  virginica                      9.562</span></span></code></pre></div>
<p>对多个分类变量做分组计算，在数据集 ChickWeight 中 Chick和Diet都是数字编码的分类变量，其中 Chick 是有序的因子变量，Diet 是无序的因子变量，而 Time 是数值型的变量，表示小鸡出生的天数。</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="data-frame.html#cb264-1"></a><span class="co"># 查看数据</span></span>
<span id="cb264-2"><a href="data-frame.html#cb264-2"></a><span class="kw">str</span>(ChickWeight)</span>
<span id="cb264-3"><a href="data-frame.html#cb264-3"></a><span class="co">#&gt; Classes &#39;nfnGroupedData&#39;, &#39;nfGroupedData&#39;, &#39;groupedData&#39; and &#39;data.frame&#39;:   578 obs. of  4 variables:</span></span>
<span id="cb264-4"><a href="data-frame.html#cb264-4"></a><span class="co">#&gt;  $ weight: num  42 51 59 64 76 93 106 125 149 171 ...</span></span>
<span id="cb264-5"><a href="data-frame.html#cb264-5"></a><span class="co">#&gt;  $ Time  : num  0 2 4 6 8 10 12 14 16 18 ...</span></span>
<span id="cb264-6"><a href="data-frame.html#cb264-6"></a><span class="co">#&gt;  $ Chick : Ord.factor w/ 50 levels &quot;18&quot;&lt;&quot;16&quot;&lt;&quot;15&quot;&lt;..: 15 15 15 15 15 15 15 15..</span></span>
<span id="cb264-7"><a href="data-frame.html#cb264-7"></a><span class="co">#&gt;  $ Diet  : Factor w/ 4 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb264-8"><a href="data-frame.html#cb264-8"></a><span class="co">#&gt;  - attr(*, &quot;formula&quot;)=Class &#39;formula&#39;  language weight ~ Time | Chick</span></span>
<span id="cb264-9"><a href="data-frame.html#cb264-9"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_EmptyEnv&gt; </span></span>
<span id="cb264-10"><a href="data-frame.html#cb264-10"></a><span class="co">#&gt;  - attr(*, &quot;outer&quot;)=Class &#39;formula&#39;  language ~Diet</span></span>
<span id="cb264-11"><a href="data-frame.html#cb264-11"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_EmptyEnv&gt; </span></span>
<span id="cb264-12"><a href="data-frame.html#cb264-12"></a><span class="co">#&gt;  - attr(*, &quot;labels&quot;)=List of 2</span></span>
<span id="cb264-13"><a href="data-frame.html#cb264-13"></a><span class="co">#&gt;   ..$ x: chr &quot;Time&quot;</span></span>
<span id="cb264-14"><a href="data-frame.html#cb264-14"></a><span class="co">#&gt;   ..$ y: chr &quot;Body weight&quot;</span></span>
<span id="cb264-15"><a href="data-frame.html#cb264-15"></a><span class="co">#&gt;  - attr(*, &quot;units&quot;)=List of 2</span></span>
<span id="cb264-16"><a href="data-frame.html#cb264-16"></a><span class="co">#&gt;   ..$ x: chr &quot;(days)&quot;</span></span>
<span id="cb264-17"><a href="data-frame.html#cb264-17"></a><span class="co">#&gt;   ..$ y: chr &quot;(gm)&quot;</span></span></code></pre></div>
<p>查看数据集ChickWeight的前几行</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="data-frame.html#cb265-1"></a><span class="kw">head</span>(ChickWeight)</span>
<span id="cb265-2"><a href="data-frame.html#cb265-2"></a><span class="co">#&gt;   weight Time Chick Diet</span></span>
<span id="cb265-3"><a href="data-frame.html#cb265-3"></a><span class="co">#&gt; 1     42    0     1    1</span></span>
<span id="cb265-4"><a href="data-frame.html#cb265-4"></a><span class="co">#&gt; 2     51    2     1    1</span></span>
<span id="cb265-5"><a href="data-frame.html#cb265-5"></a><span class="co">#&gt; 3     59    4     1    1</span></span>
<span id="cb265-6"><a href="data-frame.html#cb265-6"></a><span class="co">#&gt; 4     64    6     1    1</span></span>
<span id="cb265-7"><a href="data-frame.html#cb265-7"></a><span class="co">#&gt; 5     76    8     1    1</span></span>
<span id="cb265-8"><a href="data-frame.html#cb265-8"></a>....</span>
<span id="cb265-9"><a href="data-frame.html#cb265-9"></a><span class="kw">str</span>(ChickWeight)</span>
<span id="cb265-10"><a href="data-frame.html#cb265-10"></a><span class="co">#&gt; Classes &#39;nfnGroupedData&#39;, &#39;nfGroupedData&#39;, &#39;groupedData&#39; and &#39;data.frame&#39;:   578 obs. of  4 variables:</span></span>
<span id="cb265-11"><a href="data-frame.html#cb265-11"></a><span class="co">#&gt;  $ weight: num  42 51 59 64 76 93 106 125 149 171 ...</span></span>
<span id="cb265-12"><a href="data-frame.html#cb265-12"></a><span class="co">#&gt;  $ Time  : num  0 2 4 6 8 10 12 14 16 18 ...</span></span>
<span id="cb265-13"><a href="data-frame.html#cb265-13"></a><span class="co">#&gt;  $ Chick : Ord.factor w/ 50 levels &quot;18&quot;&lt;&quot;16&quot;&lt;&quot;15&quot;&lt;..: 15 15 15 15 15 15 15 15..</span></span>
<span id="cb265-14"><a href="data-frame.html#cb265-14"></a><span class="co">#&gt;  $ Diet  : Factor w/ 4 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb265-15"><a href="data-frame.html#cb265-15"></a><span class="co">#&gt;  - attr(*, &quot;formula&quot;)=Class &#39;formula&#39;  language weight ~ Time | Chick</span></span>
<span id="cb265-16"><a href="data-frame.html#cb265-16"></a>....</span></code></pre></div>
<p>对于数据集ChickWeight中的有序变量Chick，aggregate 会按照既定顺序返回分组计算的结果</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="data-frame.html#cb266-1"></a><span class="kw">aggregate</span>(weight <span class="op">~</span><span class="st"> </span>Chick, <span class="dt">data =</span> ChickWeight, mean)</span>
<span id="cb266-2"><a href="data-frame.html#cb266-2"></a><span class="co">#&gt;    Chick    weight</span></span>
<span id="cb266-3"><a href="data-frame.html#cb266-3"></a><span class="co">#&gt; 1     18  37.00000</span></span>
<span id="cb266-4"><a href="data-frame.html#cb266-4"></a><span class="co">#&gt; 2     16  49.71429</span></span>
<span id="cb266-5"><a href="data-frame.html#cb266-5"></a><span class="co">#&gt; 3     15  60.12500</span></span>
<span id="cb266-6"><a href="data-frame.html#cb266-6"></a><span class="co">#&gt; 4     13  67.83333</span></span>
<span id="cb266-7"><a href="data-frame.html#cb266-7"></a><span class="co">#&gt; 5      9  81.16667</span></span>
<span id="cb266-8"><a href="data-frame.html#cb266-8"></a>....</span>
<span id="cb266-9"><a href="data-frame.html#cb266-9"></a><span class="kw">aggregate</span>(weight <span class="op">~</span><span class="st"> </span>Diet, <span class="dt">data =</span> ChickWeight, mean)</span>
<span id="cb266-10"><a href="data-frame.html#cb266-10"></a><span class="co">#&gt;   Diet   weight</span></span>
<span id="cb266-11"><a href="data-frame.html#cb266-11"></a><span class="co">#&gt; 1    1 102.6455</span></span>
<span id="cb266-12"><a href="data-frame.html#cb266-12"></a><span class="co">#&gt; 2    2 122.6167</span></span>
<span id="cb266-13"><a href="data-frame.html#cb266-13"></a><span class="co">#&gt; 3    3 142.9500</span></span>
<span id="cb266-14"><a href="data-frame.html#cb266-14"></a><span class="co">#&gt; 4    4 135.2627</span></span></code></pre></div>
<p>分类变量没有用数字编码，以 CO2 数据集为例，该数据集描述草植对二氧化碳的吸收情况，Plant 是具有12个水平的有序的因子变量，Type表示植物的源头分别是魁北克(Quebec)和密西西比(Mississippi)，Treatment表示冷却(chilled)和不冷却(nonchilled)两种处理方式，conc表示周围环境中二氧化碳的浓度，uptake表示植物吸收二氧化碳的速率。</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="data-frame.html#cb267-1"></a><span class="co"># 查看数据集</span></span>
<span id="cb267-2"><a href="data-frame.html#cb267-2"></a><span class="kw">head</span>(CO2)</span>
<span id="cb267-3"><a href="data-frame.html#cb267-3"></a><span class="co">#&gt;   Plant   Type  Treatment conc uptake</span></span>
<span id="cb267-4"><a href="data-frame.html#cb267-4"></a><span class="co">#&gt; 1   Qn1 Quebec nonchilled   95   16.0</span></span>
<span id="cb267-5"><a href="data-frame.html#cb267-5"></a><span class="co">#&gt; 2   Qn1 Quebec nonchilled  175   30.4</span></span>
<span id="cb267-6"><a href="data-frame.html#cb267-6"></a><span class="co">#&gt; 3   Qn1 Quebec nonchilled  250   34.8</span></span>
<span id="cb267-7"><a href="data-frame.html#cb267-7"></a><span class="co">#&gt; 4   Qn1 Quebec nonchilled  350   37.2</span></span>
<span id="cb267-8"><a href="data-frame.html#cb267-8"></a><span class="co">#&gt; 5   Qn1 Quebec nonchilled  500   35.3</span></span>
<span id="cb267-9"><a href="data-frame.html#cb267-9"></a><span class="co">#&gt; 6   Qn1 Quebec nonchilled  675   39.2</span></span>
<span id="cb267-10"><a href="data-frame.html#cb267-10"></a><span class="kw">str</span>(CO2)</span>
<span id="cb267-11"><a href="data-frame.html#cb267-11"></a><span class="co">#&gt; Classes &#39;nfnGroupedData&#39;, &#39;nfGroupedData&#39;, &#39;groupedData&#39; and &#39;data.frame&#39;:   84 obs. of  5 variables:</span></span>
<span id="cb267-12"><a href="data-frame.html#cb267-12"></a><span class="co">#&gt;  $ Plant    : Ord.factor w/ 12 levels &quot;Qn1&quot;&lt;&quot;Qn2&quot;&lt;&quot;Qn3&quot;&lt;..: 1 1 1 1 1 1 1 2 2..</span></span>
<span id="cb267-13"><a href="data-frame.html#cb267-13"></a><span class="co">#&gt;  $ Type     : Factor w/ 2 levels &quot;Quebec&quot;,&quot;Mississippi&quot;: 1 1 1 1 1 1 1 1 1 1 ..</span></span>
<span id="cb267-14"><a href="data-frame.html#cb267-14"></a><span class="co">#&gt;  $ Treatment: Factor w/ 2 levels &quot;nonchilled&quot;,&quot;chilled&quot;: 1 1 1 1 1 1 1 1 1 1 ..</span></span>
<span id="cb267-15"><a href="data-frame.html#cb267-15"></a><span class="co">#&gt;  $ conc     : num  95 175 250 350 500 675 1000 95 175 250 ...</span></span>
<span id="cb267-16"><a href="data-frame.html#cb267-16"></a><span class="co">#&gt;  $ uptake   : num  16 30.4 34.8 37.2 35.3 39.2 39.7 13.6 27.3 37.1 ...</span></span>
<span id="cb267-17"><a href="data-frame.html#cb267-17"></a><span class="co">#&gt;  - attr(*, &quot;formula&quot;)=Class &#39;formula&#39;  language uptake ~ conc | Plant</span></span>
<span id="cb267-18"><a href="data-frame.html#cb267-18"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_EmptyEnv&gt; </span></span>
<span id="cb267-19"><a href="data-frame.html#cb267-19"></a><span class="co">#&gt;  - attr(*, &quot;outer&quot;)=Class &#39;formula&#39;  language ~Treatment * Type</span></span>
<span id="cb267-20"><a href="data-frame.html#cb267-20"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_EmptyEnv&gt; </span></span>
<span id="cb267-21"><a href="data-frame.html#cb267-21"></a><span class="co">#&gt;  - attr(*, &quot;labels&quot;)=List of 2</span></span>
<span id="cb267-22"><a href="data-frame.html#cb267-22"></a><span class="co">#&gt;   ..$ x: chr &quot;Ambient carbon dioxide concentration&quot;</span></span>
<span id="cb267-23"><a href="data-frame.html#cb267-23"></a><span class="co">#&gt;   ..$ y: chr &quot;CO2 uptake rate&quot;</span></span>
<span id="cb267-24"><a href="data-frame.html#cb267-24"></a><span class="co">#&gt;  - attr(*, &quot;units&quot;)=List of 2</span></span>
<span id="cb267-25"><a href="data-frame.html#cb267-25"></a><span class="co">#&gt;   ..$ x: chr &quot;(uL/L)&quot;</span></span>
<span id="cb267-26"><a href="data-frame.html#cb267-26"></a><span class="co">#&gt;   ..$ y: chr &quot;(umol/m^2 s)&quot;</span></span></code></pre></div>
<p>对单个变量分组统计</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="data-frame.html#cb268-1"></a><span class="kw">aggregate</span>(uptake <span class="op">~</span><span class="st"> </span>Plant, <span class="dt">data =</span> CO2, mean)</span>
<span id="cb268-2"><a href="data-frame.html#cb268-2"></a><span class="co">#&gt;    Plant   uptake</span></span>
<span id="cb268-3"><a href="data-frame.html#cb268-3"></a><span class="co">#&gt; 1    Qn1 33.22857</span></span>
<span id="cb268-4"><a href="data-frame.html#cb268-4"></a><span class="co">#&gt; 2    Qn2 35.15714</span></span>
<span id="cb268-5"><a href="data-frame.html#cb268-5"></a><span class="co">#&gt; 3    Qn3 37.61429</span></span>
<span id="cb268-6"><a href="data-frame.html#cb268-6"></a><span class="co">#&gt; 4    Qc1 29.97143</span></span>
<span id="cb268-7"><a href="data-frame.html#cb268-7"></a><span class="co">#&gt; 5    Qc3 32.58571</span></span>
<span id="cb268-8"><a href="data-frame.html#cb268-8"></a><span class="co">#&gt; 6    Qc2 32.70000</span></span>
<span id="cb268-9"><a href="data-frame.html#cb268-9"></a><span class="co">#&gt; 7    Mn3 24.11429</span></span>
<span id="cb268-10"><a href="data-frame.html#cb268-10"></a><span class="co">#&gt; 8    Mn2 27.34286</span></span>
<span id="cb268-11"><a href="data-frame.html#cb268-11"></a><span class="co">#&gt; 9    Mn1 26.40000</span></span>
<span id="cb268-12"><a href="data-frame.html#cb268-12"></a><span class="co">#&gt; 10   Mc2 12.14286</span></span>
<span id="cb268-13"><a href="data-frame.html#cb268-13"></a><span class="co">#&gt; 11   Mc3 17.30000</span></span>
<span id="cb268-14"><a href="data-frame.html#cb268-14"></a><span class="co">#&gt; 12   Mc1 18.00000</span></span>
<span id="cb268-15"><a href="data-frame.html#cb268-15"></a><span class="kw">aggregate</span>(uptake <span class="op">~</span><span class="st"> </span>Type, <span class="dt">data =</span> CO2, mean)</span>
<span id="cb268-16"><a href="data-frame.html#cb268-16"></a><span class="co">#&gt;          Type   uptake</span></span>
<span id="cb268-17"><a href="data-frame.html#cb268-17"></a><span class="co">#&gt; 1      Quebec 33.54286</span></span>
<span id="cb268-18"><a href="data-frame.html#cb268-18"></a><span class="co">#&gt; 2 Mississippi 20.88333</span></span>
<span id="cb268-19"><a href="data-frame.html#cb268-19"></a><span class="kw">aggregate</span>(uptake <span class="op">~</span><span class="st"> </span>Treatment, <span class="dt">data =</span> CO2, mean)</span>
<span id="cb268-20"><a href="data-frame.html#cb268-20"></a><span class="co">#&gt;    Treatment   uptake</span></span>
<span id="cb268-21"><a href="data-frame.html#cb268-21"></a><span class="co">#&gt; 1 nonchilled 30.64286</span></span>
<span id="cb268-22"><a href="data-frame.html#cb268-22"></a><span class="co">#&gt; 2    chilled 23.78333</span></span></code></pre></div>
<p>对多个变量分组统计，查看二氧化碳吸收速率uptake随类型Type和处理方式Treatment</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="data-frame.html#cb269-1"></a><span class="kw">aggregate</span>(uptake <span class="op">~</span><span class="st"> </span>Type <span class="op">+</span><span class="st"> </span>Treatment, <span class="dt">data =</span> CO2, mean)</span>
<span id="cb269-2"><a href="data-frame.html#cb269-2"></a><span class="co">#&gt;          Type  Treatment   uptake</span></span>
<span id="cb269-3"><a href="data-frame.html#cb269-3"></a><span class="co">#&gt; 1      Quebec nonchilled 35.33333</span></span>
<span id="cb269-4"><a href="data-frame.html#cb269-4"></a><span class="co">#&gt; 2 Mississippi nonchilled 25.95238</span></span>
<span id="cb269-5"><a href="data-frame.html#cb269-5"></a><span class="co">#&gt; 3      Quebec    chilled 31.75238</span></span>
<span id="cb269-6"><a href="data-frame.html#cb269-6"></a><span class="co">#&gt; 4 Mississippi    chilled 15.81429</span></span>
<span id="cb269-7"><a href="data-frame.html#cb269-7"></a><span class="kw">tapply</span>(CO2<span class="op">$</span>uptake, <span class="kw">list</span>(CO2<span class="op">$</span>Type, CO2<span class="op">$</span>Treatment), mean)</span>
<span id="cb269-8"><a href="data-frame.html#cb269-8"></a><span class="co">#&gt;             nonchilled  chilled</span></span>
<span id="cb269-9"><a href="data-frame.html#cb269-9"></a><span class="co">#&gt; Quebec        35.33333 31.75238</span></span>
<span id="cb269-10"><a href="data-frame.html#cb269-10"></a><span class="co">#&gt; Mississippi   25.95238 15.81429</span></span>
<span id="cb269-11"><a href="data-frame.html#cb269-11"></a><span class="kw">by</span>(CO2<span class="op">$</span>uptake, <span class="kw">list</span>(CO2<span class="op">$</span>Type, CO2<span class="op">$</span>Treatment), mean)</span>
<span id="cb269-12"><a href="data-frame.html#cb269-12"></a><span class="co">#&gt; : Quebec</span></span>
<span id="cb269-13"><a href="data-frame.html#cb269-13"></a><span class="co">#&gt; : nonchilled</span></span>
<span id="cb269-14"><a href="data-frame.html#cb269-14"></a><span class="co">#&gt; [1] 35.33333</span></span>
<span id="cb269-15"><a href="data-frame.html#cb269-15"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb269-16"><a href="data-frame.html#cb269-16"></a><span class="co">#&gt; : Mississippi</span></span>
<span id="cb269-17"><a href="data-frame.html#cb269-17"></a><span class="co">#&gt; : nonchilled</span></span>
<span id="cb269-18"><a href="data-frame.html#cb269-18"></a><span class="co">#&gt; [1] 25.95238</span></span>
<span id="cb269-19"><a href="data-frame.html#cb269-19"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb269-20"><a href="data-frame.html#cb269-20"></a><span class="co">#&gt; : Quebec</span></span>
<span id="cb269-21"><a href="data-frame.html#cb269-21"></a><span class="co">#&gt; : chilled</span></span>
<span id="cb269-22"><a href="data-frame.html#cb269-22"></a><span class="co">#&gt; [1] 31.75238</span></span>
<span id="cb269-23"><a href="data-frame.html#cb269-23"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb269-24"><a href="data-frame.html#cb269-24"></a><span class="co">#&gt; : Mississippi</span></span>
<span id="cb269-25"><a href="data-frame.html#cb269-25"></a><span class="co">#&gt; : chilled</span></span>
<span id="cb269-26"><a href="data-frame.html#cb269-26"></a><span class="co">#&gt; [1] 15.81429</span></span></code></pre></div>
<p>在这个例子中 tapply 和 by 的输出结果的表示形式不一样，aggregate 返回一个 data.frame 数据框，tapply 返回一个表格 table，by 返回特殊的数据类型 by。</p>
<p>Function <code>by</code> is an object-oriented wrapper for <code>tapply</code> applied to data frames.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="data-frame.html#cb270-1"></a><span class="co"># 分组求和</span></span>
<span id="cb270-2"><a href="data-frame.html#cb270-2"></a><span class="co"># by(iris[, 1], INDICES = list(iris$Species), FUN = sum)</span></span>
<span id="cb270-3"><a href="data-frame.html#cb270-3"></a><span class="co"># by(iris[, 2], INDICES = list(iris$Species), FUN = sum)</span></span>
<span id="cb270-4"><a href="data-frame.html#cb270-4"></a><span class="kw">by</span>(iris[, <span class="dv">3</span>], <span class="dt">INDICES =</span> <span class="kw">list</span>(iris<span class="op">$</span>Species), <span class="dt">FUN =</span> sum)</span>
<span id="cb270-5"><a href="data-frame.html#cb270-5"></a><span class="co">#&gt; : setosa</span></span>
<span id="cb270-6"><a href="data-frame.html#cb270-6"></a><span class="co">#&gt; [1] 73.1</span></span>
<span id="cb270-7"><a href="data-frame.html#cb270-7"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb270-8"><a href="data-frame.html#cb270-8"></a><span class="co">#&gt; : versicolor</span></span>
<span id="cb270-9"><a href="data-frame.html#cb270-9"></a><span class="co">#&gt; [1] 213</span></span>
<span id="cb270-10"><a href="data-frame.html#cb270-10"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb270-11"><a href="data-frame.html#cb270-11"></a><span class="co">#&gt; : virginica</span></span>
<span id="cb270-12"><a href="data-frame.html#cb270-12"></a><span class="co">#&gt; [1] 277.6</span></span>
<span id="cb270-13"><a href="data-frame.html#cb270-13"></a><span class="kw">by</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">INDICES =</span> <span class="kw">list</span>(iris<span class="op">$</span>Species), <span class="dt">FUN =</span> sum)</span>
<span id="cb270-14"><a href="data-frame.html#cb270-14"></a><span class="co">#&gt; : setosa</span></span>
<span id="cb270-15"><a href="data-frame.html#cb270-15"></a><span class="co">#&gt; [1] 494.8</span></span>
<span id="cb270-16"><a href="data-frame.html#cb270-16"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb270-17"><a href="data-frame.html#cb270-17"></a><span class="co">#&gt; : versicolor</span></span>
<span id="cb270-18"><a href="data-frame.html#cb270-18"></a><span class="co">#&gt; [1] 648.3</span></span>
<span id="cb270-19"><a href="data-frame.html#cb270-19"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb270-20"><a href="data-frame.html#cb270-20"></a><span class="co">#&gt; : virginica</span></span>
<span id="cb270-21"><a href="data-frame.html#cb270-21"></a><span class="co">#&gt; [1] 755.7</span></span>
<span id="cb270-22"><a href="data-frame.html#cb270-22"></a><span class="kw">by</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">INDICES =</span> <span class="kw">list</span>(iris<span class="op">$</span>Species), <span class="dt">FUN =</span> summary)</span>
<span id="cb270-23"><a href="data-frame.html#cb270-23"></a><span class="co">#&gt; : setosa</span></span>
<span id="cb270-24"><a href="data-frame.html#cb270-24"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length  </span></span>
<span id="cb270-25"><a href="data-frame.html#cb270-25"></a><span class="co">#&gt;  Min.   :4.300   Min.   :2.300   Min.   :1.000  </span></span>
<span id="cb270-26"><a href="data-frame.html#cb270-26"></a><span class="co">#&gt;  1st Qu.:4.800   1st Qu.:3.200   1st Qu.:1.400  </span></span>
<span id="cb270-27"><a href="data-frame.html#cb270-27"></a><span class="co">#&gt;  Median :5.000   Median :3.400   Median :1.500  </span></span>
<span id="cb270-28"><a href="data-frame.html#cb270-28"></a><span class="co">#&gt;  Mean   :5.006   Mean   :3.428   Mean   :1.462  </span></span>
<span id="cb270-29"><a href="data-frame.html#cb270-29"></a><span class="co">#&gt;  3rd Qu.:5.200   3rd Qu.:3.675   3rd Qu.:1.575  </span></span>
<span id="cb270-30"><a href="data-frame.html#cb270-30"></a><span class="co">#&gt;  Max.   :5.800   Max.   :4.400   Max.   :1.900  </span></span>
<span id="cb270-31"><a href="data-frame.html#cb270-31"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb270-32"><a href="data-frame.html#cb270-32"></a><span class="co">#&gt; : versicolor</span></span>
<span id="cb270-33"><a href="data-frame.html#cb270-33"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length </span></span>
<span id="cb270-34"><a href="data-frame.html#cb270-34"></a><span class="co">#&gt;  Min.   :4.900   Min.   :2.000   Min.   :3.00  </span></span>
<span id="cb270-35"><a href="data-frame.html#cb270-35"></a><span class="co">#&gt;  1st Qu.:5.600   1st Qu.:2.525   1st Qu.:4.00  </span></span>
<span id="cb270-36"><a href="data-frame.html#cb270-36"></a><span class="co">#&gt;  Median :5.900   Median :2.800   Median :4.35  </span></span>
<span id="cb270-37"><a href="data-frame.html#cb270-37"></a><span class="co">#&gt;  Mean   :5.936   Mean   :2.770   Mean   :4.26  </span></span>
<span id="cb270-38"><a href="data-frame.html#cb270-38"></a><span class="co">#&gt;  3rd Qu.:6.300   3rd Qu.:3.000   3rd Qu.:4.60  </span></span>
<span id="cb270-39"><a href="data-frame.html#cb270-39"></a><span class="co">#&gt;  Max.   :7.000   Max.   :3.400   Max.   :5.10  </span></span>
<span id="cb270-40"><a href="data-frame.html#cb270-40"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb270-41"><a href="data-frame.html#cb270-41"></a><span class="co">#&gt; : virginica</span></span>
<span id="cb270-42"><a href="data-frame.html#cb270-42"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length  </span></span>
<span id="cb270-43"><a href="data-frame.html#cb270-43"></a><span class="co">#&gt;  Min.   :4.900   Min.   :2.200   Min.   :4.500  </span></span>
<span id="cb270-44"><a href="data-frame.html#cb270-44"></a><span class="co">#&gt;  1st Qu.:6.225   1st Qu.:2.800   1st Qu.:5.100  </span></span>
<span id="cb270-45"><a href="data-frame.html#cb270-45"></a><span class="co">#&gt;  Median :6.500   Median :3.000   Median :5.550  </span></span>
<span id="cb270-46"><a href="data-frame.html#cb270-46"></a><span class="co">#&gt;  Mean   :6.588   Mean   :2.974   Mean   :5.552  </span></span>
<span id="cb270-47"><a href="data-frame.html#cb270-47"></a><span class="co">#&gt;  3rd Qu.:6.900   3rd Qu.:3.175   3rd Qu.:5.875  </span></span>
<span id="cb270-48"><a href="data-frame.html#cb270-48"></a><span class="co">#&gt;  Max.   :7.900   Max.   :3.800   Max.   :6.900</span></span>
<span id="cb270-49"><a href="data-frame.html#cb270-49"></a><span class="kw">by</span>(iris, <span class="dt">INDICES =</span> <span class="kw">list</span>(iris<span class="op">$</span>Species), <span class="dt">FUN =</span> summary)</span>
<span id="cb270-50"><a href="data-frame.html#cb270-50"></a><span class="co">#&gt; : setosa</span></span>
<span id="cb270-51"><a href="data-frame.html#cb270-51"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   </span></span>
<span id="cb270-52"><a href="data-frame.html#cb270-52"></a><span class="co">#&gt;  Min.   :4.300   Min.   :2.300   Min.   :1.000   Min.   :0.100  </span></span>
<span id="cb270-53"><a href="data-frame.html#cb270-53"></a><span class="co">#&gt;  1st Qu.:4.800   1st Qu.:3.200   1st Qu.:1.400   1st Qu.:0.200  </span></span>
<span id="cb270-54"><a href="data-frame.html#cb270-54"></a><span class="co">#&gt;  Median :5.000   Median :3.400   Median :1.500   Median :0.200  </span></span>
<span id="cb270-55"><a href="data-frame.html#cb270-55"></a><span class="co">#&gt;  Mean   :5.006   Mean   :3.428   Mean   :1.462   Mean   :0.246  </span></span>
<span id="cb270-56"><a href="data-frame.html#cb270-56"></a><span class="co">#&gt;  3rd Qu.:5.200   3rd Qu.:3.675   3rd Qu.:1.575   3rd Qu.:0.300  </span></span>
<span id="cb270-57"><a href="data-frame.html#cb270-57"></a><span class="co">#&gt;  Max.   :5.800   Max.   :4.400   Max.   :1.900   Max.   :0.600  </span></span>
<span id="cb270-58"><a href="data-frame.html#cb270-58"></a><span class="co">#&gt;        Species  </span></span>
<span id="cb270-59"><a href="data-frame.html#cb270-59"></a><span class="co">#&gt;  setosa    :50  </span></span>
<span id="cb270-60"><a href="data-frame.html#cb270-60"></a><span class="co">#&gt;  versicolor: 0  </span></span>
<span id="cb270-61"><a href="data-frame.html#cb270-61"></a><span class="co">#&gt;  virginica : 0  </span></span>
<span id="cb270-62"><a href="data-frame.html#cb270-62"></a><span class="co">#&gt;                 </span></span>
<span id="cb270-63"><a href="data-frame.html#cb270-63"></a><span class="co">#&gt;                 </span></span>
<span id="cb270-64"><a href="data-frame.html#cb270-64"></a><span class="co">#&gt;                 </span></span>
<span id="cb270-65"><a href="data-frame.html#cb270-65"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb270-66"><a href="data-frame.html#cb270-66"></a><span class="co">#&gt; : versicolor</span></span>
<span id="cb270-67"><a href="data-frame.html#cb270-67"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length   Petal.Width   </span></span>
<span id="cb270-68"><a href="data-frame.html#cb270-68"></a><span class="co">#&gt;  Min.   :4.900   Min.   :2.000   Min.   :3.00   Min.   :1.000  </span></span>
<span id="cb270-69"><a href="data-frame.html#cb270-69"></a><span class="co">#&gt;  1st Qu.:5.600   1st Qu.:2.525   1st Qu.:4.00   1st Qu.:1.200  </span></span>
<span id="cb270-70"><a href="data-frame.html#cb270-70"></a><span class="co">#&gt;  Median :5.900   Median :2.800   Median :4.35   Median :1.300  </span></span>
<span id="cb270-71"><a href="data-frame.html#cb270-71"></a><span class="co">#&gt;  Mean   :5.936   Mean   :2.770   Mean   :4.26   Mean   :1.326  </span></span>
<span id="cb270-72"><a href="data-frame.html#cb270-72"></a><span class="co">#&gt;  3rd Qu.:6.300   3rd Qu.:3.000   3rd Qu.:4.60   3rd Qu.:1.500  </span></span>
<span id="cb270-73"><a href="data-frame.html#cb270-73"></a><span class="co">#&gt;  Max.   :7.000   Max.   :3.400   Max.   :5.10   Max.   :1.800  </span></span>
<span id="cb270-74"><a href="data-frame.html#cb270-74"></a><span class="co">#&gt;        Species  </span></span>
<span id="cb270-75"><a href="data-frame.html#cb270-75"></a><span class="co">#&gt;  setosa    : 0  </span></span>
<span id="cb270-76"><a href="data-frame.html#cb270-76"></a><span class="co">#&gt;  versicolor:50  </span></span>
<span id="cb270-77"><a href="data-frame.html#cb270-77"></a><span class="co">#&gt;  virginica : 0  </span></span>
<span id="cb270-78"><a href="data-frame.html#cb270-78"></a><span class="co">#&gt;                 </span></span>
<span id="cb270-79"><a href="data-frame.html#cb270-79"></a><span class="co">#&gt;                 </span></span>
<span id="cb270-80"><a href="data-frame.html#cb270-80"></a><span class="co">#&gt;                 </span></span>
<span id="cb270-81"><a href="data-frame.html#cb270-81"></a><span class="co">#&gt; ----------------------------------------------------------- </span></span>
<span id="cb270-82"><a href="data-frame.html#cb270-82"></a><span class="co">#&gt; : virginica</span></span>
<span id="cb270-83"><a href="data-frame.html#cb270-83"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   </span></span>
<span id="cb270-84"><a href="data-frame.html#cb270-84"></a><span class="co">#&gt;  Min.   :4.900   Min.   :2.200   Min.   :4.500   Min.   :1.400  </span></span>
<span id="cb270-85"><a href="data-frame.html#cb270-85"></a><span class="co">#&gt;  1st Qu.:6.225   1st Qu.:2.800   1st Qu.:5.100   1st Qu.:1.800  </span></span>
<span id="cb270-86"><a href="data-frame.html#cb270-86"></a><span class="co">#&gt;  Median :6.500   Median :3.000   Median :5.550   Median :2.000  </span></span>
<span id="cb270-87"><a href="data-frame.html#cb270-87"></a><span class="co">#&gt;  Mean   :6.588   Mean   :2.974   Mean   :5.552   Mean   :2.026  </span></span>
<span id="cb270-88"><a href="data-frame.html#cb270-88"></a><span class="co">#&gt;  3rd Qu.:6.900   3rd Qu.:3.175   3rd Qu.:5.875   3rd Qu.:2.300  </span></span>
<span id="cb270-89"><a href="data-frame.html#cb270-89"></a><span class="co">#&gt;  Max.   :7.900   Max.   :3.800   Max.   :6.900   Max.   :2.500  </span></span>
<span id="cb270-90"><a href="data-frame.html#cb270-90"></a><span class="co">#&gt;        Species  </span></span>
<span id="cb270-91"><a href="data-frame.html#cb270-91"></a><span class="co">#&gt;  setosa    : 0  </span></span>
<span id="cb270-92"><a href="data-frame.html#cb270-92"></a><span class="co">#&gt;  versicolor: 0  </span></span>
<span id="cb270-93"><a href="data-frame.html#cb270-93"></a><span class="co">#&gt;  virginica :50  </span></span>
<span id="cb270-94"><a href="data-frame.html#cb270-94"></a><span class="co">#&gt;                 </span></span>
<span id="cb270-95"><a href="data-frame.html#cb270-95"></a><span class="co">#&gt;                 </span></span>
<span id="cb270-96"><a href="data-frame.html#cb270-96"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>Group Averages Over Level Combinations of Factors 分组平均</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="data-frame.html#cb271-1"></a><span class="kw">str</span>(warpbreaks)</span>
<span id="cb271-2"><a href="data-frame.html#cb271-2"></a><span class="co">#&gt; &#39;data.frame&#39;:    54 obs. of  3 variables:</span></span>
<span id="cb271-3"><a href="data-frame.html#cb271-3"></a><span class="co">#&gt;  $ breaks : num  26 30 54 25 70 52 51 26 67 18 ...</span></span>
<span id="cb271-4"><a href="data-frame.html#cb271-4"></a><span class="co">#&gt;  $ wool   : Factor w/ 2 levels &quot;A&quot;,&quot;B&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb271-5"><a href="data-frame.html#cb271-5"></a><span class="co">#&gt;  $ tension: Factor w/ 3 levels &quot;L&quot;,&quot;M&quot;,&quot;H&quot;: 1 1 1 1 1 1 1 1 1 2 ...</span></span>
<span id="cb271-6"><a href="data-frame.html#cb271-6"></a><span class="kw">head</span>(warpbreaks)</span>
<span id="cb271-7"><a href="data-frame.html#cb271-7"></a><span class="co">#&gt;   breaks wool tension</span></span>
<span id="cb271-8"><a href="data-frame.html#cb271-8"></a><span class="co">#&gt; 1     26    A       L</span></span>
<span id="cb271-9"><a href="data-frame.html#cb271-9"></a><span class="co">#&gt; 2     30    A       L</span></span>
<span id="cb271-10"><a href="data-frame.html#cb271-10"></a><span class="co">#&gt; 3     54    A       L</span></span>
<span id="cb271-11"><a href="data-frame.html#cb271-11"></a><span class="co">#&gt; 4     25    A       L</span></span>
<span id="cb271-12"><a href="data-frame.html#cb271-12"></a><span class="co">#&gt; 5     70    A       L</span></span>
<span id="cb271-13"><a href="data-frame.html#cb271-13"></a><span class="co">#&gt; 6     52    A       L</span></span>
<span id="cb271-14"><a href="data-frame.html#cb271-14"></a></span>
<span id="cb271-15"><a href="data-frame.html#cb271-15"></a><span class="kw">ave</span>(warpbreaks<span class="op">$</span>breaks, warpbreaks<span class="op">$</span>wool)</span>
<span id="cb271-16"><a href="data-frame.html#cb271-16"></a><span class="co">#&gt;  [1] 31.03704 31.03704 31.03704 31.03704 31.03704 31.03704 31.03704 31.03704</span></span>
<span id="cb271-17"><a href="data-frame.html#cb271-17"></a><span class="co">#&gt;  [9] 31.03704 31.03704 31.03704 31.03704 31.03704 31.03704 31.03704 31.03704</span></span>
<span id="cb271-18"><a href="data-frame.html#cb271-18"></a><span class="co">#&gt; [17] 31.03704 31.03704 31.03704 31.03704 31.03704 31.03704 31.03704 31.03704</span></span>
<span id="cb271-19"><a href="data-frame.html#cb271-19"></a><span class="co">#&gt; [25] 31.03704 31.03704 31.03704 25.25926 25.25926 25.25926 25.25926 25.25926</span></span>
<span id="cb271-20"><a href="data-frame.html#cb271-20"></a><span class="co">#&gt; [33] 25.25926 25.25926 25.25926 25.25926 25.25926 25.25926 25.25926 25.25926</span></span>
<span id="cb271-21"><a href="data-frame.html#cb271-21"></a><span class="co">#&gt; [41] 25.25926 25.25926 25.25926 25.25926 25.25926 25.25926 25.25926 25.25926</span></span>
<span id="cb271-22"><a href="data-frame.html#cb271-22"></a><span class="co">#&gt; [49] 25.25926 25.25926 25.25926 25.25926 25.25926 25.25926</span></span>
<span id="cb271-23"><a href="data-frame.html#cb271-23"></a><span class="kw">with</span>(warpbreaks, <span class="kw">ave</span>(breaks, tension, <span class="dt">FUN =</span> <span class="cf">function</span>(x) <span class="kw">mean</span>(x, <span class="dt">trim =</span> <span class="fl">0.1</span>)))</span>
<span id="cb271-24"><a href="data-frame.html#cb271-24"></a><span class="co">#&gt;  [1] 35.6875 35.6875 35.6875 35.6875 35.6875 35.6875 35.6875 35.6875 35.6875</span></span>
<span id="cb271-25"><a href="data-frame.html#cb271-25"></a><span class="co">#&gt; [10] 26.3125 26.3125 26.3125 26.3125 26.3125 26.3125 26.3125 26.3125 26.3125</span></span>
<span id="cb271-26"><a href="data-frame.html#cb271-26"></a><span class="co">#&gt; [19] 21.0625 21.0625 21.0625 21.0625 21.0625 21.0625 21.0625 21.0625 21.0625</span></span>
<span id="cb271-27"><a href="data-frame.html#cb271-27"></a><span class="co">#&gt; [28] 35.6875 35.6875 35.6875 35.6875 35.6875 35.6875 35.6875 35.6875 35.6875</span></span>
<span id="cb271-28"><a href="data-frame.html#cb271-28"></a><span class="co">#&gt; [37] 26.3125 26.3125 26.3125 26.3125 26.3125 26.3125 26.3125 26.3125 26.3125</span></span>
<span id="cb271-29"><a href="data-frame.html#cb271-29"></a><span class="co">#&gt; [46] 21.0625 21.0625 21.0625 21.0625 21.0625 21.0625 21.0625 21.0625 21.0625</span></span>
<span id="cb271-30"><a href="data-frame.html#cb271-30"></a><span class="co"># 分组求和</span></span>
<span id="cb271-31"><a href="data-frame.html#cb271-31"></a><span class="kw">with</span>(warpbreaks, <span class="kw">ave</span>(breaks, tension, <span class="dt">FUN =</span> <span class="cf">function</span>(x) <span class="kw">sum</span>(x)))</span>
<span id="cb271-32"><a href="data-frame.html#cb271-32"></a><span class="co">#&gt;  [1] 655 655 655 655 655 655 655 655 655 475 475 475 475 475 475 475 475 475</span></span>
<span id="cb271-33"><a href="data-frame.html#cb271-33"></a><span class="co">#&gt; [19] 390 390 390 390 390 390 390 390 390 655 655 655 655 655 655 655 655 655</span></span>
<span id="cb271-34"><a href="data-frame.html#cb271-34"></a><span class="co">#&gt; [37] 475 475 475 475 475 475 475 475 475 390 390 390 390 390 390 390 390 390</span></span>
<span id="cb271-35"><a href="data-frame.html#cb271-35"></a><span class="co"># 分组求和</span></span>
<span id="cb271-36"><a href="data-frame.html#cb271-36"></a><span class="kw">with</span>(iris, <span class="kw">ave</span>(Sepal.Length, Species, <span class="dt">FUN =</span> <span class="cf">function</span>(x) <span class="kw">sum</span>(x)))</span>
<span id="cb271-37"><a href="data-frame.html#cb271-37"></a><span class="co">#&gt;   [1] 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3</span></span>
<span id="cb271-38"><a href="data-frame.html#cb271-38"></a><span class="co">#&gt;  [13] 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3</span></span>
<span id="cb271-39"><a href="data-frame.html#cb271-39"></a><span class="co">#&gt;  [25] 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3</span></span>
<span id="cb271-40"><a href="data-frame.html#cb271-40"></a><span class="co">#&gt;  [37] 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3 250.3</span></span>
<span id="cb271-41"><a href="data-frame.html#cb271-41"></a><span class="co">#&gt;  [49] 250.3 250.3 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8</span></span>
<span id="cb271-42"><a href="data-frame.html#cb271-42"></a><span class="co">#&gt;  [61] 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8</span></span>
<span id="cb271-43"><a href="data-frame.html#cb271-43"></a><span class="co">#&gt;  [73] 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8</span></span>
<span id="cb271-44"><a href="data-frame.html#cb271-44"></a><span class="co">#&gt;  [85] 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8 296.8</span></span>
<span id="cb271-45"><a href="data-frame.html#cb271-45"></a><span class="co">#&gt;  [97] 296.8 296.8 296.8 296.8 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4</span></span>
<span id="cb271-46"><a href="data-frame.html#cb271-46"></a><span class="co">#&gt; [109] 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4</span></span>
<span id="cb271-47"><a href="data-frame.html#cb271-47"></a><span class="co">#&gt; [121] 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4</span></span>
<span id="cb271-48"><a href="data-frame.html#cb271-48"></a><span class="co">#&gt; [133] 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4 329.4</span></span>
<span id="cb271-49"><a href="data-frame.html#cb271-49"></a><span class="co">#&gt; [145] 329.4 329.4 329.4 329.4 329.4 329.4</span></span></code></pre></div>
</div>
<div id="base-table" class="section level2">
<h2><span class="header-section-number">5.11</span> 表格统计</h2>
<blockquote>
<p>介绍操作表格的 table, addmargins, prop.table, xtabs, margin.table, ftabe 等函数</p>
</blockquote>
<p>table 多个分类变量分组计数统计</p>
<ul>
<li>介绍 warpbreaks 和 airquality 纽约空气质量监测数据集 二维的数据框</li>
<li>UCBAdmissions 1973 年加州大学伯克利分校的院系录取数据集 3维的列联表</li>
<li>Titanic 4维的列联表数据 泰坦尼克号幸存者数据集</li>
</ul>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="data-frame.html#cb272-1"></a><span class="kw">with</span>(warpbreaks, <span class="kw">table</span>(wool, tension))</span>
<span id="cb272-2"><a href="data-frame.html#cb272-2"></a><span class="co">#&gt;     tension</span></span>
<span id="cb272-3"><a href="data-frame.html#cb272-3"></a><span class="co">#&gt; wool L M H</span></span>
<span id="cb272-4"><a href="data-frame.html#cb272-4"></a><span class="co">#&gt;    A 9 9 9</span></span>
<span id="cb272-5"><a href="data-frame.html#cb272-5"></a><span class="co">#&gt;    B 9 9 9</span></span></code></pre></div>
<p>以 iris 数据集为例，table 的第一个参数是自己制造的第二个分类变量，原始分类变量是 Species</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="data-frame.html#cb273-1"></a><span class="kw">with</span>(iris, <span class="kw">table</span>(<span class="dt">Sepal.check =</span> Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>, Species))</span>
<span id="cb273-2"><a href="data-frame.html#cb273-2"></a><span class="co">#&gt;            Species</span></span>
<span id="cb273-3"><a href="data-frame.html#cb273-3"></a><span class="co">#&gt; Sepal.check setosa versicolor virginica</span></span>
<span id="cb273-4"><a href="data-frame.html#cb273-4"></a><span class="co">#&gt;       FALSE     50         50        38</span></span>
<span id="cb273-5"><a href="data-frame.html#cb273-5"></a><span class="co">#&gt;       TRUE       0          0        12</span></span>
<span id="cb273-6"><a href="data-frame.html#cb273-6"></a><span class="kw">with</span>(iris, <span class="kw">table</span>(<span class="dt">Sepal.check =</span> Sepal.Length <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(Sepal.Length), Species))</span>
<span id="cb273-7"><a href="data-frame.html#cb273-7"></a><span class="co">#&gt;            Species</span></span>
<span id="cb273-8"><a href="data-frame.html#cb273-8"></a><span class="co">#&gt; Sepal.check setosa versicolor virginica</span></span>
<span id="cb273-9"><a href="data-frame.html#cb273-9"></a><span class="co">#&gt;       FALSE     50         24         6</span></span>
<span id="cb273-10"><a href="data-frame.html#cb273-10"></a><span class="co">#&gt;       TRUE       0         26        44</span></span></code></pre></div>
<p>以 airquality 数据集为例，看看月份中臭氧含量比较高的几天</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="data-frame.html#cb274-1"></a>aiq.tab &lt;-<span class="st"> </span><span class="kw">with</span>(airquality, <span class="kw">table</span>(<span class="dt">Oz.high =</span> Ozone <span class="op">&gt;</span><span class="st"> </span><span class="dv">80</span>, Month))</span>
<span id="cb274-2"><a href="data-frame.html#cb274-2"></a>aiq.tab</span>
<span id="cb274-3"><a href="data-frame.html#cb274-3"></a><span class="co">#&gt;        Month</span></span>
<span id="cb274-4"><a href="data-frame.html#cb274-4"></a><span class="co">#&gt; Oz.high  5  6  7  8  9</span></span>
<span id="cb274-5"><a href="data-frame.html#cb274-5"></a><span class="co">#&gt;   FALSE 25  9 20 19 27</span></span>
<span id="cb274-6"><a href="data-frame.html#cb274-6"></a><span class="co">#&gt;   TRUE   1  0  6  7  2</span></span></code></pre></div>
<p>对表格按行和列求和，即求表格的边际，查看总体情况</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="data-frame.html#cb275-1"></a><span class="kw">addmargins</span>(aiq.tab, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb275-2"><a href="data-frame.html#cb275-2"></a><span class="co">#&gt;        Month</span></span>
<span id="cb275-3"><a href="data-frame.html#cb275-3"></a><span class="co">#&gt; Oz.high   5   6   7   8   9 Sum</span></span>
<span id="cb275-4"><a href="data-frame.html#cb275-4"></a><span class="co">#&gt;   FALSE  25   9  20  19  27 100</span></span>
<span id="cb275-5"><a href="data-frame.html#cb275-5"></a><span class="co">#&gt;   TRUE    1   0   6   7   2  16</span></span>
<span id="cb275-6"><a href="data-frame.html#cb275-6"></a><span class="co">#&gt;   Sum    26   9  26  26  29 116</span></span></code></pre></div>
<p>臭氧含量超 80 的天数在每个月的占比，<code>addmargins</code> 的第二个参数 1 表示对列求和</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="data-frame.html#cb276-1"></a>aiq.prop &lt;-<span class="st"> </span><span class="kw">prop.table</span>(aiq.tab, <span class="dv">2</span>)</span>
<span id="cb276-2"><a href="data-frame.html#cb276-2"></a>aiq.prop</span>
<span id="cb276-3"><a href="data-frame.html#cb276-3"></a><span class="co">#&gt;        Month</span></span>
<span id="cb276-4"><a href="data-frame.html#cb276-4"></a><span class="co">#&gt; Oz.high          5          6          7          8          9</span></span>
<span id="cb276-5"><a href="data-frame.html#cb276-5"></a><span class="co">#&gt;   FALSE 0.96153846 1.00000000 0.76923077 0.73076923 0.93103448</span></span>
<span id="cb276-6"><a href="data-frame.html#cb276-6"></a><span class="co">#&gt;   TRUE  0.03846154 0.00000000 0.23076923 0.26923077 0.06896552</span></span>
<span id="cb276-7"><a href="data-frame.html#cb276-7"></a>aiq.marprop &lt;-<span class="st"> </span><span class="kw">addmargins</span>(aiq.prop, <span class="dv">1</span>)</span>
<span id="cb276-8"><a href="data-frame.html#cb276-8"></a>aiq.marprop</span>
<span id="cb276-9"><a href="data-frame.html#cb276-9"></a><span class="co">#&gt;        Month</span></span>
<span id="cb276-10"><a href="data-frame.html#cb276-10"></a><span class="co">#&gt; Oz.high          5          6          7          8          9</span></span>
<span id="cb276-11"><a href="data-frame.html#cb276-11"></a><span class="co">#&gt;   FALSE 0.96153846 1.00000000 0.76923077 0.73076923 0.93103448</span></span>
<span id="cb276-12"><a href="data-frame.html#cb276-12"></a><span class="co">#&gt;   TRUE  0.03846154 0.00000000 0.23076923 0.26923077 0.06896552</span></span>
<span id="cb276-13"><a href="data-frame.html#cb276-13"></a><span class="co">#&gt;   Sum   1.00000000 1.00000000 1.00000000 1.00000000 1.00000000</span></span></code></pre></div>
<p>转换成百分比，将小数四舍五入转化为百分数，保留两位小数点</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="data-frame.html#cb277-1"></a><span class="kw">round</span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span>aiq.marprop, <span class="dv">2</span>)</span>
<span id="cb277-2"><a href="data-frame.html#cb277-2"></a><span class="co">#&gt;        Month</span></span>
<span id="cb277-3"><a href="data-frame.html#cb277-3"></a><span class="co">#&gt; Oz.high      5      6      7      8      9</span></span>
<span id="cb277-4"><a href="data-frame.html#cb277-4"></a><span class="co">#&gt;   FALSE  96.15 100.00  76.92  73.08  93.10</span></span>
<span id="cb277-5"><a href="data-frame.html#cb277-5"></a><span class="co">#&gt;   TRUE    3.85   0.00  23.08  26.92   6.90</span></span>
<span id="cb277-6"><a href="data-frame.html#cb277-6"></a><span class="co">#&gt;   Sum   100.00 100.00 100.00 100.00 100.00</span></span></code></pre></div>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="data-frame.html#cb278-1"></a><span class="kw">pairs</span>(airquality, <span class="dt">panel =</span> panel.smooth, <span class="dt">main =</span> <span class="st">&quot;airquality data&quot;</span>)</span></code></pre></div>
<p>以 UCBAdmissions 数据集为例，使用 <code>xtabs</code> 函数把数据组织成列联表，先查看数据的内容</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="data-frame.html#cb279-1"></a>UCBAdmissions</span>
<span id="cb279-2"><a href="data-frame.html#cb279-2"></a><span class="co">#&gt; , , Dept = A</span></span>
<span id="cb279-3"><a href="data-frame.html#cb279-3"></a><span class="co">#&gt; </span></span>
<span id="cb279-4"><a href="data-frame.html#cb279-4"></a><span class="co">#&gt;           Gender</span></span>
<span id="cb279-5"><a href="data-frame.html#cb279-5"></a><span class="co">#&gt; Admit      Male Female</span></span>
<span id="cb279-6"><a href="data-frame.html#cb279-6"></a><span class="co">#&gt;   Admitted  512     89</span></span>
<span id="cb279-7"><a href="data-frame.html#cb279-7"></a><span class="co">#&gt;   Rejected  313     19</span></span>
<span id="cb279-8"><a href="data-frame.html#cb279-8"></a>....</span>
<span id="cb279-9"><a href="data-frame.html#cb279-9"></a>UCBA2DF &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(UCBAdmissions)</span>
<span id="cb279-10"><a href="data-frame.html#cb279-10"></a>UCBA2DF</span>
<span id="cb279-11"><a href="data-frame.html#cb279-11"></a><span class="co">#&gt;       Admit Gender Dept Freq</span></span>
<span id="cb279-12"><a href="data-frame.html#cb279-12"></a><span class="co">#&gt; 1  Admitted   Male    A  512</span></span>
<span id="cb279-13"><a href="data-frame.html#cb279-13"></a><span class="co">#&gt; 2  Rejected   Male    A  313</span></span>
<span id="cb279-14"><a href="data-frame.html#cb279-14"></a><span class="co">#&gt; 3  Admitted Female    A   89</span></span>
<span id="cb279-15"><a href="data-frame.html#cb279-15"></a><span class="co">#&gt; 4  Rejected Female    A   19</span></span>
<span id="cb279-16"><a href="data-frame.html#cb279-16"></a><span class="co">#&gt; 5  Admitted   Male    B  353</span></span>
<span id="cb279-17"><a href="data-frame.html#cb279-17"></a>....</span></code></pre></div>
<p>接着将 <code>UCBA2DF</code> 数据集转化为表格的形式</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="data-frame.html#cb280-1"></a>UCBA2DF.tab &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>Gender <span class="op">+</span><span class="st"> </span>Admit <span class="op">+</span><span class="st"> </span>Dept, <span class="dt">data =</span> UCBA2DF)</span>
<span id="cb280-2"><a href="data-frame.html#cb280-2"></a><span class="kw">ftable</span>(UCBA2DF.tab)</span>
<span id="cb280-3"><a href="data-frame.html#cb280-3"></a><span class="co">#&gt;                 Dept   A   B   C   D   E   F</span></span>
<span id="cb280-4"><a href="data-frame.html#cb280-4"></a><span class="co">#&gt; Gender Admit                                </span></span>
<span id="cb280-5"><a href="data-frame.html#cb280-5"></a><span class="co">#&gt; Male   Admitted      512 353 120 138  53  22</span></span>
<span id="cb280-6"><a href="data-frame.html#cb280-6"></a><span class="co">#&gt;        Rejected      313 207 205 279 138 351</span></span>
<span id="cb280-7"><a href="data-frame.html#cb280-7"></a><span class="co">#&gt; Female Admitted       89  17 202 131  94  24</span></span>
<span id="cb280-8"><a href="data-frame.html#cb280-8"></a><span class="co">#&gt;        Rejected       19   8 391 244 299 317</span></span></code></pre></div>
<p>将录取性别和院系进行对比</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="data-frame.html#cb281-1"></a><span class="kw">prop.table</span>(<span class="kw">margin.table</span>(UCBA2DF.tab, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)), <span class="dv">1</span>)</span>
<span id="cb281-2"><a href="data-frame.html#cb281-2"></a><span class="co">#&gt;         Dept</span></span>
<span id="cb281-3"><a href="data-frame.html#cb281-3"></a><span class="co">#&gt; Gender            A          B          C          D          E          F</span></span>
<span id="cb281-4"><a href="data-frame.html#cb281-4"></a><span class="co">#&gt;   Male   0.30657748 0.20810108 0.12077295 0.15496098 0.07097733 0.13861018</span></span>
<span id="cb281-5"><a href="data-frame.html#cb281-5"></a><span class="co">#&gt;   Female 0.05885559 0.01362398 0.32316076 0.20435967 0.21416894 0.18583106</span></span></code></pre></div>
<p>男生倾向于申请院系 A 和 B，女生倾向于申请院系 C 到 F，院系 A 和 B 是最容易录取的。</p>
</div>
<div id="base-index" class="section level2">
<h2><span class="header-section-number">5.12</span> 索引访问</h2>
<p>which 与引用 <code>[</code> 性能比较，在区间 <span class="math inline">\([0,1]\)</span> 上生成 10 万个服从均匀分布的随机数，随机抽取其中<span class="math inline">\(\frac{1}{4}\)</span>。</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="data-frame.html#cb282-1"></a>n &lt;-<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb282-2"><a href="data-frame.html#cb282-2"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb282-3"><a href="data-frame.html#cb282-3"></a>i &lt;-<span class="st"> </span><span class="kw">logical</span>(n)</span>
<span id="cb282-4"><a href="data-frame.html#cb282-4"></a>i[<span class="kw">sample</span>(n, n <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)] &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb282-5"><a href="data-frame.html#cb282-5"></a>microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(x[i], x[<span class="kw">which</span>(i)], <span class="dt">times =</span> <span class="dv">1000</span>)</span></code></pre></div>
<p><span class="todo">使用 <code>subset</code> 函数与 <code>[</code> 比较</span></p>
</div>
<div id="base-array" class="section level2">
<h2><span class="header-section-number">5.13</span> 多维数组</h2>
<p>多维数组的行列是怎么定义的 <code>?array</code> 轴的概念，画个图表示数组</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="data-frame.html#cb283-1"></a><span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">27</span>, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb283-2"><a href="data-frame.html#cb283-2"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb283-3"><a href="data-frame.html#cb283-3"></a><span class="co">#&gt; </span></span>
<span id="cb283-4"><a href="data-frame.html#cb283-4"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb283-5"><a href="data-frame.html#cb283-5"></a><span class="co">#&gt; [1,]    1    4    7</span></span>
<span id="cb283-6"><a href="data-frame.html#cb283-6"></a><span class="co">#&gt; [2,]    2    5    8</span></span>
<span id="cb283-7"><a href="data-frame.html#cb283-7"></a><span class="co">#&gt; [3,]    3    6    9</span></span>
<span id="cb283-8"><a href="data-frame.html#cb283-8"></a><span class="co">#&gt; </span></span>
<span id="cb283-9"><a href="data-frame.html#cb283-9"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb283-10"><a href="data-frame.html#cb283-10"></a><span class="co">#&gt; </span></span>
<span id="cb283-11"><a href="data-frame.html#cb283-11"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb283-12"><a href="data-frame.html#cb283-12"></a><span class="co">#&gt; [1,]   10   13   16</span></span>
<span id="cb283-13"><a href="data-frame.html#cb283-13"></a><span class="co">#&gt; [2,]   11   14   17</span></span>
<span id="cb283-14"><a href="data-frame.html#cb283-14"></a><span class="co">#&gt; [3,]   12   15   18</span></span>
<span id="cb283-15"><a href="data-frame.html#cb283-15"></a><span class="co">#&gt; </span></span>
<span id="cb283-16"><a href="data-frame.html#cb283-16"></a><span class="co">#&gt; , , 3</span></span>
<span id="cb283-17"><a href="data-frame.html#cb283-17"></a><span class="co">#&gt; </span></span>
<span id="cb283-18"><a href="data-frame.html#cb283-18"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb283-19"><a href="data-frame.html#cb283-19"></a><span class="co">#&gt; [1,]   19   22   25</span></span>
<span id="cb283-20"><a href="data-frame.html#cb283-20"></a><span class="co">#&gt; [2,]   20   23   26</span></span>
<span id="cb283-21"><a href="data-frame.html#cb283-21"></a><span class="co">#&gt; [3,]   21   24   27</span></span></code></pre></div>
<p>垂直于Z轴的平面去截三维立方体，3 代表 z 轴，得到三个截面（二维矩阵）</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="data-frame.html#cb284-1"></a><span class="kw">asplit</span>(<span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">27</span>, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)), <span class="dv">3</span>)</span>
<span id="cb284-2"><a href="data-frame.html#cb284-2"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb284-3"><a href="data-frame.html#cb284-3"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb284-4"><a href="data-frame.html#cb284-4"></a><span class="co">#&gt; [1,]    1    4    7</span></span>
<span id="cb284-5"><a href="data-frame.html#cb284-5"></a><span class="co">#&gt; [2,]    2    5    8</span></span>
<span id="cb284-6"><a href="data-frame.html#cb284-6"></a><span class="co">#&gt; [3,]    3    6    9</span></span>
<span id="cb284-7"><a href="data-frame.html#cb284-7"></a><span class="co">#&gt; </span></span>
<span id="cb284-8"><a href="data-frame.html#cb284-8"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb284-9"><a href="data-frame.html#cb284-9"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb284-10"><a href="data-frame.html#cb284-10"></a><span class="co">#&gt; [1,]   10   13   16</span></span>
<span id="cb284-11"><a href="data-frame.html#cb284-11"></a><span class="co">#&gt; [2,]   11   14   17</span></span>
<span id="cb284-12"><a href="data-frame.html#cb284-12"></a><span class="co">#&gt; [3,]   12   15   18</span></span>
<span id="cb284-13"><a href="data-frame.html#cb284-13"></a><span class="co">#&gt; </span></span>
<span id="cb284-14"><a href="data-frame.html#cb284-14"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb284-15"><a href="data-frame.html#cb284-15"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb284-16"><a href="data-frame.html#cb284-16"></a><span class="co">#&gt; [1,]   19   22   25</span></span>
<span id="cb284-17"><a href="data-frame.html#cb284-17"></a><span class="co">#&gt; [2,]   20   23   26</span></span>
<span id="cb284-18"><a href="data-frame.html#cb284-18"></a><span class="co">#&gt; [3,]   21   24   27</span></span></code></pre></div>
<p>对每个二维矩阵按列求和</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="data-frame.html#cb285-1"></a><span class="kw">lapply</span>(<span class="kw">asplit</span>(<span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">27</span>, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)), <span class="dv">3</span>), apply, <span class="dv">2</span>, sum)</span>
<span id="cb285-2"><a href="data-frame.html#cb285-2"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb285-3"><a href="data-frame.html#cb285-3"></a><span class="co">#&gt; [1]  6 15 24</span></span>
<span id="cb285-4"><a href="data-frame.html#cb285-4"></a><span class="co">#&gt; </span></span>
<span id="cb285-5"><a href="data-frame.html#cb285-5"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb285-6"><a href="data-frame.html#cb285-6"></a><span class="co">#&gt; [1] 33 42 51</span></span>
<span id="cb285-7"><a href="data-frame.html#cb285-7"></a><span class="co">#&gt; </span></span>
<span id="cb285-8"><a href="data-frame.html#cb285-8"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb285-9"><a href="data-frame.html#cb285-9"></a><span class="co">#&gt; [1] 60 69 78</span></span></code></pre></div>
<p><code>asplit</code> 和 <code>lapply</code> 组合处理多维数组的计算问题，多维数组<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a></p>
<p><a href="https://d.cosx.org/d/107493">三维数组的矩阵运算</a> <a href="https://CRAN.R-project.org/package=abind">abind</a> 包提供更多的数组操作，如合并，替换</p>
<p>数组操作</p>
<p>aperm 数组转置 Array Transposition</p>
<p>asplit 数组拆分 其后接 lapply 或者 vapply</p>
<p>apply 数组计算</p>
<p>rray 包 <a href="https://github.com/r-lib/rray" class="uri">https://github.com/r-lib/rray</a></p>
</div>
<div id="base-others" class="section level2">
<h2><span class="header-section-number">5.14</span> 其它操作</h2>
<p>成对的数据操作有 <code>list</code> 与 <code>unlist</code>、<code>stack</code> 与 <code>unstack</code>、<code>class</code> 与 <code>unclass</code>、<code>attach</code> 与 <code>detach</code> 以及 <code>with</code> 和 <code>within</code>，它们在数据操作过程中有时会起到一定的补充作用。</p>
<div id="relist-or-unlist" class="section level3">
<h3><span class="header-section-number">5.14.1</span> 列表属性</h3>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="data-frame.html#cb286-1"></a><span class="co"># 创建列表</span></span>
<span id="cb286-2"><a href="data-frame.html#cb286-2"></a><span class="kw">list</span>(...)</span>
<span id="cb286-3"><a href="data-frame.html#cb286-3"></a><span class="kw">pairlist</span>(...)</span>
<span id="cb286-4"><a href="data-frame.html#cb286-4"></a><span class="co"># 转化列表</span></span>
<span id="cb286-5"><a href="data-frame.html#cb286-5"></a><span class="kw">as.list</span>(x, ...)</span>
<span id="cb286-6"><a href="data-frame.html#cb286-6"></a><span class="co">## S3 method for class &#39;environment&#39;</span></span>
<span id="cb286-7"><a href="data-frame.html#cb286-7"></a><span class="kw">as.list</span>(x, <span class="dt">all.names =</span> <span class="ot">FALSE</span>, <span class="dt">sorted =</span> <span class="ot">FALSE</span>, ...)</span>
<span id="cb286-8"><a href="data-frame.html#cb286-8"></a><span class="kw">as.pairlist</span>(x)</span>
<span id="cb286-9"><a href="data-frame.html#cb286-9"></a><span class="co"># 检查列表</span></span>
<span id="cb286-10"><a href="data-frame.html#cb286-10"></a><span class="kw">is.list</span>(x)</span>
<span id="cb286-11"><a href="data-frame.html#cb286-11"></a><span class="kw">is.pairlist</span>(x)</span>
<span id="cb286-12"><a href="data-frame.html#cb286-12"></a></span>
<span id="cb286-13"><a href="data-frame.html#cb286-13"></a><span class="kw">alist</span>(...)</span></code></pre></div>
<p><code>list</code> 函数用来构造、转化和检查 R 列表对象。下面创建一个临时列表对象 tmp ，它包含两个元素 A 和 B，两个元素都是向量，前者是数值型，后者是字符型</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="data-frame.html#cb287-1"></a>(tmp &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">A =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">B =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)))</span>
<span id="cb287-2"><a href="data-frame.html#cb287-2"></a><span class="co">#&gt; $A</span></span>
<span id="cb287-3"><a href="data-frame.html#cb287-3"></a><span class="co">#&gt; [1] 1 2 3</span></span>
<span id="cb287-4"><a href="data-frame.html#cb287-4"></a><span class="co">#&gt; </span></span>
<span id="cb287-5"><a href="data-frame.html#cb287-5"></a><span class="co">#&gt; $B</span></span>
<span id="cb287-6"><a href="data-frame.html#cb287-6"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="data-frame.html#cb288-1"></a><span class="kw">unlist</span>(x, <span class="dt">recursive =</span> <span class="ot">TRUE</span>, <span class="dt">use.names =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><code>unlist</code> 函数将给定的列表对象 <code>x</code> 简化为原子向量 (atomic vector)，我们发现简化之后变成一个字符型向量</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="data-frame.html#cb289-1"></a><span class="kw">unlist</span>(tmp)</span>
<span id="cb289-2"><a href="data-frame.html#cb289-2"></a><span class="co">#&gt;  A1  A2  A3  B1  B2 </span></span>
<span id="cb289-3"><a href="data-frame.html#cb289-3"></a><span class="co">#&gt; &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;a&quot; &quot;b&quot;</span></span>
<span id="cb289-4"><a href="data-frame.html#cb289-4"></a><span class="kw">unlist</span>(tmp, <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</span>
<span id="cb289-5"><a href="data-frame.html#cb289-5"></a><span class="co">#&gt; [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;a&quot; &quot;b&quot;</span></span></code></pre></div>
<p>unlist 的逆操作是 relist</p>
</div>
<div id="stack-or-unstack" class="section level3">
<h3><span class="header-section-number">5.14.2</span> 堆叠向量</h3>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="data-frame.html#cb290-1"></a><span class="kw">stack</span>(x, ...)</span>
<span id="cb290-2"><a href="data-frame.html#cb290-2"></a><span class="co">## Default S3 method:</span></span>
<span id="cb290-3"><a href="data-frame.html#cb290-3"></a><span class="kw">stack</span>(x, <span class="dt">drop =</span> <span class="ot">FALSE</span>, ...)</span>
<span id="cb290-4"><a href="data-frame.html#cb290-4"></a><span class="co">## S3 method for class &#39;data.frame&#39;</span></span>
<span id="cb290-5"><a href="data-frame.html#cb290-5"></a><span class="kw">stack</span>(x, select, <span class="dt">drop =</span> <span class="ot">FALSE</span>, ...)</span>
<span id="cb290-6"><a href="data-frame.html#cb290-6"></a></span>
<span id="cb290-7"><a href="data-frame.html#cb290-7"></a><span class="kw">unstack</span>(x, ...)</span>
<span id="cb290-8"><a href="data-frame.html#cb290-8"></a><span class="co">## Default S3 method:</span></span>
<span id="cb290-9"><a href="data-frame.html#cb290-9"></a><span class="kw">unstack</span>(x, form, ...)</span>
<span id="cb290-10"><a href="data-frame.html#cb290-10"></a><span class="co">## S3 method for class &#39;data.frame&#39;</span></span>
<span id="cb290-11"><a href="data-frame.html#cb290-11"></a><span class="kw">unstack</span>(x, form, ...)</span></code></pre></div>
<p><code>stack</code> 与 <code>unstack</code> 将多个向量堆在一起组成一个向量</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="data-frame.html#cb291-1"></a><span class="co"># 查看数据集 PlantGrowth</span></span>
<span id="cb291-2"><a href="data-frame.html#cb291-2"></a><span class="kw">class</span>(PlantGrowth)</span>
<span id="cb291-3"><a href="data-frame.html#cb291-3"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span>
<span id="cb291-4"><a href="data-frame.html#cb291-4"></a><span class="kw">head</span>(PlantGrowth)</span>
<span id="cb291-5"><a href="data-frame.html#cb291-5"></a><span class="co">#&gt;   weight group</span></span>
<span id="cb291-6"><a href="data-frame.html#cb291-6"></a><span class="co">#&gt; 1   4.17  ctrl</span></span>
<span id="cb291-7"><a href="data-frame.html#cb291-7"></a><span class="co">#&gt; 2   5.58  ctrl</span></span>
<span id="cb291-8"><a href="data-frame.html#cb291-8"></a><span class="co">#&gt; 3   5.18  ctrl</span></span>
<span id="cb291-9"><a href="data-frame.html#cb291-9"></a><span class="co">#&gt; 4   6.11  ctrl</span></span>
<span id="cb291-10"><a href="data-frame.html#cb291-10"></a><span class="co">#&gt; 5   4.50  ctrl</span></span>
<span id="cb291-11"><a href="data-frame.html#cb291-11"></a><span class="co">#&gt; 6   4.61  ctrl</span></span>
<span id="cb291-12"><a href="data-frame.html#cb291-12"></a><span class="co"># 检查默认的公式</span></span>
<span id="cb291-13"><a href="data-frame.html#cb291-13"></a><span class="kw">formula</span>(PlantGrowth) </span>
<span id="cb291-14"><a href="data-frame.html#cb291-14"></a><span class="co">#&gt; weight ~ group</span></span>
<span id="cb291-15"><a href="data-frame.html#cb291-15"></a><span class="co"># 根据公式解除堆叠</span></span>
<span id="cb291-16"><a href="data-frame.html#cb291-16"></a><span class="co"># 下面等价于 unstack(PlantGrowth, form = weight ~ group)</span></span>
<span id="cb291-17"><a href="data-frame.html#cb291-17"></a>(pg &lt;-<span class="st"> </span><span class="kw">unstack</span>(PlantGrowth)) </span>
<span id="cb291-18"><a href="data-frame.html#cb291-18"></a><span class="co">#&gt;    ctrl trt1 trt2</span></span>
<span id="cb291-19"><a href="data-frame.html#cb291-19"></a><span class="co">#&gt; 1  4.17 4.81 6.31</span></span>
<span id="cb291-20"><a href="data-frame.html#cb291-20"></a><span class="co">#&gt; 2  5.58 4.17 5.12</span></span>
<span id="cb291-21"><a href="data-frame.html#cb291-21"></a><span class="co">#&gt; 3  5.18 4.41 5.54</span></span>
<span id="cb291-22"><a href="data-frame.html#cb291-22"></a><span class="co">#&gt; 4  6.11 3.59 5.50</span></span>
<span id="cb291-23"><a href="data-frame.html#cb291-23"></a><span class="co">#&gt; 5  4.50 5.87 5.37</span></span>
<span id="cb291-24"><a href="data-frame.html#cb291-24"></a><span class="co">#&gt; 6  4.61 3.83 5.29</span></span>
<span id="cb291-25"><a href="data-frame.html#cb291-25"></a><span class="co">#&gt; 7  5.17 6.03 4.92</span></span>
<span id="cb291-26"><a href="data-frame.html#cb291-26"></a><span class="co">#&gt; 8  4.53 4.89 6.15</span></span>
<span id="cb291-27"><a href="data-frame.html#cb291-27"></a><span class="co">#&gt; 9  5.33 4.32 5.80</span></span>
<span id="cb291-28"><a href="data-frame.html#cb291-28"></a><span class="co">#&gt; 10 5.14 4.69 5.26</span></span></code></pre></div>
<p>现在再将变量 pg 堆叠起来，还可以指定要堆叠的列</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="data-frame.html#cb292-1"></a><span class="kw">stack</span>(pg)</span>
<span id="cb292-2"><a href="data-frame.html#cb292-2"></a><span class="co">#&gt;    values  ind</span></span>
<span id="cb292-3"><a href="data-frame.html#cb292-3"></a><span class="co">#&gt; 1    4.17 ctrl</span></span>
<span id="cb292-4"><a href="data-frame.html#cb292-4"></a><span class="co">#&gt; 2    5.58 ctrl</span></span>
<span id="cb292-5"><a href="data-frame.html#cb292-5"></a><span class="co">#&gt; 3    5.18 ctrl</span></span>
<span id="cb292-6"><a href="data-frame.html#cb292-6"></a><span class="co">#&gt; 4    6.11 ctrl</span></span>
<span id="cb292-7"><a href="data-frame.html#cb292-7"></a><span class="co">#&gt; 5    4.50 ctrl</span></span>
<span id="cb292-8"><a href="data-frame.html#cb292-8"></a>....</span>
<span id="cb292-9"><a href="data-frame.html#cb292-9"></a><span class="kw">stack</span>(pg, <span class="dt">select =</span> <span class="op">-</span>ctrl)</span>
<span id="cb292-10"><a href="data-frame.html#cb292-10"></a><span class="co">#&gt;    values  ind</span></span>
<span id="cb292-11"><a href="data-frame.html#cb292-11"></a><span class="co">#&gt; 1    4.81 trt1</span></span>
<span id="cb292-12"><a href="data-frame.html#cb292-12"></a><span class="co">#&gt; 2    4.17 trt1</span></span>
<span id="cb292-13"><a href="data-frame.html#cb292-13"></a><span class="co">#&gt; 3    4.41 trt1</span></span>
<span id="cb292-14"><a href="data-frame.html#cb292-14"></a><span class="co">#&gt; 4    3.59 trt1</span></span>
<span id="cb292-15"><a href="data-frame.html#cb292-15"></a><span class="co">#&gt; 5    5.87 trt1</span></span>
<span id="cb292-16"><a href="data-frame.html#cb292-16"></a>....</span></code></pre></div>
<div class="sidebar">
<p>形式上和 reshape 有一些相似之处，数据框可以由长变宽或由宽变长</p>
</div>
</div>
<div id="class-or-unclass" class="section level3">
<h3><span class="header-section-number">5.14.3</span> 属性转化</h3>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="data-frame.html#cb293-1"></a><span class="kw">class</span>(x)</span>
<span id="cb293-2"><a href="data-frame.html#cb293-2"></a><span class="kw">class</span>(x) &lt;-<span class="st"> </span>value</span>
<span id="cb293-3"><a href="data-frame.html#cb293-3"></a><span class="kw">unclass</span>(x)</span>
<span id="cb293-4"><a href="data-frame.html#cb293-4"></a><span class="kw">inherits</span>(x, what, <span class="dt">which =</span> <span class="ot">FALSE</span>)</span>
<span id="cb293-5"><a href="data-frame.html#cb293-5"></a></span>
<span id="cb293-6"><a href="data-frame.html#cb293-6"></a><span class="kw">oldClass</span>(x)</span>
<span id="cb293-7"><a href="data-frame.html#cb293-7"></a><span class="kw">oldClass</span>(x) &lt;-<span class="st"> </span>value</span></code></pre></div>
<p><code>class</code> 和 <code>unclass</code> 函数用来查看、设置类属性和取消类属性，常用于面向对象的编程设计中</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="data-frame.html#cb294-1"></a><span class="kw">class</span>(iris)</span>
<span id="cb294-2"><a href="data-frame.html#cb294-2"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span>
<span id="cb294-3"><a href="data-frame.html#cb294-3"></a><span class="kw">class</span>(iris<span class="op">$</span>Species)</span>
<span id="cb294-4"><a href="data-frame.html#cb294-4"></a><span class="co">#&gt; [1] &quot;factor&quot;</span></span>
<span id="cb294-5"><a href="data-frame.html#cb294-5"></a><span class="kw">unclass</span>(iris<span class="op">$</span>Species)</span>
<span id="cb294-6"><a href="data-frame.html#cb294-6"></a><span class="co">#&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb294-7"><a href="data-frame.html#cb294-7"></a><span class="co">#&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span id="cb294-8"><a href="data-frame.html#cb294-8"></a><span class="co">#&gt;  [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb294-9"><a href="data-frame.html#cb294-9"></a><span class="co">#&gt; [112] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb294-10"><a href="data-frame.html#cb294-10"></a><span class="co">#&gt; [149] 3 3</span></span>
<span id="cb294-11"><a href="data-frame.html#cb294-11"></a><span class="co">#&gt; attr(,&quot;levels&quot;)</span></span>
<span id="cb294-12"><a href="data-frame.html#cb294-12"></a>....</span></code></pre></div>
</div>
<div id="attach-or-detach" class="section level3">
<h3><span class="header-section-number">5.14.4</span> 绑定环境</h3>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="data-frame.html#cb295-1"></a><span class="kw">attach</span>(what,</span>
<span id="cb295-2"><a href="data-frame.html#cb295-2"></a>  <span class="dt">pos =</span> 2L, <span class="dt">name =</span> <span class="kw">deparse</span>(<span class="kw">substitute</span>(what), <span class="dt">backtick =</span> <span class="ot">FALSE</span>),</span>
<span id="cb295-3"><a href="data-frame.html#cb295-3"></a>  <span class="dt">warn.conflicts =</span> <span class="ot">TRUE</span></span>
<span id="cb295-4"><a href="data-frame.html#cb295-4"></a>)</span>
<span id="cb295-5"><a href="data-frame.html#cb295-5"></a><span class="kw">detach</span>(name,</span>
<span id="cb295-6"><a href="data-frame.html#cb295-6"></a>  <span class="dt">pos =</span> 2L, <span class="dt">unload =</span> <span class="ot">FALSE</span>, <span class="dt">character.only =</span> <span class="ot">FALSE</span>,</span>
<span id="cb295-7"><a href="data-frame.html#cb295-7"></a>  <span class="dt">force =</span> <span class="ot">FALSE</span></span>
<span id="cb295-8"><a href="data-frame.html#cb295-8"></a>)</span></code></pre></div>
<p><code>attach</code> 和 <code>detach</code> 是否绑定数据框的列名，不推荐操作，推荐使用 <code>with</code></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="data-frame.html#cb296-1"></a><span class="kw">attach</span>(iris)</span>
<span id="cb296-2"><a href="data-frame.html#cb296-2"></a><span class="kw">head</span>(Species)</span>
<span id="cb296-3"><a href="data-frame.html#cb296-3"></a><span class="co">#&gt; [1] setosa setosa setosa setosa setosa setosa</span></span>
<span id="cb296-4"><a href="data-frame.html#cb296-4"></a><span class="co">#&gt; Levels: setosa versicolor virginica</span></span>
<span id="cb296-5"><a href="data-frame.html#cb296-5"></a><span class="kw">detach</span>(iris)</span></code></pre></div>
</div>
<div id="with-or-within" class="section level3">
<h3><span class="header-section-number">5.14.5</span> 数据环境</h3>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="data-frame.html#cb297-1"></a><span class="kw">with</span>(data, expr, ...)</span>
<span id="cb297-2"><a href="data-frame.html#cb297-2"></a><span class="kw">within</span>(data, expr, ...)</span>
<span id="cb297-3"><a href="data-frame.html#cb297-3"></a><span class="co">## S3 method for class &#39;list&#39;</span></span>
<span id="cb297-4"><a href="data-frame.html#cb297-4"></a><span class="kw">within</span>(data, expr, <span class="dt">keepAttrs =</span> <span class="ot">TRUE</span>, ...)</span></code></pre></div>
<dl>
<dt><code>data</code></dt>
<dd>参数 <code>data</code> 用来构造表达式计算的环境。其默认值可以是一个环境，列表，数据框。在 <code>within</code> 函数中 <code>data</code> 参数只能是列表或数据框。
</dd>
<dt><code>expr</code></dt>
<dd><p>参数 <code>expr</code> 包含要计算的表达式。在 <code>within</code> 中通常包含一个复合表达式，比如</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="data-frame.html#cb298-1"></a>{</span>
<span id="cb298-2"><a href="data-frame.html#cb298-2"></a>  a &lt;-<span class="st"> </span><span class="kw">somefun</span>()</span>
<span id="cb298-3"><a href="data-frame.html#cb298-3"></a>  b &lt;-<span class="st"> </span><span class="kw">otherfun</span>()</span>
<span id="cb298-4"><a href="data-frame.html#cb298-4"></a>  ...</span>
<span id="cb298-5"><a href="data-frame.html#cb298-5"></a>  <span class="kw">rm</span>(unused1, temp)</span>
<span id="cb298-6"><a href="data-frame.html#cb298-6"></a>}</span></code></pre></div>
</dd>
</dl>
<p><code>with</code> 和 <code>within</code> 计算一组表达式，计算的环境是由数据构造的，后者可以修改原始的数据</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="data-frame.html#cb299-1"></a><span class="kw">with</span>(mtcars, mpg[cyl <span class="op">==</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>disp <span class="op">&gt;</span><span class="st"> </span><span class="dv">350</span>])</span>
<span id="cb299-2"><a href="data-frame.html#cb299-2"></a><span class="co">#&gt; [1] 18.7 14.3 10.4 10.4 14.7 19.2 15.8</span></span></code></pre></div>
<p>和下面计算的结果一样，但是更加简洁漂亮</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="data-frame.html#cb300-1"></a>mtcars<span class="op">$</span>mpg[mtcars<span class="op">$</span>cyl <span class="op">==</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>mtcars<span class="op">$</span>disp <span class="op">&gt;</span><span class="st"> </span><span class="dv">350</span>]</span>
<span id="cb300-2"><a href="data-frame.html#cb300-2"></a><span class="co">#&gt; [1] 18.7 14.3 10.4 10.4 14.7 19.2 15.8</span></span></code></pre></div>
<p><code>within</code> 函数可以修改原数据环境中的多个变量，比如删除、修改和添加等</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="data-frame.html#cb301-1"></a><span class="co"># 原数据集 airquality</span></span>
<span id="cb301-2"><a href="data-frame.html#cb301-2"></a><span class="kw">head</span>(airquality)</span>
<span id="cb301-3"><a href="data-frame.html#cb301-3"></a><span class="co">#&gt;   Ozone Solar.R Wind Temp Month Day</span></span>
<span id="cb301-4"><a href="data-frame.html#cb301-4"></a><span class="co">#&gt; 1    41     190  7.4   67     5   1</span></span>
<span id="cb301-5"><a href="data-frame.html#cb301-5"></a><span class="co">#&gt; 2    36     118  8.0   72     5   2</span></span>
<span id="cb301-6"><a href="data-frame.html#cb301-6"></a><span class="co">#&gt; 3    12     149 12.6   74     5   3</span></span>
<span id="cb301-7"><a href="data-frame.html#cb301-7"></a><span class="co">#&gt; 4    18     313 11.5   62     5   4</span></span>
<span id="cb301-8"><a href="data-frame.html#cb301-8"></a><span class="co">#&gt; 5    NA      NA 14.3   56     5   5</span></span>
<span id="cb301-9"><a href="data-frame.html#cb301-9"></a><span class="co">#&gt; 6    28      NA 14.9   66     5   6</span></span>
<span id="cb301-10"><a href="data-frame.html#cb301-10"></a>aq &lt;-<span class="st"> </span><span class="kw">within</span>(airquality, {</span>
<span id="cb301-11"><a href="data-frame.html#cb301-11"></a>  lOzone &lt;-<span class="st"> </span><span class="kw">log</span>(Ozone) <span class="co"># 取对数</span></span>
<span id="cb301-12"><a href="data-frame.html#cb301-12"></a>  Month &lt;-<span class="st"> </span><span class="kw">factor</span>(month.abb[Month]) <span class="co"># 字符串型转因子型</span></span>
<span id="cb301-13"><a href="data-frame.html#cb301-13"></a>  cTemp &lt;-<span class="st"> </span><span class="kw">round</span>((Temp <span class="op">-</span><span class="st"> </span><span class="dv">32</span>) <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">9</span>, <span class="dv">1</span>) <span class="co"># 从华氏温度到摄氏温度转化</span></span>
<span id="cb301-14"><a href="data-frame.html#cb301-14"></a>  S.cT &lt;-<span class="st"> </span>Solar.R <span class="op">/</span><span class="st"> </span>cTemp <span class="co"># 使用新创建的变量</span></span>
<span id="cb301-15"><a href="data-frame.html#cb301-15"></a>  <span class="kw">rm</span>(Day, Temp)</span>
<span id="cb301-16"><a href="data-frame.html#cb301-16"></a>})</span>
<span id="cb301-17"><a href="data-frame.html#cb301-17"></a><span class="co"># 修改后的数据集</span></span>
<span id="cb301-18"><a href="data-frame.html#cb301-18"></a><span class="kw">head</span>(aq)</span>
<span id="cb301-19"><a href="data-frame.html#cb301-19"></a><span class="co">#&gt;   Ozone Solar.R Wind Month      S.cT cTemp   lOzone</span></span>
<span id="cb301-20"><a href="data-frame.html#cb301-20"></a><span class="co">#&gt; 1    41     190  7.4   May  9.793814  19.4 3.713572</span></span>
<span id="cb301-21"><a href="data-frame.html#cb301-21"></a><span class="co">#&gt; 2    36     118  8.0   May  5.315315  22.2 3.583519</span></span>
<span id="cb301-22"><a href="data-frame.html#cb301-22"></a><span class="co">#&gt; 3    12     149 12.6   May  6.394850  23.3 2.484907</span></span>
<span id="cb301-23"><a href="data-frame.html#cb301-23"></a><span class="co">#&gt; 4    18     313 11.5   May 18.742515  16.7 2.890372</span></span>
<span id="cb301-24"><a href="data-frame.html#cb301-24"></a><span class="co">#&gt; 5    NA      NA 14.3   May        NA  13.3       NA</span></span>
<span id="cb301-25"><a href="data-frame.html#cb301-25"></a><span class="co">#&gt; 6    28      NA 14.9   May        NA  18.9 3.332205</span></span></code></pre></div>
<p>下面再举一个复杂的绘图例子，这个例子来自 <code>boxplot</code> 函数</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="data-frame.html#cb302-1"></a><span class="kw">with</span>(ToothGrowth, {</span>
<span id="cb302-2"><a href="data-frame.html#cb302-2"></a>  <span class="kw">boxplot</span>(len <span class="op">~</span><span class="st"> </span>dose,</span>
<span id="cb302-3"><a href="data-frame.html#cb302-3"></a>    <span class="dt">boxwex =</span> <span class="fl">0.25</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.2</span>,</span>
<span id="cb302-4"><a href="data-frame.html#cb302-4"></a>    <span class="dt">subset =</span> (supp <span class="op">==</span><span class="st"> &quot;VC&quot;</span>), <span class="dt">col =</span> <span class="st">&quot;#4285f4&quot;</span>,</span>
<span id="cb302-5"><a href="data-frame.html#cb302-5"></a>    <span class="dt">main =</span> <span class="st">&quot;Guinea Pigs&#39; Tooth Growth&quot;</span>,</span>
<span id="cb302-6"><a href="data-frame.html#cb302-6"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Vitamin C dose mg&quot;</span>,</span>
<span id="cb302-7"><a href="data-frame.html#cb302-7"></a>    <span class="dt">ylab =</span> <span class="st">&quot;tooth length&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">35</span>)</span>
<span id="cb302-8"><a href="data-frame.html#cb302-8"></a>  )</span>
<span id="cb302-9"><a href="data-frame.html#cb302-9"></a>  <span class="kw">boxplot</span>(len <span class="op">~</span><span class="st"> </span>dose,</span>
<span id="cb302-10"><a href="data-frame.html#cb302-10"></a>    <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">boxwex =</span> <span class="fl">0.25</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>,</span>
<span id="cb302-11"><a href="data-frame.html#cb302-11"></a>    <span class="dt">subset =</span> supp <span class="op">==</span><span class="st"> &quot;OJ&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span></span>
<span id="cb302-12"><a href="data-frame.html#cb302-12"></a>  )</span>
<span id="cb302-13"><a href="data-frame.html#cb302-13"></a>  <span class="kw">legend</span>(<span class="dv">2</span>, <span class="dv">9</span>, <span class="kw">c</span>(<span class="st">&quot;Ascorbic acid&quot;</span>, <span class="st">&quot;Orange juice&quot;</span>),</span>
<span id="cb302-14"><a href="data-frame.html#cb302-14"></a>    <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;#4285f4&quot;</span>, <span class="st">&quot;#EA4335&quot;</span>)</span>
<span id="cb302-15"><a href="data-frame.html#cb302-15"></a>  )</span>
<span id="cb302-16"><a href="data-frame.html#cb302-16"></a>})</span></code></pre></div>
<p><img src="data-frame_files/figure-html/subset-in-boxplot-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>将 <code>boxplot</code> 函数的 <code>subset</code> 参数单独提出来，调用数据子集选择函数 <code>subset</code> ，这里 <code>with</code> 中只包含一个表达式，所以也可以不用大括号</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="data-frame.html#cb303-1"></a><span class="kw">with</span>(</span>
<span id="cb303-2"><a href="data-frame.html#cb303-2"></a>  <span class="kw">subset</span>(ToothGrowth, supp <span class="op">==</span><span class="st"> &quot;VC&quot;</span>),</span>
<span id="cb303-3"><a href="data-frame.html#cb303-3"></a>  <span class="kw">boxplot</span>(len <span class="op">~</span><span class="st"> </span>dose,</span>
<span id="cb303-4"><a href="data-frame.html#cb303-4"></a>    <span class="dt">boxwex =</span> <span class="fl">0.25</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.2</span>,</span>
<span id="cb303-5"><a href="data-frame.html#cb303-5"></a>    <span class="dt">col =</span> <span class="st">&quot;#4285f4&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Guinea Pigs&#39; Tooth Growth&quot;</span>,</span>
<span id="cb303-6"><a href="data-frame.html#cb303-6"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Vitamin C dose mg&quot;</span>,</span>
<span id="cb303-7"><a href="data-frame.html#cb303-7"></a>    <span class="dt">ylab =</span> <span class="st">&quot;tooth length&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">35</span>)</span>
<span id="cb303-8"><a href="data-frame.html#cb303-8"></a>  )</span>
<span id="cb303-9"><a href="data-frame.html#cb303-9"></a>)</span>
<span id="cb303-10"><a href="data-frame.html#cb303-10"></a><span class="kw">with</span>(</span>
<span id="cb303-11"><a href="data-frame.html#cb303-11"></a>  <span class="kw">subset</span>(ToothGrowth, supp <span class="op">==</span><span class="st"> &quot;OJ&quot;</span>),</span>
<span id="cb303-12"><a href="data-frame.html#cb303-12"></a>  <span class="kw">boxplot</span>(len <span class="op">~</span><span class="st"> </span>dose,</span>
<span id="cb303-13"><a href="data-frame.html#cb303-13"></a>    <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">boxwex =</span> <span class="fl">0.25</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>,</span>
<span id="cb303-14"><a href="data-frame.html#cb303-14"></a>    <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span></span>
<span id="cb303-15"><a href="data-frame.html#cb303-15"></a>  )</span>
<span id="cb303-16"><a href="data-frame.html#cb303-16"></a>)</span>
<span id="cb303-17"><a href="data-frame.html#cb303-17"></a><span class="kw">legend</span>(<span class="dv">2</span>, <span class="dv">9</span>, <span class="kw">c</span>(<span class="st">&quot;Ascorbic acid&quot;</span>, <span class="st">&quot;Orange juice&quot;</span>),</span>
<span id="cb303-18"><a href="data-frame.html#cb303-18"></a>  <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;#4285f4&quot;</span>, <span class="st">&quot;#EA4335&quot;</span>)</span>
<span id="cb303-19"><a href="data-frame.html#cb303-19"></a>)</span></code></pre></div>
<p><img src="data-frame_files/figure-html/subset-out-boxplot-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>可以作为数据变换 <code>transform</code> 的一种替代，它也比较像 <strong>dplyr</strong> 包的 <code>mutate</code> 函数</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="data-frame.html#cb304-1"></a><span class="kw">within</span>(mtcars[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>],{</span>
<span id="cb304-2"><a href="data-frame.html#cb304-2"></a>  disp.cc &lt;-<span class="st"> </span>disp <span class="op">*</span><span class="st"> </span><span class="fl">2.54</span><span class="op">^</span><span class="dv">3</span></span>
<span id="cb304-3"><a href="data-frame.html#cb304-3"></a>  disp.l &lt;-<span class="st"> </span>disp.cc <span class="op">/</span><span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb304-4"><a href="data-frame.html#cb304-4"></a>})</span>
<span id="cb304-5"><a href="data-frame.html#cb304-5"></a><span class="co">#&gt;                    mpg cyl disp   disp.l  disp.cc</span></span>
<span id="cb304-6"><a href="data-frame.html#cb304-6"></a><span class="co">#&gt; Mazda RX4         21.0   6  160 2.621930 2621.930</span></span>
<span id="cb304-7"><a href="data-frame.html#cb304-7"></a><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 2.621930 2621.930</span></span>
<span id="cb304-8"><a href="data-frame.html#cb304-8"></a><span class="co">#&gt; Datsun 710        22.8   4  108 1.769803 1769.803</span></span>
<span id="cb304-9"><a href="data-frame.html#cb304-9"></a><span class="co">#&gt; Hornet 4 Drive    21.4   6  258 4.227863 4227.863</span></span>
<span id="cb304-10"><a href="data-frame.html#cb304-10"></a><span class="co">#&gt; Hornet Sportabout 18.7   8  360 5.899343 5899.343</span></span>
<span id="cb304-11"><a href="data-frame.html#cb304-11"></a></span>
<span id="cb304-12"><a href="data-frame.html#cb304-12"></a><span class="co"># 只能使用已有的列，刚生成的列不能用</span></span>
<span id="cb304-13"><a href="data-frame.html#cb304-13"></a><span class="co"># transform(</span></span>
<span id="cb304-14"><a href="data-frame.html#cb304-14"></a><span class="co">#   mtcars[1:5, 1:3],</span></span>
<span id="cb304-15"><a href="data-frame.html#cb304-15"></a><span class="co">#   disp.cc = disp * 2.54^3,</span></span>
<span id="cb304-16"><a href="data-frame.html#cb304-16"></a><span class="co">#   disp.l = disp.cc / 1e3</span></span>
<span id="cb304-17"><a href="data-frame.html#cb304-17"></a><span class="co"># )</span></span>
<span id="cb304-18"><a href="data-frame.html#cb304-18"></a><span class="kw">transform</span>(</span>
<span id="cb304-19"><a href="data-frame.html#cb304-19"></a>  mtcars[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>],</span>
<span id="cb304-20"><a href="data-frame.html#cb304-20"></a>  <span class="dt">disp.cc =</span> disp <span class="op">*</span><span class="st"> </span><span class="fl">2.54</span><span class="op">^</span><span class="dv">3</span></span>
<span id="cb304-21"><a href="data-frame.html#cb304-21"></a>)</span>
<span id="cb304-22"><a href="data-frame.html#cb304-22"></a><span class="co">#&gt;                    mpg cyl disp  disp.cc</span></span>
<span id="cb304-23"><a href="data-frame.html#cb304-23"></a><span class="co">#&gt; Mazda RX4         21.0   6  160 2621.930</span></span>
<span id="cb304-24"><a href="data-frame.html#cb304-24"></a><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 2621.930</span></span>
<span id="cb304-25"><a href="data-frame.html#cb304-25"></a><span class="co">#&gt; Datsun 710        22.8   4  108 1769.803</span></span>
<span id="cb304-26"><a href="data-frame.html#cb304-26"></a><span class="co">#&gt; Hornet 4 Drive    21.4   6  258 4227.863</span></span>
<span id="cb304-27"><a href="data-frame.html#cb304-27"></a><span class="co">#&gt; Hornet Sportabout 18.7   8  360 5899.343</span></span></code></pre></div>
<p><code>transform</code> 只能使用已有的列，变换中间生成的列不能用，所以相比于 <code>transform</code> 函数， <code>within</code> 显得更为灵活</p>
</div>
</div>
<div id="dm-base-session-info" class="section level2">
<h2><span class="header-section-number">5.15</span> 运行环境</h2>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="data-frame.html#cb305-1"></a>xfun<span class="op">::</span><span class="kw">session_info</span>()</span>
<span id="cb305-2"><a href="data-frame.html#cb305-2"></a><span class="co">#&gt; R Under development (unstable) (2020-01-03 r77628)</span></span>
<span id="cb305-3"><a href="data-frame.html#cb305-3"></a><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span id="cb305-4"><a href="data-frame.html#cb305-4"></a><span class="co">#&gt; Running under: Ubuntu 16.04.6 LTS</span></span>
<span id="cb305-5"><a href="data-frame.html#cb305-5"></a><span class="co">#&gt; </span></span>
<span id="cb305-6"><a href="data-frame.html#cb305-6"></a><span class="co">#&gt; Locale:</span></span>
<span id="cb305-7"><a href="data-frame.html#cb305-7"></a><span class="co">#&gt;   LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span id="cb305-8"><a href="data-frame.html#cb305-8"></a><span class="co">#&gt;   LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span id="cb305-9"><a href="data-frame.html#cb305-9"></a><span class="co">#&gt;   LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span id="cb305-10"><a href="data-frame.html#cb305-10"></a><span class="co">#&gt;   LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span id="cb305-11"><a href="data-frame.html#cb305-11"></a><span class="co">#&gt;   LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span id="cb305-12"><a href="data-frame.html#cb305-12"></a><span class="co">#&gt;   LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span id="cb305-13"><a href="data-frame.html#cb305-13"></a><span class="co">#&gt; </span></span>
<span id="cb305-14"><a href="data-frame.html#cb305-14"></a><span class="co">#&gt; Package version:</span></span>
<span id="cb305-15"><a href="data-frame.html#cb305-15"></a><span class="co">#&gt;   base64enc_0.1.3 bookdown_0.16   compiler_4.0.0  curl_4.3       </span></span>
<span id="cb305-16"><a href="data-frame.html#cb305-16"></a><span class="co">#&gt;   digest_0.6.23   evaluate_0.14   glue_1.3.1      graphics_4.0.0 </span></span>
<span id="cb305-17"><a href="data-frame.html#cb305-17"></a><span class="co">#&gt;   grDevices_4.0.0 highr_0.8       htmltools_0.4.0 jsonlite_1.6   </span></span>
<span id="cb305-18"><a href="data-frame.html#cb305-18"></a><span class="co">#&gt;   knitr_1.26      magrittr_1.5    markdown_1.1    methods_4.0.0  </span></span>
<span id="cb305-19"><a href="data-frame.html#cb305-19"></a><span class="co">#&gt;   mime_0.8        Rcpp_1.0.3      rlang_0.4.2     rmarkdown_2.0  </span></span>
<span id="cb305-20"><a href="data-frame.html#cb305-20"></a><span class="co">#&gt;   stats_4.0.0     stringi_1.4.3   stringr_1.4.0   tinytex_0.18   </span></span>
<span id="cb305-21"><a href="data-frame.html#cb305-21"></a><span class="co">#&gt;   tools_4.0.0     utils_4.0.0     xfun_0.11       yaml_2.2.0</span></span></code></pre></div>

</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references">
<div id="ref-Spector_2008_Manipulation">
<p>Spector, Phil. 2008. <em>Data Manipulation with R</em>. New York, NY: Springer. <a href="https://doi.org/10.1663/978-0-387-%204731-6">https://doi.org/10.1663/978-0-387- 4731-6</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="22">
<li id="fn22"><p>Thomas Lumley (2003) Standard nonstandard evaluation rules. <a href="https://developer.r-project.org/nonstandard-eval.pdf" class="uri">https://developer.r-project.org/nonstandard-eval.pdf</a><a href="data-frame.html#fnref22" class="footnote-back">↩︎</a></p></li>
<li id="fn23"><p><a href="https://www.brodieg.com/2018/11/23/is-your-matrix-running-slow-try-lists/" class="uri">https://www.brodieg.com/2018/11/23/is-your-matrix-running-slow-try-lists/</a><a href="data-frame.html#fnref23" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<script>
window.onload = function() {

  var imgs = document.querySelectorAll('img');

  // Upon clicking an image, open a new window with the
  // dimensions of the image, pointing the `data-url` link
  var on_click = function (e) {
    var d = e.target.dataset || {};
    if (d.url) {
      // Add some extra height for the modebar
      var height = 'height=' + (e.target.clientHeight * 1.05);
      var width = 'width=' + e.target.clientWidth;
      var param = 'location=yes,' + height + ',' + width + ',scrollbars=yes,status=yes';
      window.open(e.target.dataset.url, '_blank', param);
    }
  };

  var on_hover = function (e) {
    var d = e.target.dataset || {};
    if (d.url) {
      e.target.style.cursor = 'pointer';
    }
  };

  for (var i = 0; i < imgs.length; i++) {
    imgs[i].addEventListener('click', on_click);
    imgs[i].addEventListener('mouseover', on_hover);
  }
};
</script>
            </section>

          </div>
        </div>
      </div>
<a href="data-import.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-tibble.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XiangyunHuang/RGraphics/edit/master/data-frame.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub", "_main.mobi", "https://github.com/XiangyunHuang/RGraphics/raw/master/data-frame.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
