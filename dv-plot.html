<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 11 章 绘图素材库 | 数据科学与 R 语言</title>
  <meta name="description" content="数据操作、数据分析、数据建模、动态报告和数据可视化" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="第 11 章 绘图素材库 | 数据科学与 R 语言" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/xiangyun/RGraphics/" />
  
  <meta property="og:description" content="数据操作、数据分析、数据建模、动态报告和数据可视化" />
  <meta name="github-repo" content="XiangyunHuang/RGraphics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 11 章 绘图素材库 | 数据科学与 R 语言" />
  
  <meta name="twitter:description" content="数据操作、数据分析、数据建模、动态报告和数据可视化" />
  

<meta name="author" content="黄湘云" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dc-regular-expressions.html"/>
<link rel="next" href="dv-ggplot2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-7.0.1/css/motion.css" rel="stylesheet" />
<link href="libs/highcharts-7.0.1/css/htmlwdgtgrid.css" rel="stylesheet" />
<script src="libs/highcharts-7.0.1/highcharts.js"></script>
<script src="libs/highcharts-7.0.1/highcharts-3d.js"></script>
<script src="libs/highcharts-7.0.1/highcharts-more.js"></script>
<script src="libs/highcharts-7.0.1/modules/stock.js"></script>
<script src="libs/highcharts-7.0.1/modules/map.js"></script>
<script src="libs/highcharts-7.0.1/modules/annotations.js"></script>
<script src="libs/highcharts-7.0.1/modules/boost.js"></script>
<script src="libs/highcharts-7.0.1/modules/data.js"></script>
<script src="libs/highcharts-7.0.1/modules/drag-panes.js"></script>
<script src="libs/highcharts-7.0.1/modules/drilldown.js"></script>
<script src="libs/highcharts-7.0.1/modules/item-series.js"></script>
<script src="libs/highcharts-7.0.1/modules/offline-exporting.js"></script>
<script src="libs/highcharts-7.0.1/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-7.0.1/modules/exporting.js"></script>
<script src="libs/highcharts-7.0.1/modules/export-data.js"></script>
<script src="libs/highcharts-7.0.1/modules/funnel.js"></script>
<script src="libs/highcharts-7.0.1/modules/heatmap.js"></script>
<script src="libs/highcharts-7.0.1/modules/treemap.js"></script>
<script src="libs/highcharts-7.0.1/modules/sankey.js"></script>
<script src="libs/highcharts-7.0.1/modules/solid-gauge.js"></script>
<script src="libs/highcharts-7.0.1/modules/streamgraph.js"></script>
<script src="libs/highcharts-7.0.1/modules/sunburst.js"></script>
<script src="libs/highcharts-7.0.1/modules/vector.js"></script>
<script src="libs/highcharts-7.0.1/modules/wordcloud.js"></script>
<script src="libs/highcharts-7.0.1/modules/xrange.js"></script>
<script src="libs/highcharts-7.0.1/modules/tilemap.js"></script>
<script src="libs/highcharts-7.0.1/modules/venn.js"></script>
<script src="libs/highcharts-7.0.1/modules/gantt.js"></script>
<script src="libs/highcharts-7.0.1/modules/timeline.js"></script>
<script src="libs/highcharts-7.0.1/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-7.0.1/plugins/grouped-categories.js"></script>
<script src="libs/highcharts-7.0.1/plugins/motion.js"></script>
<script src="libs/highcharts-7.0.1/plugins/multicolor_series.js"></script>
<script src="libs/highcharts-7.0.1/custom/reset.js"></script>
<script src="libs/highcharts-7.0.1/custom/symbols-extra.js"></script>
<script src="libs/highcharts-7.0.1/custom/text-symbols.js"></script>
<script src="libs/highchart-binding-0.7.0/highchart.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/dagre-0.8.4/dagre.min.js"></script>
<script src="libs/lodash-4.17.15/lodash.js"></script>
<script src="libs/nomnoml-0.7.2/nomnoml.js"></script>
<script src="libs/nomnoml-binding-0.2.0/nomnoml.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">数据科学与 R 语言</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>欢迎</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i>Why R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-read-this-book"><i class="fa fa-check"></i>目标读者</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#Getting-Help-with-R"><i class="fa fa-check"></i>获取帮助</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#history-of-r"><i class="fa fa-check"></i>发展历史</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i>记号约定</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#session-info"><i class="fa fa-check"></i>运行环境</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>前言</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-talk-about"><i class="fa fa-check"></i>关于本书</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#structure-of-book"><i class="fa fa-check"></i>本书结构</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-author"><i class="fa fa-check"></i>关于作者</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>1</b> 安装与配置</a><ul>
<li class="chapter" data-level="1.1" data-path="setup.html"><a href="setup.html#repo-install"><i class="fa fa-check"></i><b>1.1</b> 仓库安装</a><ul>
<li class="chapter" data-level="1.1.1" data-path="setup.html"><a href="setup.html#ubuntu"><i class="fa fa-check"></i><b>1.1.1</b> Ubuntu</a></li>
<li class="chapter" data-level="1.1.2" data-path="setup.html"><a href="setup.html#centos"><i class="fa fa-check"></i><b>1.1.2</b> CentOS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="setup.html"><a href="setup.html#source-install"><i class="fa fa-check"></i><b>1.2</b> 源码安装</a><ul>
<li class="chapter" data-level="1.2.1" data-path="setup.html"><a href="setup.html#ubuntu-1"><i class="fa fa-check"></i><b>1.2.1</b> Ubuntu</a></li>
<li class="chapter" data-level="1.2.2" data-path="setup.html"><a href="setup.html#centos-1"><i class="fa fa-check"></i><b>1.2.2</b> CentOS</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="setup.html"><a href="setup.html#ninja-install"><i class="fa fa-check"></i><b>1.3</b> 忍者安装</a></li>
<li class="chapter" data-level="1.4" data-path="setup.html"><a href="setup.html#settings"><i class="fa fa-check"></i><b>1.4</b> 配置</a><ul>
<li class="chapter" data-level="1.4.1" data-path="setup.html"><a href="setup.html#init-session"><i class="fa fa-check"></i><b>1.4.1</b> 初始会话 <code>.Rprofile</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="setup.html"><a href="setup.html#environ-vars"><i class="fa fa-check"></i><b>1.4.2</b> 环境变量 <code>.Renviron</code></a></li>
<li class="chapter" data-level="1.4.3" data-path="setup.html"><a href="setup.html#make-vars"><i class="fa fa-check"></i><b>1.4.3</b> 编译选项 <code>Makevars</code></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="setup.html"><a href="setup.html#command-line-arguments"><i class="fa fa-check"></i><b>1.5</b> 命令行参数</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="files.html"><a href="files.html"><i class="fa fa-check"></i><b>2</b> 文件管理员</a><ul>
<li class="chapter" data-level="2.1" data-path="files.html"><a href="files.html#list"><i class="fa fa-check"></i><b>2.1</b> 查看文件</a></li>
<li class="chapter" data-level="2.2" data-path="files.html"><a href="files.html#manipulation"><i class="fa fa-check"></i><b>2.2</b> 操作文件</a></li>
<li class="chapter" data-level="2.3" data-path="files.html"><a href="files.html#compression"><i class="fa fa-check"></i><b>2.3</b> 压缩文件</a></li>
<li class="chapter" data-level="2.4" data-path="files.html"><a href="files.html#paths"><i class="fa fa-check"></i><b>2.4</b> 路径操作</a></li>
<li class="chapter" data-level="2.5" data-path="files.html"><a href="files.html#find"><i class="fa fa-check"></i><b>2.5</b> 查找文件</a></li>
<li class="chapter" data-level="2.6" data-path="files.html"><a href="files.html#permissions"><i class="fa fa-check"></i><b>2.6</b> 文件权限</a></li>
<li class="chapter" data-level="2.7" data-path="files.html"><a href="files.html#locale"><i class="fa fa-check"></i><b>2.7</b> 区域设置</a></li>
<li class="chapter" data-level="2.8" data-path="files.html"><a href="files.html#process"><i class="fa fa-check"></i><b>2.8</b> 进程管理</a></li>
<li class="chapter" data-level="2.9" data-path="files.html"><a href="files.html#system-commands"><i class="fa fa-check"></i><b>2.9</b> 系统命令</a></li>
<li class="chapter" data-level="2.10" data-path="files.html"><a href="files.html#time"><i class="fa fa-check"></i><b>2.10</b> 时间管理</a></li>
<li class="chapter" data-level="2.11" data-path="files.html"><a href="files.html#package"><i class="fa fa-check"></i><b>2.11</b> R 包管理</a></li>
<li class="chapter" data-level="2.12" data-path="files.html"><a href="files.html#lookup-function"><i class="fa fa-check"></i><b>2.12</b> 查找函数</a></li>
<li class="chapter" data-level="2.13" data-path="files.html"><a href="files.html#files-session-info"><i class="fa fa-check"></i><b>2.13</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-objects.html"><a href="data-objects.html"><i class="fa fa-check"></i><b>3</b> 对象在哪里</a><ul>
<li class="chapter" data-level="3.1" data-path="data-objects.html"><a href="data-objects.html#subsec:typeof"><i class="fa fa-check"></i><b>3.1</b> 类型</a></li>
<li class="chapter" data-level="3.2" data-path="data-objects.html"><a href="data-objects.html#subsec:date-time"><i class="fa fa-check"></i><b>3.2</b> 日期</a></li>
<li class="chapter" data-level="3.3" data-path="data-objects.html"><a href="data-objects.html#subsec:null"><i class="fa fa-check"></i><b>3.3</b> 空值</a></li>
<li class="chapter" data-level="3.4" data-path="data-objects.html"><a href="data-objects.html#subsec:character"><i class="fa fa-check"></i><b>3.4</b> 字符串</a></li>
<li class="chapter" data-level="3.5" data-path="data-objects.html"><a href="data-objects.html#subsec:expression"><i class="fa fa-check"></i><b>3.5</b> 表达式</a></li>
<li class="chapter" data-level="3.6" data-path="data-objects.html"><a href="data-objects.html#oop-matrix"><i class="fa fa-check"></i><b>3.6</b> 矩阵</a></li>
<li class="chapter" data-level="3.7" data-path="data-objects.html"><a href="data-objects.html#oop-array"><i class="fa fa-check"></i><b>3.7</b> 数组</a></li>
<li class="chapter" data-level="3.8" data-path="data-objects.html"><a href="data-objects.html#oop-data.frame"><i class="fa fa-check"></i><b>3.8</b> 数据框</a></li>
<li class="chapter" data-level="3.9" data-path="data-objects.html"><a href="data-objects.html#oop-table"><i class="fa fa-check"></i><b>3.9</b> 表格</a></li>
<li class="chapter" data-level="3.10" data-path="data-objects.html"><a href="data-objects.html#oop-list"><i class="fa fa-check"></i><b>3.10</b> 列表</a></li>
<li class="chapter" data-level="3.11" data-path="data-objects.html"><a href="data-objects.html#oop-ts"><i class="fa fa-check"></i><b>3.11</b> 时间序列</a></li>
<li class="chapter" data-level="3.12" data-path="data-objects.html"><a href="data-objects.html#oop-sf"><i class="fa fa-check"></i><b>3.12</b> 空间数据</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>4</b> 数据搬运工</a><ul>
<li class="chapter" data-level="4.1" data-path="data-import.html"><a href="data-import.html#import-data"><i class="fa fa-check"></i><b>4.1</b> 导入数据</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-import.html"><a href="data-import.html#scan-file"><i class="fa fa-check"></i><b>4.1.1</b> <code>scan</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="data-import.html"><a href="data-import.html#read-write-table"><i class="fa fa-check"></i><b>4.1.2</b> <code>read.table</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="data-import.html"><a href="data-import.html#read-write-lines"><i class="fa fa-check"></i><b>4.1.3</b> <code>readLines</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="data-import.html"><a href="data-import.html#read-save-rds"><i class="fa fa-check"></i><b>4.1.4</b> <code>readRDS</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-import.html"><a href="data-import.html#other-data-source"><i class="fa fa-check"></i><b>4.2</b> 其它数据格式</a></li>
<li class="chapter" data-level="4.3" data-path="data-import.html"><a href="data-import.html#import-large-dataset"><i class="fa fa-check"></i><b>4.3</b> 导入大数据集</a></li>
<li class="chapter" data-level="4.4" data-path="data-import.html"><a href="data-import.html#import-data-from-database"><i class="fa fa-check"></i><b>4.4</b> 从数据库导入</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-import.html"><a href="data-import.html#postgresql"><i class="fa fa-check"></i><b>4.4.1</b> PostgreSQL</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-import.html"><a href="data-import.html#mysql"><i class="fa fa-check"></i><b>4.4.2</b> MySQL</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-import.html"><a href="data-import.html#spark"><i class="fa fa-check"></i><b>4.4.3</b> Spark</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-import.html"><a href="data-import.html#batch-import-data"><i class="fa fa-check"></i><b>4.5</b> 批量导入数据</a></li>
<li class="chapter" data-level="4.6" data-path="data-import.html"><a href="data-import.html#batch-export-data"><i class="fa fa-check"></i><b>4.6</b> 批量导出数据</a></li>
<li class="chapter" data-level="4.7" data-path="data-import.html"><a href="data-import.html#export-data"><i class="fa fa-check"></i><b>4.7</b> 导出数据</a><ul>
<li class="chapter" data-level="4.7.1" data-path="data-import.html"><a href="data-import.html#export-output"><i class="fa fa-check"></i><b>4.7.1</b> 导出运行结果</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-import.html"><a href="data-import.html#export-data-object"><i class="fa fa-check"></i><b>4.7.2</b> 导出数据对象</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-import.html"><a href="data-import.html#dm-session-info"><i class="fa fa-check"></i><b>4.8</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-frame.html"><a href="data-frame.html"><i class="fa fa-check"></i><b>5</b> 数据操作手</a><ul>
<li class="chapter" data-level="5.1" data-path="data-frame.html"><a href="data-frame.html#show"><i class="fa fa-check"></i><b>5.1</b> 查看数据</a></li>
<li class="chapter" data-level="5.2" data-path="data-frame.html"><a href="data-frame.html#base-reshape"><i class="fa fa-check"></i><b>5.2</b> 数据变形</a></li>
<li class="chapter" data-level="5.3" data-path="data-frame.html"><a href="data-frame.html#base-transform"><i class="fa fa-check"></i><b>5.3</b> 数据转换</a></li>
<li class="chapter" data-level="5.4" data-path="data-frame.html"><a href="data-frame.html#base-subset"><i class="fa fa-check"></i><b>5.4</b> 提取子集</a></li>
<li class="chapter" data-level="5.5" data-path="data-frame.html"><a href="data-frame.html#base-order"><i class="fa fa-check"></i><b>5.5</b> 按列排序</a></li>
<li class="chapter" data-level="5.6" data-path="data-frame.html"><a href="data-frame.html#base-split"><i class="fa fa-check"></i><b>5.6</b> 数据拆分</a></li>
<li class="chapter" data-level="5.7" data-path="data-frame.html"><a href="data-frame.html#base-merge"><i class="fa fa-check"></i><b>5.7</b> 数据合并</a></li>
<li class="chapter" data-level="5.8" data-path="data-frame.html"><a href="data-frame.html#base-duplicated"><i class="fa fa-check"></i><b>5.8</b> 数据去重</a></li>
<li class="chapter" data-level="5.9" data-path="data-frame.html"><a href="data-frame.html#base-missing"><i class="fa fa-check"></i><b>5.9</b> 数据缺失</a></li>
<li class="chapter" data-level="5.10" data-path="data-frame.html"><a href="data-frame.html#base-aggregate"><i class="fa fa-check"></i><b>5.10</b> 数据聚合</a></li>
<li class="chapter" data-level="5.11" data-path="data-frame.html"><a href="data-frame.html#base-table"><i class="fa fa-check"></i><b>5.11</b> 表格统计</a></li>
<li class="chapter" data-level="5.12" data-path="data-frame.html"><a href="data-frame.html#base-index"><i class="fa fa-check"></i><b>5.12</b> 索引访问</a></li>
<li class="chapter" data-level="5.13" data-path="data-frame.html"><a href="data-frame.html#base-array"><i class="fa fa-check"></i><b>5.13</b> 多维数组</a></li>
<li class="chapter" data-level="5.14" data-path="data-frame.html"><a href="data-frame.html#base-others"><i class="fa fa-check"></i><b>5.14</b> 其它操作</a><ul>
<li class="chapter" data-level="5.14.1" data-path="data-frame.html"><a href="data-frame.html#relist-or-unlist"><i class="fa fa-check"></i><b>5.14.1</b> 列表属性</a></li>
<li class="chapter" data-level="5.14.2" data-path="data-frame.html"><a href="data-frame.html#stack-or-unstack"><i class="fa fa-check"></i><b>5.14.2</b> 堆叠向量</a></li>
<li class="chapter" data-level="5.14.3" data-path="data-frame.html"><a href="data-frame.html#class-or-unclass"><i class="fa fa-check"></i><b>5.14.3</b> 属性转化</a></li>
<li class="chapter" data-level="5.14.4" data-path="data-frame.html"><a href="data-frame.html#attach-or-detach"><i class="fa fa-check"></i><b>5.14.4</b> 绑定环境</a></li>
<li class="chapter" data-level="5.14.5" data-path="data-frame.html"><a href="data-frame.html#with-or-within"><i class="fa fa-check"></i><b>5.14.5</b> 数据环境</a></li>
</ul></li>
<li class="chapter" data-level="5.15" data-path="data-frame.html"><a href="data-frame.html#dm-base-session-info"><i class="fa fa-check"></i><b>5.15</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-tibble.html"><a href="data-tibble.html"><i class="fa fa-check"></i><b>6</b> 净土化操作</a><ul>
<li class="chapter" data-level="6.1" data-path="data-tibble.html"><a href="data-tibble.html#common-operations"><i class="fa fa-check"></i><b>6.1</b> 常用操作</a><ul>
<li class="chapter" data-level="6.1.1" data-path="data-tibble.html"><a href="data-tibble.html#tibble-show"><i class="fa fa-check"></i><b>6.1.1</b> 查看</a></li>
<li class="chapter" data-level="6.1.2" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-filter"><i class="fa fa-check"></i><b>6.1.2</b> 筛选</a></li>
<li class="chapter" data-level="6.1.3" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-arrange"><i class="fa fa-check"></i><b>6.1.3</b> 排序</a></li>
<li class="chapter" data-level="6.1.4" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-summarise"><i class="fa fa-check"></i><b>6.1.4</b> 聚合</a></li>
<li class="chapter" data-level="6.1.5" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-merge"><i class="fa fa-check"></i><b>6.1.5</b> 合并</a></li>
<li class="chapter" data-level="6.1.6" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-mutate"><i class="fa fa-check"></i><b>6.1.6</b> 变换</a></li>
<li class="chapter" data-level="6.1.7" data-path="data-tibble.html"><a href="data-tibble.html#dplyr-duplicated"><i class="fa fa-check"></i><b>6.1.7</b> 去重</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-tibble.html"><a href="data-tibble.html#common-dataframe-operations"><i class="fa fa-check"></i><b>6.2</b> 高频问题</a><ul>
<li class="chapter" data-level="6.2.1" data-path="data-tibble.html"><a href="data-tibble.html#create-empty-dataframe"><i class="fa fa-check"></i><b>6.2.1</b> 初始化数据框</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-tibble.html"><a href="data-tibble.html#remove-missing-values"><i class="fa fa-check"></i><b>6.2.2</b> 移除缺失记录</a></li>
<li class="chapter" data-level="6.2.3" data-path="data-tibble.html"><a href="data-tibble.html#coerce-data-type"><i class="fa fa-check"></i><b>6.2.3</b> 数据类型转化</a></li>
<li class="chapter" data-level="6.2.4" data-path="data-tibble.html"><a href="data-tibble.html#cross-group-by"><i class="fa fa-check"></i><b>6.2.4</b> 跨列分组求和</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-tibble.html"><a href="data-tibble.html#pipe-manipulation"><i class="fa fa-check"></i><b>6.3</b> 管道操作</a></li>
<li class="chapter" data-level="6.4" data-path="data-tibble.html"><a href="data-tibble.html#dm-dplyr-rsession"><i class="fa fa-check"></i><b>6.4</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-table.html"><a href="data-table.html"><i class="fa fa-check"></i><b>7</b> 高级数据操作</a><ul>
<li class="chapter" data-level="7.1" data-path="data-table.html"><a href="data-table.html#基础介绍"><i class="fa fa-check"></i><b>7.1</b> 基础介绍</a><ul>
<li class="chapter" data-level="7.1.1" data-path="data-table.html"><a href="data-table.html#subsec:select-j"><i class="fa fa-check"></i><b>7.1.1</b> 选择</a></li>
<li class="chapter" data-level="7.1.2" data-path="data-table.html"><a href="data-table.html#subsec:filter-i"><i class="fa fa-check"></i><b>7.1.2</b> 过滤</a></li>
<li class="chapter" data-level="7.1.3" data-path="data-table.html"><a href="data-table.html#subsec:mutate-j"><i class="fa fa-check"></i><b>7.1.3</b> 变换</a></li>
<li class="chapter" data-level="7.1.4" data-path="data-table.html"><a href="data-table.html#subsec:summarise-j"><i class="fa fa-check"></i><b>7.1.4</b> 聚合</a></li>
<li class="chapter" data-level="7.1.5" data-path="data-table.html"><a href="data-table.html#subsec:duplicated-i"><i class="fa fa-check"></i><b>7.1.5</b> 去重</a></li>
<li class="chapter" data-level="7.1.6" data-path="data-table.html"><a href="data-table.html#subsec:setname"><i class="fa fa-check"></i><b>7.1.6</b> 命名</a></li>
<li class="chapter" data-level="7.1.7" data-path="data-table.html"><a href="data-table.html#subsec:order-by-j"><i class="fa fa-check"></i><b>7.1.7</b> 排序</a></li>
<li class="chapter" data-level="7.1.8" data-path="data-table.html"><a href="data-table.html#subsec:reshape"><i class="fa fa-check"></i><b>7.1.8</b> 变形</a></li>
<li class="chapter" data-level="7.1.9" data-path="data-table.html"><a href="data-table.html#subsec:group-by"><i class="fa fa-check"></i><b>7.1.9</b> 分组</a></li>
<li class="chapter" data-level="7.1.10" data-path="data-table.html"><a href="data-table.html#subsec:merge"><i class="fa fa-check"></i><b>7.1.10</b> 合并</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data-table.html"><a href="data-table.html#chap:data-manipulation"><i class="fa fa-check"></i><b>7.2</b> 高频操作</a><ul>
<li class="chapter" data-level="7.2.1" data-path="data-table.html"><a href="data-table.html#sec:select"><i class="fa fa-check"></i><b>7.2.1</b> 选择多列</a></li>
<li class="chapter" data-level="7.2.2" data-path="data-table.html"><a href="data-table.html#sec:filter"><i class="fa fa-check"></i><b>7.2.2</b> 过滤多行</a></li>
<li class="chapter" data-level="7.2.3" data-path="data-table.html"><a href="data-table.html#sec:duplicated"><i class="fa fa-check"></i><b>7.2.3</b> 去重多行</a></li>
<li class="chapter" data-level="7.2.4" data-path="data-table.html"><a href="data-table.html#sec:merge"><i class="fa fa-check"></i><b>7.2.4</b> 合并操作</a></li>
<li class="chapter" data-level="7.2.5" data-path="data-table.html"><a href="data-table.html#sec:add-columns"><i class="fa fa-check"></i><b>7.2.5</b> 新添多列</a></li>
<li class="chapter" data-level="7.2.6" data-path="data-table.html"><a href="data-table.html#sec:delete-columns"><i class="fa fa-check"></i><b>7.2.6</b> 删除多列</a></li>
<li class="chapter" data-level="7.2.7" data-path="data-table.html"><a href="data-table.html#sec:modify-columns-type"><i class="fa fa-check"></i><b>7.2.7</b> 修改多列类型</a></li>
<li class="chapter" data-level="7.2.8" data-path="data-table.html"><a href="data-table.html#sec:select-first-row"><i class="fa fa-check"></i><b>7.2.8</b> 取每组第一行</a></li>
<li class="chapter" data-level="7.2.9" data-path="data-table.html"><a href="data-table.html#subsec:mom-vs-yoy"><i class="fa fa-check"></i><b>7.2.9</b> 计算环比同比</a></li>
<li class="chapter" data-level="7.2.10" data-path="data-table.html"><a href="data-table.html#sec:merge-multi-dfs"><i class="fa fa-check"></i><b>7.2.10</b> 合并多个数据框</a></li>
<li class="chapter" data-level="7.2.11" data-path="data-table.html"><a href="data-table.html#sec:multiple-aggregations"><i class="fa fa-check"></i><b>7.2.11</b> 分组聚合多个指标</a></li>
<li class="chapter" data-level="7.2.12" data-path="data-table.html"><a href="data-table.html#sec:rename-multi-cols"><i class="fa fa-check"></i><b>7.2.12</b> 重命名多个列</a></li>
<li class="chapter" data-level="7.2.13" data-path="data-table.html"><a href="data-table.html#sec:sort-multi-cols"><i class="fa fa-check"></i><b>7.2.13</b> 对多个列依次排序</a></li>
<li class="chapter" data-level="7.2.14" data-path="data-table.html"><a href="data-table.html#sec:rearrange-position-multi-cols"><i class="fa fa-check"></i><b>7.2.14</b> 重排多个列的位置</a></li>
<li class="chapter" data-level="7.2.15" data-path="data-table.html"><a href="data-table.html#sec:tidy-output"><i class="fa fa-check"></i><b>7.2.15</b> 整理回归结果</a></li>
<li class="chapter" data-level="7.2.16" data-path="data-table.html"><a href="data-table.html#sec:assignment-by-reference"><i class="fa fa-check"></i><b>7.2.16</b> <code>:=</code> 和 <code>.()</code></a></li>
<li class="chapter" data-level="7.2.17" data-path="data-table.html"><a href="data-table.html#sec:remove-na"><i class="fa fa-check"></i><b>7.2.17</b> 去掉含有缺失值的记录</a></li>
<li class="chapter" data-level="7.2.18" data-path="data-table.html"><a href="data-table.html#sec:match-set"><i class="fa fa-check"></i><b>7.2.18</b> 集合操作</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="data-table.html"><a href="data-table.html#sec:data-manipulation-session-info"><i class="fa fa-check"></i><b>7.3</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-parallel.html"><a href="data-parallel.html"><i class="fa fa-check"></i><b>8</b> 并行化操作</a><ul>
<li class="chapter" data-level="8.1" data-path="data-parallel.html"><a href="data-parallel.html#apply"><i class="fa fa-check"></i><b>8.1</b> apply</a></li>
<li class="chapter" data-level="8.2" data-path="data-parallel.html"><a href="data-parallel.html#map-reduce"><i class="fa fa-check"></i><b>8.2</b> MapReduce</a></li>
<li class="chapter" data-level="8.3" data-path="data-parallel.html"><a href="data-parallel.html#parallel"><i class="fa fa-check"></i><b>8.3</b> parallel</a></li>
<li class="chapter" data-level="8.4" data-path="data-parallel.html"><a href="data-parallel.html#rmpi"><i class="fa fa-check"></i><b>8.4</b> Rmpi</a></li>
<li class="chapter" data-level="8.5" data-path="data-parallel.html"><a href="data-parallel.html#gpur"><i class="fa fa-check"></i><b>8.5</b> gpuR</a></li>
<li class="chapter" data-level="8.6" data-path="data-parallel.html"><a href="data-parallel.html#dm-parallel-session-info"><i class="fa fa-check"></i><b>8.6</b> 本章运行环境</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html"><i class="fa fa-check"></i><b>9</b> 字符串操作</a><ul>
<li class="chapter" data-level="9.1" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-count"><i class="fa fa-check"></i><b>9.1</b> 字符数统计</a></li>
<li class="chapter" data-level="9.2" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-translations"><i class="fa fa-check"></i><b>9.2</b> 字符串翻译</a></li>
<li class="chapter" data-level="9.3" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-concatenate"><i class="fa fa-check"></i><b>9.3</b> 字符串连接</a></li>
<li class="chapter" data-level="9.4" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-strsplit"><i class="fa fa-check"></i><b>9.4</b> 字符串拆分</a></li>
<li class="chapter" data-level="9.5" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-match"><i class="fa fa-check"></i><b>9.5</b> 字符串匹配</a></li>
<li class="chapter" data-level="9.6" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-search"><i class="fa fa-check"></i><b>9.6</b> 字符串查询</a></li>
<li class="chapter" data-level="9.7" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-replacement"><i class="fa fa-check"></i><b>9.7</b> 字符串替换</a></li>
<li class="chapter" data-level="9.8" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#base-extract"><i class="fa fa-check"></i><b>9.8</b> 字符串提取</a></li>
<li class="chapter" data-level="9.9" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:named-capture"><i class="fa fa-check"></i><b>9.9</b> 命名捕捉</a></li>
<li class="chapter" data-level="9.10" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:exact-match"><i class="fa fa-check"></i><b>9.10</b> 精确匹配</a></li>
<li class="chapter" data-level="9.11" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:fuzzy-match"><i class="fa fa-check"></i><b>9.11</b> 模糊匹配</a></li>
<li class="chapter" data-level="9.12" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:replace"><i class="fa fa-check"></i><b>9.12</b> 高级的替换</a></li>
<li class="chapter" data-level="9.13" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#subsubsec:extract"><i class="fa fa-check"></i><b>9.13</b> 高级的提取</a></li>
<li class="chapter" data-level="9.14" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#other-string-op"><i class="fa fa-check"></i><b>9.14</b> 其它操作</a><ul>
<li class="chapter" data-level="9.14.1" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#strwrap"><i class="fa fa-check"></i><b>9.14.1</b> strwrap</a></li>
<li class="chapter" data-level="9.14.2" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#strtrim"><i class="fa fa-check"></i><b>9.14.2</b> strtrim</a></li>
<li class="chapter" data-level="9.14.3" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#strrep"><i class="fa fa-check"></i><b>9.14.3</b> strrep</a></li>
<li class="chapter" data-level="9.14.4" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#trimws"><i class="fa fa-check"></i><b>9.14.4</b> trimws</a></li>
</ul></li>
<li class="chapter" data-level="9.15" data-path="dc-string-manipulation.html"><a href="dc-string-manipulation.html#string-session-info"><i class="fa fa-check"></i><b>9.15</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html"><i class="fa fa-check"></i><b>10</b> 正则表达式</a><ul>
<li class="chapter" data-level="10.1" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#character-constants"><i class="fa fa-check"></i><b>10.1</b> 字符常量</a></li>
<li class="chapter" data-level="10.2" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#environments"><i class="fa fa-check"></i><b>10.2</b> 软件环境</a></li>
<li class="chapter" data-level="10.3" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#foundations"><i class="fa fa-check"></i><b>10.3</b> 基本概念</a></li>
<li class="chapter" data-level="10.4" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#match"><i class="fa fa-check"></i><b>10.4</b> 字符串匹配</a></li>
<li class="chapter" data-level="10.5" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#concatenation"><i class="fa fa-check"></i><b>10.5</b> 级联表达式</a></li>
<li class="chapter" data-level="10.6" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#backreference"><i class="fa fa-check"></i><b>10.6</b> 反向引用</a></li>
<li class="chapter" data-level="10.7" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#named-capture"><i class="fa fa-check"></i><b>10.7</b> 命名捕捉</a></li>
<li class="chapter" data-level="10.8" data-path="dc-regular-expressions.html"><a href="dc-regular-expressions.html#comment"><i class="fa fa-check"></i><b>10.8</b> 表达式注释</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dv-plot.html"><a href="dv-plot.html"><i class="fa fa-check"></i><b>11</b> 绘图素材库</a><ul>
<li class="chapter" data-level="11.1" data-path="dv-plot.html"><a href="dv-plot.html#elements"><i class="fa fa-check"></i><b>11.1</b> 基本要素</a><ul>
<li class="chapter" data-level="11.1.1" data-path="dv-plot.html"><a href="dv-plot.html#base-points"><i class="fa fa-check"></i><b>11.1.1</b> 点线</a></li>
<li class="chapter" data-level="11.1.2" data-path="dv-plot.html"><a href="dv-plot.html#base-rect"><i class="fa fa-check"></i><b>11.1.2</b> 区域</a></li>
<li class="chapter" data-level="11.1.3" data-path="dv-plot.html"><a href="dv-plot.html#base-lines"><i class="fa fa-check"></i><b>11.1.3</b> 参考线</a></li>
<li class="chapter" data-level="11.1.4" data-path="dv-plot.html"><a href="dv-plot.html#base-axis"><i class="fa fa-check"></i><b>11.1.4</b> 坐标轴</a></li>
<li class="chapter" data-level="11.1.5" data-path="dv-plot.html"><a href="dv-plot.html#base-tick"><i class="fa fa-check"></i><b>11.1.5</b> 刻度线</a></li>
<li class="chapter" data-level="11.1.6" data-path="dv-plot.html"><a href="dv-plot.html#base-title"><i class="fa fa-check"></i><b>11.1.6</b> 标题</a></li>
<li class="chapter" data-level="11.1.7" data-path="dv-plot.html"><a href="dv-plot.html#base-annotation"><i class="fa fa-check"></i><b>11.1.7</b> 注释</a></li>
<li class="chapter" data-level="11.1.8" data-path="dv-plot.html"><a href="dv-plot.html#base-legend"><i class="fa fa-check"></i><b>11.1.8</b> 图例</a></li>
<li class="chapter" data-level="11.1.9" data-path="dv-plot.html"><a href="dv-plot.html#base-par"><i class="fa fa-check"></i><b>11.1.9</b> 边空</a></li>
<li class="chapter" data-level="11.1.10" data-path="dv-plot.html"><a href="dv-plot.html#base-layer"><i class="fa fa-check"></i><b>11.1.10</b> 图层</a></li>
<li class="chapter" data-level="11.1.11" data-path="dv-plot.html"><a href="dv-plot.html#base-layout"><i class="fa fa-check"></i><b>11.1.11</b> 布局</a></li>
<li class="chapter" data-level="11.1.12" data-path="dv-plot.html"><a href="dv-plot.html#base-combine"><i class="fa fa-check"></i><b>11.1.12</b> 组合</a></li>
<li class="chapter" data-level="11.1.13" data-path="dv-plot.html"><a href="dv-plot.html#base-screen"><i class="fa fa-check"></i><b>11.1.13</b> 分屏</a></li>
<li class="chapter" data-level="11.1.14" data-path="dv-plot.html"><a href="dv-plot.html#identify-locator"><i class="fa fa-check"></i><b>11.1.14</b> 交互</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="dv-plot.html"><a href="dv-plot.html#plot-gallary"><i class="fa fa-check"></i><b>11.2</b> 统计图形</a><ul>
<li class="chapter" data-level="11.2.1" data-path="dv-plot.html"><a href="dv-plot.html#plot-bar"><i class="fa fa-check"></i><b>11.2.1</b> 条形图</a></li>
<li class="chapter" data-level="11.2.2" data-path="dv-plot.html"><a href="dv-plot.html#plot-hist"><i class="fa fa-check"></i><b>11.2.2</b> 直方图</a></li>
<li class="chapter" data-level="11.2.3" data-path="dv-plot.html"><a href="dv-plot.html#plot-density"><i class="fa fa-check"></i><b>11.2.3</b> 密度图</a></li>
<li class="chapter" data-level="11.2.4" data-path="dv-plot.html"><a href="dv-plot.html#plot-ecdf"><i class="fa fa-check"></i><b>11.2.4</b> 经验图</a></li>
<li class="chapter" data-level="11.2.5" data-path="dv-plot.html"><a href="dv-plot.html#plot-qqnorm"><i class="fa fa-check"></i><b>11.2.5</b> QQ 图</a></li>
<li class="chapter" data-level="11.2.6" data-path="dv-plot.html"><a href="dv-plot.html#plot-ts"><i class="fa fa-check"></i><b>11.2.6</b> 时序图</a></li>
<li class="chapter" data-level="11.2.7" data-path="dv-plot.html"><a href="dv-plot.html#plot-pie"><i class="fa fa-check"></i><b>11.2.7</b> 饼图</a></li>
<li class="chapter" data-level="11.2.8" data-path="dv-plot.html"><a href="dv-plot.html#plot-stem-leaf"><i class="fa fa-check"></i><b>11.2.8</b> 茎叶图</a></li>
<li class="chapter" data-level="11.2.9" data-path="dv-plot.html"><a href="dv-plot.html#plot-scatter"><i class="fa fa-check"></i><b>11.2.9</b> 散点图</a></li>
<li class="chapter" data-level="11.2.10" data-path="dv-plot.html"><a href="dv-plot.html#base-jitter"><i class="fa fa-check"></i><b>11.2.10</b> 抖动图</a></li>
<li class="chapter" data-level="11.2.11" data-path="dv-plot.html"><a href="dv-plot.html#plot-box"><i class="fa fa-check"></i><b>11.2.11</b> 箱线图</a></li>
<li class="chapter" data-level="11.2.12" data-path="dv-plot.html"><a href="dv-plot.html#error-bars"><i class="fa fa-check"></i><b>11.2.12</b> 残差图</a></li>
<li class="chapter" data-level="11.2.13" data-path="dv-plot.html"><a href="dv-plot.html#plot-violin"><i class="fa fa-check"></i><b>11.2.13</b> 提琴图</a></li>
<li class="chapter" data-level="11.2.14" data-path="dv-plot.html"><a href="dv-plot.html#plot-contour"><i class="fa fa-check"></i><b>11.2.14</b> 轮廓图</a></li>
<li class="chapter" data-level="11.2.15" data-path="dv-plot.html"><a href="dv-plot.html#plot-line"><i class="fa fa-check"></i><b>11.2.15</b> 折线图</a></li>
<li class="chapter" data-level="11.2.16" data-path="dv-plot.html"><a href="dv-plot.html#function"><i class="fa fa-check"></i><b>11.2.16</b> 函数图</a></li>
<li class="chapter" data-level="11.2.17" data-path="dv-plot.html"><a href="dv-plot.html#plot-mosaic"><i class="fa fa-check"></i><b>11.2.17</b> 马赛克图</a></li>
<li class="chapter" data-level="11.2.18" data-path="dv-plot.html"><a href="dv-plot.html#plot-dotchart"><i class="fa fa-check"></i><b>11.2.18</b> 克利夫兰点图</a></li>
<li class="chapter" data-level="11.2.19" data-path="dv-plot.html"><a href="dv-plot.html#plot-matrix"><i class="fa fa-check"></i><b>11.2.19</b> 矩阵图</a></li>
<li class="chapter" data-level="11.2.20" data-path="dv-plot.html"><a href="dv-plot.html#plot-radar"><i class="fa fa-check"></i><b>11.2.20</b> 雷达图</a></li>
<li class="chapter" data-level="11.2.21" data-path="dv-plot.html"><a href="dv-plot.html#plot-rose"><i class="fa fa-check"></i><b>11.2.21</b> 玫瑰图</a></li>
<li class="chapter" data-level="11.2.22" data-path="dv-plot.html"><a href="dv-plot.html#plot-map"><i class="fa fa-check"></i><b>11.2.22</b> 地形图</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="dv-plot.html"><a href="dv-plot.html#plot-session-info"><i class="fa fa-check"></i><b>11.3</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html"><i class="fa fa-check"></i><b>12</b> 数据可视化</a><ul>
<li class="chapter" data-level="12.1" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#intro-ggplot2"><i class="fa fa-check"></i><b>12.1</b> 基础语法</a><ul>
<li class="chapter" data-level="12.1.1" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-layer"><i class="fa fa-check"></i><b>12.1.1</b> 图层</a></li>
<li class="chapter" data-level="12.1.2" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-theme"><i class="fa fa-check"></i><b>12.1.2</b> 主题</a></li>
<li class="chapter" data-level="12.1.3" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-color"><i class="fa fa-check"></i><b>12.1.3</b> 配色</a></li>
<li class="chapter" data-level="12.1.4" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-scale"><i class="fa fa-check"></i><b>12.1.4</b> 刻度</a></li>
<li class="chapter" data-level="12.1.5" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-annotate"><i class="fa fa-check"></i><b>12.1.5</b> 注释</a></li>
<li class="chapter" data-level="12.1.6" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-legend"><i class="fa fa-check"></i><b>12.1.6</b> 图例</a></li>
<li class="chapter" data-level="12.1.7" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-grid"><i class="fa fa-check"></i><b>12.1.7</b> 组合</a></li>
<li class="chapter" data-level="12.1.8" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-coord"><i class="fa fa-check"></i><b>12.1.8</b> 坐标系</a></li>
<li class="chapter" data-level="12.1.9" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-axes"><i class="fa fa-check"></i><b>12.1.9</b> 坐标轴</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-gallary"><i class="fa fa-check"></i><b>12.2</b> 统计图形</a><ul>
<li class="chapter" data-level="12.2.1" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-scatter"><i class="fa fa-check"></i><b>12.2.1</b> 散点图</a></li>
<li class="chapter" data-level="12.2.2" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-boxplot"><i class="fa fa-check"></i><b>12.2.2</b> 箱线图</a></li>
<li class="chapter" data-level="12.2.3" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-barplot"><i class="fa fa-check"></i><b>12.2.3</b> 条形图</a></li>
<li class="chapter" data-level="12.2.4" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-line"><i class="fa fa-check"></i><b>12.2.4</b> 折线图</a></li>
<li class="chapter" data-level="12.2.5" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-histogram"><i class="fa fa-check"></i><b>12.2.5</b> 直方图</a></li>
<li class="chapter" data-level="12.2.6" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-violin"><i class="fa fa-check"></i><b>12.2.6</b> 提琴图</a></li>
<li class="chapter" data-level="12.2.7" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-jitter"><i class="fa fa-check"></i><b>12.2.7</b> 抖动图</a></li>
<li class="chapter" data-level="12.2.8" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-ridge"><i class="fa fa-check"></i><b>12.2.8</b> 密度图</a></li>
<li class="chapter" data-level="12.2.9" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-rose"><i class="fa fa-check"></i><b>12.2.9</b> 玫瑰图</a></li>
<li class="chapter" data-level="12.2.10" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-wordcloud"><i class="fa fa-check"></i><b>12.2.10</b> 词云图</a></li>
<li class="chapter" data-level="12.2.11" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#calendar-map"><i class="fa fa-check"></i><b>12.2.11</b> 日历图</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="dv-ggplot2.html"><a href="dv-ggplot2.html#ggplot2-session-info"><i class="fa fa-check"></i><b>12.3</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dv-plot3d.html"><a href="dv-plot3d.html"><i class="fa fa-check"></i><b>13</b> 三维可视化</a><ul>
<li class="chapter" data-level="13.1" data-path="dv-plot3d.html"><a href="dv-plot3d.html#pie-3d"><i class="fa fa-check"></i><b>13.1</b> 饼图</a></li>
<li class="chapter" data-level="13.2" data-path="dv-plot3d.html"><a href="dv-plot3d.html#bar-3d"><i class="fa fa-check"></i><b>13.2</b> 柱形图</a></li>
<li class="chapter" data-level="13.3" data-path="dv-plot3d.html"><a href="dv-plot3d.html#scatter-3d"><i class="fa fa-check"></i><b>13.3</b> 散点图</a></li>
<li class="chapter" data-level="13.4" data-path="dv-plot3d.html"><a href="dv-plot3d.html#curve-3d"><i class="fa fa-check"></i><b>13.4</b> 函数图</a></li>
<li class="chapter" data-level="13.5" data-path="dv-plot3d.html"><a href="dv-plot3d.html#persp-3d"><i class="fa fa-check"></i><b>13.5</b> 透视图</a></li>
<li class="chapter" data-level="13.6" data-path="dv-plot3d.html"><a href="dv-plot3d.html#tikz"><i class="fa fa-check"></i><b>13.6</b> TikZ 绘图</a></li>
<li class="chapter" data-level="13.7" data-path="dv-plot3d.html"><a href="dv-plot3d.html#export-save"><i class="fa fa-check"></i><b>13.7</b> 图形导出</a></li>
<li class="chapter" data-level="13.8" data-path="dv-plot3d.html"><a href="dv-plot3d.html#plot3d-sessionInfo"><i class="fa fa-check"></i><b>13.8</b> 软件信息</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="dv-colors-fonts.html"><a href="dv-colors-fonts.html"><i class="fa fa-check"></i><b>14</b> 色彩与字体</a><ul>
<li class="chapter" data-level="14.1" data-path="dv-colors-fonts.html"><a href="dv-colors-fonts.html#colors-in-r"><i class="fa fa-check"></i><b>14.1</b> 颜色</a></li>
<li class="chapter" data-level="14.2" data-path="dv-colors-fonts.html"><a href="dv-colors-fonts.html#choose-colors"><i class="fa fa-check"></i><b>14.2</b> 配色</a><ul>
<li class="chapter" data-level="14.2.1" data-path="dv-colors-fonts.html"><a href="dv-colors-fonts.html#colourlovers"><i class="fa fa-check"></i><b>14.2.1</b> colourlovers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="dv-highcharter.html"><a href="dv-highcharter.html"><i class="fa fa-check"></i><b>15</b> highcharter 图形</a><ul>
<li class="chapter" data-level="15.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-line"><i class="fa fa-check"></i><b>15.1</b> 折线图</a><ul>
<li class="chapter" data-level="15.1.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:simple-hc-line"><i class="fa fa-check"></i><b>15.1.1</b> 简单折线图</a></li>
<li class="chapter" data-level="15.1.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:group-hc-line"><i class="fa fa-check"></i><b>15.1.2</b> 分组折线图</a></li>
<li class="chapter" data-level="15.1.3" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:ts-hc-line"><i class="fa fa-check"></i><b>15.1.3</b> 时间序列图</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-scatter"><i class="fa fa-check"></i><b>15.2</b> 散点图</a><ul>
<li class="chapter" data-level="15.2.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:simple-hc-scatter"><i class="fa fa-check"></i><b>15.2.1</b> 简单散点图</a></li>
<li class="chapter" data-level="15.2.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:group-hc-scatter"><i class="fa fa-check"></i><b>15.2.2</b> 分组散点图</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-bar"><i class="fa fa-check"></i><b>15.3</b> 条形图</a><ul>
<li class="chapter" data-level="15.3.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:simple-hc-bar"><i class="fa fa-check"></i><b>15.3.1</b> 简单条形图</a></li>
<li class="chapter" data-level="15.3.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:dodge-hc-bar"><i class="fa fa-check"></i><b>15.3.2</b> 复合条形图</a></li>
<li class="chapter" data-level="15.3.3" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:stack-hc-bar"><i class="fa fa-check"></i><b>15.3.3</b> 堆积条形图</a></li>
<li class="chapter" data-level="15.3.4" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:fill-hc-bar"><i class="fa fa-check"></i><b>15.3.4</b> 百分比条形图</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-boxplot"><i class="fa fa-check"></i><b>15.4</b> 箱线图</a><ul>
<li class="chapter" data-level="15.4.1" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsubsec:simple-hc-boxplot"><i class="fa fa-check"></i><b>15.4.1</b> 简单箱线图</a></li>
<li class="chapter" data-level="15.4.2" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subssubsec:dodge-hc-boxplot"><i class="fa fa-check"></i><b>15.4.2</b> 复合箱线图</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-density"><i class="fa fa-check"></i><b>15.5</b> 密度图</a></li>
<li class="chapter" data-level="15.6" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-hist"><i class="fa fa-check"></i><b>15.6</b> 直方图</a></li>
<li class="chapter" data-level="15.7" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-survival"><i class="fa fa-check"></i><b>15.7</b> 生存图</a></li>
<li class="chapter" data-level="15.8" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-heatmap"><i class="fa fa-check"></i><b>15.8</b> 等高图</a></li>
<li class="chapter" data-level="15.9" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-corrplot"><i class="fa fa-check"></i><b>15.9</b> 相关图</a></li>
<li class="chapter" data-level="15.10" data-path="dv-highcharter.html"><a href="dv-highcharter.html#subsec:hc-treemap"><i class="fa fa-check"></i><b>15.10</b> 矩阵图</a></li>
<li class="chapter" data-level="15.11" data-path="dv-highcharter.html"><a href="dv-highcharter.html#highcharter-map"><i class="fa fa-check"></i><b>15.11</b> 地图</a></li>
<li class="chapter" data-level="15.12" data-path="dv-highcharter.html"><a href="dv-highcharter.html#drilldown"><i class="fa fa-check"></i><b>15.12</b> 下钻图</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dv-lattice.html"><a href="dv-lattice.html"><i class="fa fa-check"></i><b>16</b> Lattice 图形</a><ul>
<li class="chapter" data-level="16.1" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:boxplot"><i class="fa fa-check"></i><b>16.1</b> 箱线图</a></li>
<li class="chapter" data-level="16.2" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:line"><i class="fa fa-check"></i><b>16.2</b> 折线图</a></li>
<li class="chapter" data-level="16.3" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:smooth"><i class="fa fa-check"></i><b>16.3</b> 平滑图</a></li>
<li class="chapter" data-level="16.4" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:dotplot"><i class="fa fa-check"></i><b>16.4</b> 点图</a></li>
<li class="chapter" data-level="16.5" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:step"><i class="fa fa-check"></i><b>16.5</b> 阶梯图</a></li>
<li class="chapter" data-level="16.6" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:facet"><i class="fa fa-check"></i><b>16.6</b> 分面图</a></li>
<li class="chapter" data-level="16.7" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:contour"><i class="fa fa-check"></i><b>16.7</b> 等高线图</a></li>
<li class="chapter" data-level="16.8" data-path="dv-lattice.html"><a href="dv-lattice.html#sub:map"><i class="fa fa-check"></i><b>16.8</b> 地图</a></li>
<li class="chapter" data-level="16.9" data-path="dv-lattice.html"><a href="dv-lattice.html#sub:cluster"><i class="fa fa-check"></i><b>16.9</b> 聚类图</a></li>
<li class="chapter" data-level="16.10" data-path="dv-lattice.html"><a href="dv-lattice.html#sec:lattice-sessioninfo"><i class="fa fa-check"></i><b>16.10</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="dv-network.html"><a href="dv-network.html"><i class="fa fa-check"></i><b>17</b> 网络数据</a></li>
<li class="chapter" data-level="18" data-path="dv-plotly.html"><a href="dv-plotly.html"><i class="fa fa-check"></i><b>18</b> plotly 图形</a><ul>
<li class="chapter" data-level="18.1" data-path="dv-plotly.html"><a href="dv-plotly.html#plotly-scatter"><i class="fa fa-check"></i><b>18.1</b> 散点图</a><ul>
<li class="chapter" data-level="18.1.1" data-path="dv-plotly.html"><a href="dv-plotly.html#一行代码绘图"><i class="fa fa-check"></i><b>18.1.1</b> 一行代码绘图</a></li>
<li class="chapter" data-level="18.1.2" data-path="dv-plotly.html"><a href="dv-plotly.html#分组散点图"><i class="fa fa-check"></i><b>18.1.2</b> 分组散点图</a></li>
<li class="chapter" data-level="18.1.3" data-path="dv-plotly.html"><a href="dv-plotly.html#散点图汇总"><i class="fa fa-check"></i><b>18.1.3</b> 散点图汇总</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="dv-plotly.html"><a href="dv-plotly.html#折线图"><i class="fa fa-check"></i><b>18.2</b> 折线图</a></li>
<li class="chapter" data-level="18.3" data-path="dv-plotly.html"><a href="dv-plotly.html#plotly-bar"><i class="fa fa-check"></i><b>18.3</b> 条形图</a></li>
<li class="chapter" data-level="18.4" data-path="dv-plotly.html"><a href="dv-plotly.html#直方图"><i class="fa fa-check"></i><b>18.4</b> 直方图</a></li>
<li class="chapter" data-level="18.5" data-path="dv-plotly.html"><a href="dv-plotly.html#plotly-box"><i class="fa fa-check"></i><b>18.5</b> 箱线图</a></li>
<li class="chapter" data-level="18.6" data-path="dv-plotly.html"><a href="dv-plotly.html#提琴图"><i class="fa fa-check"></i><b>18.6</b> 提琴图</a></li>
<li class="chapter" data-level="18.7" data-path="dv-plotly.html"><a href="dv-plotly.html#饼图"><i class="fa fa-check"></i><b>18.7</b> 饼图</a></li>
<li class="chapter" data-level="18.8" data-path="dv-plotly.html"><a href="dv-plotly.html#地图"><i class="fa fa-check"></i><b>18.8</b> 地图</a></li>
<li class="chapter" data-level="18.9" data-path="dv-plotly.html"><a href="dv-plotly.html#区域图"><i class="fa fa-check"></i><b>18.9</b> 区域图</a></li>
<li class="chapter" data-level="18.10" data-path="dv-plotly.html"><a href="dv-plotly.html#choropleth-地图"><i class="fa fa-check"></i><b>18.10</b> choropleth 地图</a></li>
<li class="chapter" data-level="18.11" data-path="dv-plotly.html"><a href="dv-plotly.html#多图布局"><i class="fa fa-check"></i><b>18.11</b> 多图布局</a></li>
<li class="chapter" data-level="18.12" data-path="dv-plotly.html"><a href="dv-plotly.html#二维密度图"><i class="fa fa-check"></i><b>18.12</b> 二维密度图</a></li>
<li class="chapter" data-level="18.13" data-path="dv-plotly.html"><a href="dv-plotly.html#热力图"><i class="fa fa-check"></i><b>18.13</b> 热力图</a></li>
<li class="chapter" data-level="18.14" data-path="dv-plotly.html"><a href="dv-plotly.html#三维地形图"><i class="fa fa-check"></i><b>18.14</b> 三维地形图</a></li>
<li class="chapter" data-level="18.15" data-path="dv-plotly.html"><a href="dv-plotly.html#三维散点图"><i class="fa fa-check"></i><b>18.15</b> 三维散点图</a></li>
<li class="chapter" data-level="18.16" data-path="dv-plotly.html"><a href="dv-plotly.html#ggplotly"><i class="fa fa-check"></i><b>18.16</b> ggplotly</a></li>
<li class="chapter" data-level="18.17" data-path="dv-plotly.html"><a href="dv-plotly.html#导出图形"><i class="fa fa-check"></i><b>18.17</b> 导出图形</a></li>
<li class="chapter" data-level="18.18" data-path="dv-plotly.html"><a href="dv-plotly.html#plotly-语法"><i class="fa fa-check"></i><b>18.18</b> plotly 语法</a><ul>
<li class="chapter" data-level="18.18.1" data-path="dv-plotly.html"><a href="dv-plotly.html#图形种类"><i class="fa fa-check"></i><b>18.18.1</b> 图形种类</a></li>
<li class="chapter" data-level="18.18.2" data-path="dv-plotly.html"><a href="dv-plotly.html#图形参数"><i class="fa fa-check"></i><b>18.18.2</b> 图形参数</a></li>
</ul></li>
<li class="chapter" data-level="18.19" data-path="dv-plotly.html"><a href="dv-plotly.html#运行环境"><i class="fa fa-check"></i><b>18.19</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html"><i class="fa fa-check"></i><b>19</b> 时空可视化</a><ul>
<li class="chapter" data-level="19.1" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#map"><i class="fa fa-check"></i><b>19.1</b> 地图</a><ul>
<li class="chapter" data-level="19.1.1" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#project-orientation"><i class="fa fa-check"></i><b>19.1.1</b> 投影和观察方位</a></li>
<li class="chapter" data-level="19.1.2" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#USA-crime-rates"><i class="fa fa-check"></i><b>19.1.2</b> 美国各州犯罪率</a></li>
<li class="chapter" data-level="19.1.3" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#fiji-earthquake-map"><i class="fa fa-check"></i><b>19.1.3</b> 斐济地震带</a></li>
<li class="chapter" data-level="19.1.4" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#USA-unemployment-ratio"><i class="fa fa-check"></i><b>19.1.4</b> 美国各城镇失业率</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#spatial-op"><i class="fa fa-check"></i><b>19.2</b> 空间数据对象</a><ul>
<li class="chapter" data-level="19.2.1" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#ggplot2-sp"><i class="fa fa-check"></i><b>19.2.1</b> sp</a></li>
<li class="chapter" data-level="19.2.2" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#ggplot2-raster"><i class="fa fa-check"></i><b>19.2.2</b> raster</a></li>
<li class="chapter" data-level="19.2.3" data-path="dv-spatio-temporal.html"><a href="dv-spatio-temporal.html#ggplot2-sf"><i class="fa fa-check"></i><b>19.2.3</b> sf</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="dynamic-documents.html"><a href="dynamic-documents.html"><i class="fa fa-check"></i><b>20</b> 动态性文档</a><ul>
<li class="chapter" data-level="20.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown"><i class="fa fa-check"></i><b>20.1</b> Markdown</a><ul>
<li class="chapter" data-level="20.1.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown-list"><i class="fa fa-check"></i><b>20.1.1</b> 列表</a></li>
<li class="chapter" data-level="20.1.2" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown-quote"><i class="fa fa-check"></i><b>20.1.2</b> 引用</a></li>
<li class="chapter" data-level="20.1.3" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown-table"><i class="fa fa-check"></i><b>20.1.3</b> 表格</a></li>
<li class="chapter" data-level="20.1.4" data-path="dynamic-documents.html"><a href="dynamic-documents.html#image"><i class="fa fa-check"></i><b>20.1.4</b> 图片</a></li>
<li class="chapter" data-level="20.1.5" data-path="dynamic-documents.html"><a href="dynamic-documents.html#markdown-math"><i class="fa fa-check"></i><b>20.1.5</b> 公式</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="dynamic-documents.html"><a href="dynamic-documents.html#pandoc-markdown"><i class="fa fa-check"></i><b>20.2</b> Pandoc’s Markdown</a></li>
<li class="chapter" data-level="20.3" data-path="dynamic-documents.html"><a href="dynamic-documents.html#r-markdown"><i class="fa fa-check"></i><b>20.3</b> R Markdown</a><ul>
<li class="chapter" data-level="20.3.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#语法高亮"><i class="fa fa-check"></i><b>20.3.1</b> 语法高亮</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="dynamic-documents.html"><a href="dynamic-documents.html#table-style"><i class="fa fa-check"></i><b>20.4</b> 表格样式</a><ul>
<li class="chapter" data-level="20.4.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#table-html"><i class="fa fa-check"></i><b>20.4.1</b> HTML 样式</a></li>
<li class="chapter" data-level="20.4.2" data-path="dynamic-documents.html"><a href="dynamic-documents.html#table-latex"><i class="fa fa-check"></i><b>20.4.2</b> LaTeX 样式</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="dynamic-documents.html"><a href="dynamic-documents.html#rmarkdown-addins"><i class="fa fa-check"></i><b>20.5</b> 插件</a></li>
<li class="chapter" data-level="20.6" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:rmarkdown"><i class="fa fa-check"></i><b>20.6</b> 报告</a></li>
<li class="chapter" data-level="20.7" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:pagedown"><i class="fa fa-check"></i><b>20.7</b> 简历</a></li>
<li class="chapter" data-level="20.8" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:bookdown"><i class="fa fa-check"></i><b>20.8</b> 书籍</a></li>
<li class="chapter" data-level="20.9" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:blogdown"><i class="fa fa-check"></i><b>20.9</b> 网站</a></li>
<li class="chapter" data-level="20.10" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:dashboard"><i class="fa fa-check"></i><b>20.10</b> Shiny</a></li>
<li class="chapter" data-level="20.11" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:xaringan"><i class="fa fa-check"></i><b>20.11</b> 幻灯片</a></li>
<li class="chapter" data-level="20.12" data-path="dynamic-documents.html"><a href="dynamic-documents.html#sec:animation-video"><i class="fa fa-check"></i><b>20.12</b> 动画视频</a></li>
<li class="chapter" data-level="20.13" data-path="dynamic-documents.html"><a href="dynamic-documents.html#sec:diagram-table"><i class="fa fa-check"></i><b>20.13</b> 图表</a><ul>
<li class="chapter" data-level="20.13.1" data-path="dynamic-documents.html"><a href="dynamic-documents.html#tikz-1"><i class="fa fa-check"></i><b>20.13.1</b> TikZ</a></li>
<li class="chapter" data-level="20.13.2" data-path="dynamic-documents.html"><a href="dynamic-documents.html#dot"><i class="fa fa-check"></i><b>20.13.2</b> DOT</a></li>
<li class="chapter" data-level="20.13.3" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:uml"><i class="fa fa-check"></i><b>20.13.3</b> UML</a></li>
<li class="chapter" data-level="20.13.4" data-path="dynamic-documents.html"><a href="dynamic-documents.html#subsec:table"><i class="fa fa-check"></i><b>20.13.4</b> 表格</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="interactive-graphics.html"><a href="interactive-graphics.html"><i class="fa fa-check"></i><b>21</b> 交互式图形</a><ul>
<li class="chapter" data-level="21.1" data-path="interactive-graphics.html"><a href="interactive-graphics.html#rgl"><i class="fa fa-check"></i><b>21.1</b> rgl</a></li>
<li class="chapter" data-level="21.2" data-path="interactive-graphics.html"><a href="interactive-graphics.html#leaflet"><i class="fa fa-check"></i><b>21.2</b> leaflet</a></li>
<li class="chapter" data-level="21.3" data-path="interactive-graphics.html"><a href="interactive-graphics.html#vegawidget"><i class="fa fa-check"></i><b>21.3</b> vegawidget</a></li>
<li class="chapter" data-level="21.4" data-path="interactive-graphics.html"><a href="interactive-graphics.html#network"><i class="fa fa-check"></i><b>21.4</b> 网络图</a></li>
<li class="chapter" data-level="21.5" data-path="interactive-graphics.html"><a href="interactive-graphics.html#threejs"><i class="fa fa-check"></i><b>21.5</b> threejs</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="cs-cran-network.html"><a href="cs-cran-network.html"><i class="fa fa-check"></i><b>22</b> 案例：分析 CRAN</a><ul>
<li class="chapter" data-level="22.1" data-path="cs-cran-network.html"><a href="cs-cran-network.html#R-Core-Team"><i class="fa fa-check"></i><b>22.1</b> R 核心团队</a></li>
<li class="chapter" data-level="22.2" data-path="cs-cran-network.html"><a href="cs-cran-network.html#Top-Creators"><i class="fa fa-check"></i><b>22.2</b> 高产的开发者</a></li>
<li class="chapter" data-level="22.3" data-path="cs-cran-network.html"><a href="cs-cran-network.html#R-Package-Developers"><i class="fa fa-check"></i><b>22.3</b> 社区开发者</a></li>
<li class="chapter" data-level="22.4" data-path="cs-cran-network.html"><a href="cs-cran-network.html#first-commit"><i class="fa fa-check"></i><b>22.4</b> 首次贡献 R 包</a></li>
<li class="chapter" data-level="22.5" data-path="cs-cran-network.html"><a href="cs-cran-network.html#Contribution-Network"><i class="fa fa-check"></i><b>22.5</b> 贡献关系网络</a></li>
<li class="chapter" data-level="22.6" data-path="cs-cran-network.html"><a href="cs-cran-network.html#CRAN-Update-Packages"><i class="fa fa-check"></i><b>22.6</b> 更新知多少</a></li>
<li class="chapter" data-level="22.7" data-path="cs-cran-network.html"><a href="cs-cran-network.html#Package-Licenses"><i class="fa fa-check"></i><b>22.7</b> 使用许可证</a></li>
<li class="chapter" data-level="22.8" data-path="cs-cran-network.html"><a href="cs-cran-network.html#r-包增长速度"><i class="fa fa-check"></i><b>22.8</b> R 包增长速度</a></li>
<li class="chapter" data-level="22.9" data-path="cs-cran-network.html"><a href="cs-cran-network.html#Choose-Package"><i class="fa fa-check"></i><b>22.9</b> 选择 R 包</a></li>
<li class="chapter" data-level="22.10" data-path="cs-cran-network.html"><a href="cs-cran-network.html#cs-network-session-info"><i class="fa fa-check"></i><b>22.10</b> 运行环境</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="99-references.html"><a href="99-references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://r-graphics.netlify.com/" target="blank">Published with netlify</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">数据科学与 R 语言</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plot-gallery" class="section level1">
<h1><span class="header-section-number">第 11 章</span> 绘图素材库</h1>
<div class="sidebar">
<p>作为知识介绍，本章所有数据都来源于基础 R 包，即安装 R 软件后自带的数据集，图库在以 base R 中的数据集介绍完后，以相应真实数据扩展为案列，结合统计意义和探索性数据分析介绍各种常见统计图形</p>
</div>
<p>数据可视化是一种重要的数据分析手段， R 提供了两套图形系统，分别是 graphics 包提供的基础绘图系统和 grid 包提供的栅格绘图系统，后者主要以两个 R 包为大家所熟知，一个是 lattice 包，另一个是 ggplot2 包。</p>
<p>Base 图形系统的扩展包 <a href="https://github.com/KKPMW/basetheme">basetheme</a> 可以设置主题，<a href="https://github.com/jumpingrivers/prettyB">prettyB</a> 和 <a href="https://github.com/pmur002/gridgraphics">gridGraphics</a></p>
<p>为了方便记忆函数 <code>par</code> 的各个参数，Paul Murrell 整理了一份 <a href="https://www.stat.auckland.ac.nz/~paul/R/parMemnonics.html">助记符</a>，此外，LaTeX 宏包 <a href="https://github.com/latexstudio/LaTeXPackages-CN">geometry</a> 对版面设置有很多专业的说明</p>
<div id="elements" class="section level2">
<h2><span class="header-section-number">11.1</span> 基本要素</h2>
<div id="base-points" class="section level3">
<h3><span class="header-section-number">11.1.1</span> 点线</h3>
<p>点和线是最常见的画图元素，在 <code>plot</code> 函数中，分别用参数 <code>pch</code> 和 <code>lty</code> 来设定类型，点的大小、线的宽度分别用参数 <code>cex</code> 和 <code>lwd</code> 来指定，颜色由参数 <code>col</code> 设置。参数 <code>type</code> 不同的值设置如下，<code>p</code> 显示点，<code>l</code> 绘制线，<code>b</code> 同时绘制空心点，并用线连接，<code>c</code> 只有线，<code>o</code> 在线上绘制点，<code>s</code> 和 <code>S</code> 点线连接绘制阶梯图，<code>h</code> 绘制类似直方图一样的垂线，最后 <code>n</code> 表示什么也不画。</p>
<p>点 points 、线 grid 背景线 abline lines rug 刻度线（线段segments、箭头arrows）、</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="dv-plot.html#cb479-1"></a><span class="co">## -------- Showing all the extra &amp; some char graphics symbols ---------</span></span>
<span id="cb479-2"><a href="dv-plot.html#cb479-2"></a>pchShow &lt;-</span>
<span id="cb479-3"><a href="dv-plot.html#cb479-3"></a><span class="st">  </span><span class="cf">function</span>(<span class="dt">extras =</span> <span class="kw">c</span>(<span class="st">&quot;*&quot;</span>, <span class="st">&quot;.&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;+&quot;</span>, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;|&quot;</span>, <span class="st">&quot;%&quot;</span>, <span class="st">&quot;#&quot;</span>),</span>
<span id="cb479-4"><a href="dv-plot.html#cb479-4"></a>             <span class="dt">cex =</span> <span class="dv">2</span>, <span class="co">## good for both .Device==&quot;postscript&quot; and &quot;x11&quot;</span></span>
<span id="cb479-5"><a href="dv-plot.html#cb479-5"></a>             <span class="dt">col =</span> <span class="st">&quot;red3&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;gold&quot;</span>, <span class="dt">coltext =</span> <span class="st">&quot;brown&quot;</span>, <span class="dt">cextext =</span> <span class="fl">1.2</span>,</span>
<span id="cb479-6"><a href="dv-plot.html#cb479-6"></a>             <span class="dt">main =</span> <span class="kw">paste</span>(</span>
<span id="cb479-7"><a href="dv-plot.html#cb479-7"></a>               <span class="st">&quot;plot symbols :  points (...  pch = *, cex =&quot;</span>,</span>
<span id="cb479-8"><a href="dv-plot.html#cb479-8"></a>               cex, <span class="st">&quot;)&quot;</span></span>
<span id="cb479-9"><a href="dv-plot.html#cb479-9"></a>             )) {</span>
<span id="cb479-10"><a href="dv-plot.html#cb479-10"></a>    nex &lt;-<span class="st"> </span><span class="kw">length</span>(extras)</span>
<span id="cb479-11"><a href="dv-plot.html#cb479-11"></a>    np &lt;-<span class="st"> </span><span class="dv">26</span> <span class="op">+</span><span class="st"> </span>nex</span>
<span id="cb479-12"><a href="dv-plot.html#cb479-12"></a>    ipch &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span>(np <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb479-13"><a href="dv-plot.html#cb479-13"></a>    k &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">sqrt</span>(np))</span>
<span id="cb479-14"><a href="dv-plot.html#cb479-14"></a>    dd &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb479-15"><a href="dv-plot.html#cb479-15"></a>    rx &lt;-<span class="st"> </span>dd <span class="op">+</span><span class="st"> </span><span class="kw">range</span>(ix &lt;-<span class="st"> </span>ipch <span class="op">%/%</span><span class="st"> </span>k)</span>
<span id="cb479-16"><a href="dv-plot.html#cb479-16"></a>    ry &lt;-<span class="st"> </span>dd <span class="op">+</span><span class="st"> </span><span class="kw">range</span>(iy &lt;-<span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span>(k <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">-</span><span class="st"> </span>ipch <span class="op">%%</span><span class="st"> </span>k)</span>
<span id="cb479-17"><a href="dv-plot.html#cb479-17"></a>    pch &lt;-<span class="st"> </span><span class="kw">as.list</span>(ipch) <span class="co"># list with integers &amp; strings</span></span>
<span id="cb479-18"><a href="dv-plot.html#cb479-18"></a>    <span class="cf">if</span> (nex <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) pch[<span class="dv">26</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span>nex] &lt;-<span class="st"> </span><span class="kw">as.list</span>(extras)</span>
<span id="cb479-19"><a href="dv-plot.html#cb479-19"></a>    <span class="kw">plot</span>(rx, ry, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> main)</span>
<span id="cb479-20"><a href="dv-plot.html#cb479-20"></a>    <span class="kw">abline</span>(<span class="dt">v =</span> ix, <span class="dt">h =</span> iy, <span class="dt">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb479-21"><a href="dv-plot.html#cb479-21"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>np) {</span>
<span id="cb479-22"><a href="dv-plot.html#cb479-22"></a>      pc &lt;-<span class="st"> </span>pch[[i]]</span>
<span id="cb479-23"><a href="dv-plot.html#cb479-23"></a>      <span class="co">## &#39;col&#39; symbols with a &#39;bg&#39;-colored interior (where available) :</span></span>
<span id="cb479-24"><a href="dv-plot.html#cb479-24"></a>      <span class="kw">points</span>(ix[i], iy[i], <span class="dt">pch =</span> pc, <span class="dt">col =</span> col, <span class="dt">bg =</span> bg, <span class="dt">cex =</span> cex)</span>
<span id="cb479-25"><a href="dv-plot.html#cb479-25"></a>      <span class="cf">if</span> (cextext <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb479-26"><a href="dv-plot.html#cb479-26"></a>        <span class="kw">text</span>(ix[i] <span class="op">-</span><span class="st"> </span><span class="fl">0.3</span>, iy[i], pc, <span class="dt">col =</span> coltext, <span class="dt">cex =</span> cextext)</span>
<span id="cb479-27"><a href="dv-plot.html#cb479-27"></a>      }</span>
<span id="cb479-28"><a href="dv-plot.html#cb479-28"></a>    }</span>
<span id="cb479-29"><a href="dv-plot.html#cb479-29"></a>  }</span>
<span id="cb479-30"><a href="dv-plot.html#cb479-30"></a></span>
<span id="cb479-31"><a href="dv-plot.html#cb479-31"></a><span class="kw">pchShow</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-1"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-1-1.png" alt="不同的 pch 参数值" width="70%" />
<p class="caption">
图 11.1: 不同的 pch 参数值
</p>
</div>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="dv-plot.html#cb480-1"></a><span class="co">## ------------ test code for various pch specifications -------------</span></span>
<span id="cb480-2"><a href="dv-plot.html#cb480-2"></a><span class="co"># Try this in various font families (including Hershey)</span></span>
<span id="cb480-3"><a href="dv-plot.html#cb480-3"></a><span class="co"># and locales.  Use sign = -1 asserts we want Latin-1.</span></span>
<span id="cb480-4"><a href="dv-plot.html#cb480-4"></a><span class="co"># Standard cases in a MBCS locale will not plot the top half.</span></span>
<span id="cb480-5"><a href="dv-plot.html#cb480-5"></a>TestChars &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">sign =</span> <span class="dv">1</span>, <span class="dt">font =</span> <span class="dv">1</span>, ...) {</span>
<span id="cb480-6"><a href="dv-plot.html#cb480-6"></a>  MB &lt;-<span class="st"> </span><span class="kw">l10n_info</span>()<span class="op">$</span>MBCS</span>
<span id="cb480-7"><a href="dv-plot.html#cb480-7"></a>  r &lt;-<span class="st"> </span><span class="cf">if</span> (font <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) {</span>
<span id="cb480-8"><a href="dv-plot.html#cb480-8"></a>    sign &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb480-9"><a href="dv-plot.html#cb480-9"></a>    <span class="kw">c</span>(<span class="dv">32</span><span class="op">:</span><span class="dv">126</span>, <span class="dv">160</span><span class="op">:</span><span class="dv">254</span>)</span>
<span id="cb480-10"><a href="dv-plot.html#cb480-10"></a>  } <span class="cf">else</span> <span class="cf">if</span> (MB) <span class="dv">32</span><span class="op">:</span><span class="dv">126</span> <span class="cf">else</span> <span class="dv">32</span><span class="op">:</span><span class="dv">255</span></span>
<span id="cb480-11"><a href="dv-plot.html#cb480-11"></a>  <span class="cf">if</span> (sign <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>) r &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">32</span><span class="op">:</span><span class="dv">126</span>, <span class="dv">160</span><span class="op">:</span><span class="dv">255</span>)</span>
<span id="cb480-12"><a href="dv-plot.html#cb480-12"></a>  <span class="kw">par</span>(<span class="dt">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb480-13"><a href="dv-plot.html#cb480-13"></a>  <span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">16</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">16</span>),</span>
<span id="cb480-14"><a href="dv-plot.html#cb480-14"></a>    <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb480-15"><a href="dv-plot.html#cb480-15"></a>    <span class="dt">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">yaxs =</span> <span class="st">&quot;i&quot;</span>,</span>
<span id="cb480-16"><a href="dv-plot.html#cb480-16"></a>    <span class="dt">main =</span> <span class="kw">sprintf</span>(<span class="st">&quot;sign = %d, font = %d&quot;</span>, sign, font)</span>
<span id="cb480-17"><a href="dv-plot.html#cb480-17"></a>  )</span>
<span id="cb480-18"><a href="dv-plot.html#cb480-18"></a>  <span class="kw">grid</span>(<span class="dv">17</span>, <span class="dv">17</span>, <span class="dt">lty =</span> <span class="dv">1</span>)</span>
<span id="cb480-19"><a href="dv-plot.html#cb480-19"></a>  <span class="kw">mtext</span>(<span class="kw">paste</span>(<span class="st">&quot;MBCS:&quot;</span>, MB))</span>
<span id="cb480-20"><a href="dv-plot.html#cb480-20"></a>  <span class="cf">for</span> (i <span class="cf">in</span> r) <span class="kw">try</span>(<span class="kw">points</span>(i <span class="op">%%</span><span class="st"> </span><span class="dv">16</span>, i <span class="op">%/%</span><span class="st"> </span><span class="dv">16</span>, <span class="dt">pch =</span> sign <span class="op">*</span><span class="st"> </span>i, <span class="dt">font =</span> font, ...))</span>
<span id="cb480-21"><a href="dv-plot.html#cb480-21"></a>}</span>
<span id="cb480-22"><a href="dv-plot.html#cb480-22"></a><span class="kw">TestChars</span>()</span>
<span id="cb480-23"><a href="dv-plot.html#cb480-23"></a><span class="kw">try</span>(<span class="kw">TestChars</span>(<span class="dt">sign =</span> <span class="dv">-1</span>))</span>
<span id="cb480-24"><a href="dv-plot.html#cb480-24"></a><span class="kw">TestChars</span>(<span class="dt">font =</span> <span class="dv">5</span>) <span class="co"># Euro might be at 160 (0+10*16).</span></span>
<span id="cb480-25"><a href="dv-plot.html#cb480-25"></a><span class="co"># macOS has apple at 240 (0+15*16).</span></span>
<span id="cb480-26"><a href="dv-plot.html#cb480-26"></a><span class="kw">try</span>(<span class="kw">TestChars</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dt">font =</span> <span class="dv">2</span>)) <span class="co"># bold</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-2-1.png" alt="pch 支持的字符" width="45%" /><img src="dv-plot_files/figure-html/unnamed-chunk-2-2.png" alt="pch 支持的字符" width="45%" /><img src="dv-plot_files/figure-html/unnamed-chunk-2-3.png" alt="pch 支持的字符" width="45%" /><img src="dv-plot_files/figure-html/unnamed-chunk-2-4.png" alt="pch 支持的字符" width="45%" />
<p class="caption">
图 11.2: pch 支持的字符
</p>
</div>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="dv-plot.html#cb481-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">12</span></span>
<span id="cb481-2"><a href="dv-plot.html#cb481-2"></a>y &lt;-<span class="st"> </span><span class="kw">sin</span>(pi <span class="op">/</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x)</span>
<span id="cb481-3"><a href="dv-plot.html#cb481-3"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">mar =</span> <span class="fl">.1</span> <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb481-4"><a href="dv-plot.html#cb481-4"></a><span class="cf">for</span> (tp <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;n&quot;</span>)) {</span>
<span id="cb481-5"><a href="dv-plot.html#cb481-5"></a>  <span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> tp, <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;plot(*, type = </span><span class="ch">\&quot;</span><span class="st">&quot;</span>, tp, <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">)&quot;</span>))</span>
<span id="cb481-6"><a href="dv-plot.html#cb481-6"></a>  <span class="cf">if</span> (tp <span class="op">==</span><span class="st"> &quot;S&quot;</span>) {</span>
<span id="cb481-7"><a href="dv-plot.html#cb481-7"></a>    <span class="kw">lines</span>(x, y, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb481-8"><a href="dv-plot.html#cb481-8"></a>    <span class="kw">mtext</span>(<span class="st">&quot;lines(*, type = </span><span class="ch">\&quot;</span><span class="st">s</span><span class="ch">\&quot;</span><span class="st">, ...)&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb481-9"><a href="dv-plot.html#cb481-9"></a>  }</span>
<span id="cb481-10"><a href="dv-plot.html#cb481-10"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-3-1.png" alt="不同的 type 参数值" width="70%" />
<p class="caption">
图 11.3: 不同的 type 参数值
</p>
</div>
<p>颜色 col 连续型和离散型</p>
<p>线帽/端和字体的样式</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="dv-plot.html#cb482-1"></a><span class="co"># 合并为一个图 三条粗横线 横线上三种字形</span></span>
<span id="cb482-2"><a href="dv-plot.html#cb482-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>)</span>
<span id="cb482-3"><a href="dv-plot.html#cb482-3"></a><span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>), <span class="dt">lwd =</span> <span class="dv">15</span>, <span class="dt">lend =</span> <span class="st">&quot;round&quot;</span>)</span>
<span id="cb482-4"><a href="dv-plot.html#cb482-4"></a><span class="kw">text</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="st">&quot;Hello, Helvetica&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;sans&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">offset =</span> <span class="fl">1.5</span>)</span>
<span id="cb482-5"><a href="dv-plot.html#cb482-5"></a><span class="kw">text</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="st">&quot;sans&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;sans&quot;</span>, <span class="dt">pos =</span> <span class="dv">2</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)</span>
<span id="cb482-6"><a href="dv-plot.html#cb482-6"></a><span class="kw">text</span>(<span class="dv">15</span>, <span class="dv">5</span>, <span class="st">&quot;lend = round&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)</span>
<span id="cb482-7"><a href="dv-plot.html#cb482-7"></a></span>
<span id="cb482-8"><a href="dv-plot.html#cb482-8"></a><span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="dt">lwd =</span> <span class="dv">15</span>, <span class="dt">lend =</span> <span class="st">&quot;butt&quot;</span>)</span>
<span id="cb482-9"><a href="dv-plot.html#cb482-9"></a><span class="kw">text</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="st">&quot;Hello, Helvetica&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;mono&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">offset =</span> <span class="fl">1.5</span>)</span>
<span id="cb482-10"><a href="dv-plot.html#cb482-10"></a><span class="kw">text</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="st">&quot;mono&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;mono&quot;</span>, <span class="dt">pos =</span> <span class="dv">2</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)</span>
<span id="cb482-11"><a href="dv-plot.html#cb482-11"></a><span class="kw">text</span>(<span class="dv">15</span>, <span class="dv">10</span>, <span class="st">&quot;lend = butt&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)</span>
<span id="cb482-12"><a href="dv-plot.html#cb482-12"></a></span>
<span id="cb482-13"><a href="dv-plot.html#cb482-13"></a><span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">15</span>), <span class="dt">lwd =</span> <span class="dv">15</span>, <span class="dt">lend =</span> <span class="st">&quot;square&quot;</span>)</span>
<span id="cb482-14"><a href="dv-plot.html#cb482-14"></a><span class="kw">text</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="st">&quot;Hello, Helvetica&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;serif&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">offset =</span> <span class="fl">1.5</span>)</span>
<span id="cb482-15"><a href="dv-plot.html#cb482-15"></a><span class="kw">text</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="st">&quot;serif&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;serif&quot;</span>, <span class="dt">pos =</span> <span class="dv">2</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)</span>
<span id="cb482-16"><a href="dv-plot.html#cb482-16"></a><span class="kw">text</span>(<span class="dv">15</span>, <span class="dv">15</span>, <span class="st">&quot;lend = square&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-4-1.png" alt="不同的线端样式" width="55%" />
<p class="caption">
图 11.4: 不同的线端样式
</p>
</div>
<p>lend：线端的样式，可用一个整数或字符串指定：</p>
<ul>
<li>0 或 “round” 圆形（默认）</li>
<li>1 或 “butt” 对接形</li>
<li>2 或 “square” 方形</li>
</ul>
</div>
<div id="base-rect" class="section level3">
<h3><span class="header-section-number">11.1.2</span> 区域</h3>
<p>矩形，多边形，曲线交汇出来的区域
面（矩形rect，多边形polygon）、路径 polypath
面/多边形 rect 颜色填充</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="dv-plot.html#cb483-1"></a><span class="co"># From the manual</span></span>
<span id="cb483-2"><a href="dv-plot.html#cb483-2"></a>ch.col &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb483-3"><a href="dv-plot.html#cb483-3"></a>  <span class="st">&quot;rainbow(n, start=.7, end=.1)&quot;</span>,</span>
<span id="cb483-4"><a href="dv-plot.html#cb483-4"></a>  <span class="st">&quot;heat.colors(n)&quot;</span>,</span>
<span id="cb483-5"><a href="dv-plot.html#cb483-5"></a>  <span class="st">&quot;terrain.colors(n)&quot;</span>,</span>
<span id="cb483-6"><a href="dv-plot.html#cb483-6"></a>  <span class="st">&quot;topo.colors(n)&quot;</span>,</span>
<span id="cb483-7"><a href="dv-plot.html#cb483-7"></a>  <span class="st">&quot;cm.colors(n)&quot;</span></span>
<span id="cb483-8"><a href="dv-plot.html#cb483-8"></a>) <span class="co"># 选择颜色</span></span>
<span id="cb483-9"><a href="dv-plot.html#cb483-9"></a>n &lt;-<span class="st"> </span><span class="dv">16</span></span>
<span id="cb483-10"><a href="dv-plot.html#cb483-10"></a>nt &lt;-<span class="st"> </span><span class="kw">length</span>(ch.col)</span>
<span id="cb483-11"><a href="dv-plot.html#cb483-11"></a>i &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n</span>
<span id="cb483-12"><a href="dv-plot.html#cb483-12"></a>j &lt;-<span class="st"> </span>n <span class="op">/</span><span class="st"> </span>nt</span>
<span id="cb483-13"><a href="dv-plot.html#cb483-13"></a>d &lt;-<span class="st"> </span>j <span class="op">/</span><span class="st"> </span><span class="dv">6</span></span>
<span id="cb483-14"><a href="dv-plot.html#cb483-14"></a>dy &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>d</span>
<span id="cb483-15"><a href="dv-plot.html#cb483-15"></a><span class="kw">plot</span>(i, i <span class="op">+</span><span class="st"> </span>d,</span>
<span id="cb483-16"><a href="dv-plot.html#cb483-16"></a>  <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb483-17"><a href="dv-plot.html#cb483-17"></a>  <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb483-18"><a href="dv-plot.html#cb483-18"></a>  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb483-19"><a href="dv-plot.html#cb483-19"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb483-20"><a href="dv-plot.html#cb483-20"></a>  <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;color palettes; n=&quot;</span>, n)</span>
<span id="cb483-21"><a href="dv-plot.html#cb483-21"></a>)</span>
<span id="cb483-22"><a href="dv-plot.html#cb483-22"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nt) {</span>
<span id="cb483-23"><a href="dv-plot.html#cb483-23"></a>  <span class="kw">rect</span>(i <span class="op">-</span><span class="st"> </span><span class="fl">.5</span>, (k <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>j <span class="op">+</span><span class="st"> </span>dy, i <span class="op">+</span><span class="st"> </span><span class="fl">.4</span>, k <span class="op">*</span><span class="st"> </span>j,</span>
<span id="cb483-24"><a href="dv-plot.html#cb483-24"></a>    <span class="dt">col =</span> <span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> ch.col[k]))</span>
<span id="cb483-25"><a href="dv-plot.html#cb483-25"></a>  ) <span class="co"># 咬人的函数/字符串解析为/转函数</span></span>
<span id="cb483-26"><a href="dv-plot.html#cb483-26"></a>  <span class="kw">text</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>j, k <span class="op">*</span><span class="st"> </span>j <span class="op">+</span><span class="st"> </span>dy <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, ch.col[k])</span>
<span id="cb483-27"><a href="dv-plot.html#cb483-27"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-5-1.png" alt="rect 函数画长方形" width="70%" />
<p class="caption">
图 11.5: rect 函数画长方形
</p>
</div>
<p><code>clip(x1, x2, y1, y2)</code> 在用户坐标中设置剪切区域</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="dv-plot.html#cb484-1"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb484-2"><a href="dv-plot.html#cb484-2"></a><span class="kw">hist</span>(x, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb484-3"><a href="dv-plot.html#cb484-3"></a>usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)</span>
<span id="cb484-4"><a href="dv-plot.html#cb484-4"></a><span class="kw">clip</span>(usr[<span class="dv">1</span>], <span class="dv">-2</span>, usr[<span class="dv">3</span>], usr[<span class="dv">4</span>])</span>
<span id="cb484-5"><a href="dv-plot.html#cb484-5"></a><span class="kw">hist</span>(x, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb484-6"><a href="dv-plot.html#cb484-6"></a><span class="kw">clip</span>(<span class="dv">2</span>, usr[<span class="dv">2</span>], usr[<span class="dv">3</span>], usr[<span class="dv">4</span>])</span>
<span id="cb484-7"><a href="dv-plot.html#cb484-7"></a><span class="kw">hist</span>(x, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb484-8"><a href="dv-plot.html#cb484-8"></a><span class="kw">do.call</span>(<span class="st">&quot;clip&quot;</span>, <span class="kw">as.list</span>(usr)) <span class="co"># reset to plot region</span></span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="dv-plot.html#cb485-1"></a>my.col &lt;-<span class="st"> </span><span class="cf">function</span>(f, g, xmin, xmax, col, <span class="dt">N =</span> <span class="dv">200</span>,</span>
<span id="cb485-2"><a href="dv-plot.html#cb485-2"></a>                   <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>) {</span>
<span id="cb485-3"><a href="dv-plot.html#cb485-3"></a>  x &lt;-<span class="st"> </span><span class="kw">seq</span>(xmin, xmax, <span class="dt">length =</span> N)</span>
<span id="cb485-4"><a href="dv-plot.html#cb485-4"></a>  fx &lt;-<span class="st"> </span><span class="kw">f</span>(x)</span>
<span id="cb485-5"><a href="dv-plot.html#cb485-5"></a>  gx &lt;-<span class="st"> </span><span class="kw">g</span>(x)</span>
<span id="cb485-6"><a href="dv-plot.html#cb485-6"></a>  <span class="kw">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb485-7"><a href="dv-plot.html#cb485-7"></a>    <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb485-8"><a href="dv-plot.html#cb485-8"></a>    <span class="dt">xlim =</span> <span class="kw">c</span>(xmin, xmax),</span>
<span id="cb485-9"><a href="dv-plot.html#cb485-9"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(fx, gx), <span class="kw">max</span>(fx, gx)),</span>
<span id="cb485-10"><a href="dv-plot.html#cb485-10"></a>    <span class="dt">xlab =</span> xlab, <span class="dt">ylab =</span> ylab, <span class="dt">main =</span> main</span>
<span id="cb485-11"><a href="dv-plot.html#cb485-11"></a>  )</span>
<span id="cb485-12"><a href="dv-plot.html#cb485-12"></a>  <span class="kw">polygon</span>(<span class="kw">c</span>(x, <span class="kw">rev</span>(x)), <span class="kw">c</span>(fx, <span class="kw">rev</span>(gx)),</span>
<span id="cb485-13"><a href="dv-plot.html#cb485-13"></a>    <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span>, <span class="dt">border =</span> <span class="dv">0</span></span>
<span id="cb485-14"><a href="dv-plot.html#cb485-14"></a>  )</span>
<span id="cb485-15"><a href="dv-plot.html#cb485-15"></a>  <span class="kw">lines</span>(x, fx, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;#34A853&quot;</span>)</span>
<span id="cb485-16"><a href="dv-plot.html#cb485-16"></a>  <span class="kw">lines</span>(x, gx, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;#4285f4&quot;</span>)</span>
<span id="cb485-17"><a href="dv-plot.html#cb485-17"></a>}</span>
<span id="cb485-18"><a href="dv-plot.html#cb485-18"></a><span class="kw">my.col</span>(<span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span>, <span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(x),</span>
<span id="cb485-19"><a href="dv-plot.html#cb485-19"></a>  <span class="dv">-6</span>, <span class="dv">6</span>,</span>
<span id="cb485-20"><a href="dv-plot.html#cb485-20"></a>  <span class="dt">main =</span> <span class="st">&quot;The </span><span class="ch">\&quot;</span><span class="st">polygon</span><span class="ch">\&quot;</span><span class="st"> function&quot;</span></span>
<span id="cb485-21"><a href="dv-plot.html#cb485-21"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-7-1.png" alt="区域重叠 polygon 函数" width="55%" />
<p class="caption">
图 11.6: 区域重叠 polygon 函数
</p>
</div>
<p>各种符号 <a href="dv-plot.html#fig:cex-symbol">11.7</a></p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="dv-plot.html#cb486-1"></a><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb486-2"><a href="dv-plot.html#cb486-2"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>, <span class="dv">4</span>),</span>
<span id="cb486-3"><a href="dv-plot.html#cb486-3"></a>  <span class="dt">axes =</span> F,</span>
<span id="cb486-4"><a href="dv-plot.html#cb486-4"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb486-5"><a href="dv-plot.html#cb486-5"></a>)</span>
<span id="cb486-6"><a href="dv-plot.html#cb486-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb486-7"><a href="dv-plot.html#cb486-7"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb486-8"><a href="dv-plot.html#cb486-8"></a>    n &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>i <span class="op">+</span><span class="st"> </span>j</span>
<span id="cb486-9"><a href="dv-plot.html#cb486-9"></a>    <span class="kw">points</span>(j, i,</span>
<span id="cb486-10"><a href="dv-plot.html#cb486-10"></a>      <span class="dt">pch =</span> n,</span>
<span id="cb486-11"><a href="dv-plot.html#cb486-11"></a>      <span class="dt">cex =</span> <span class="dv">3</span></span>
<span id="cb486-12"><a href="dv-plot.html#cb486-12"></a>    )</span>
<span id="cb486-13"><a href="dv-plot.html#cb486-13"></a>    <span class="kw">text</span>(j, i <span class="op">-</span><span class="st"> </span><span class="fl">.3</span>, <span class="kw">as.character</span>(n))</span>
<span id="cb486-14"><a href="dv-plot.html#cb486-14"></a>  }</span>
<span id="cb486-15"><a href="dv-plot.html#cb486-15"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cex-symbol"></span>
<img src="dv-plot_files/figure-html/cex-symbol-1.png" alt="cex 支持的符号" width="55%" />
<p class="caption">
图 11.7: cex 支持的符号
</p>
</div>
<p>点、线、多边形和圆聚集在图 <a href="dv-plot.html#fig:symbols">11.8</a> 中</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="dv-plot.html#cb487-1"></a><span class="co"># https://jeroen.github.io/uros2018/#23</span></span>
<span id="cb487-2"><a href="dv-plot.html#cb487-2"></a><span class="kw">plot.new</span>()</span>
<span id="cb487-3"><a href="dv-plot.html#cb487-3"></a><span class="kw">plot.window</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb487-4"><a href="dv-plot.html#cb487-4"></a><span class="kw">polygon</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">80</span>), <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">80</span>, <span class="dv">40</span>), <span class="dt">col =</span> <span class="st">&quot;hotpink&quot;</span>)</span>
<span id="cb487-5"><a href="dv-plot.html#cb487-5"></a><span class="kw">text</span>(<span class="dv">40</span>, <span class="dv">90</span>, <span class="dt">labels =</span> <span class="st">&quot;My drawing&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;navyblue&quot;</span>, <span class="dt">cex =</span> <span class="dv">3</span>)</span>
<span id="cb487-6"><a href="dv-plot.html#cb487-6"></a><span class="kw">symbols</span>(<span class="kw">c</span>(<span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>), <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">80</span>),</span>
<span id="cb487-7"><a href="dv-plot.html#cb487-7"></a>  <span class="dt">circles =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">10</span>),</span>
<span id="cb487-8"><a href="dv-plot.html#cb487-8"></a>  <span class="dt">bg =</span> <span class="kw">c</span>(<span class="st">&quot;#4285f4&quot;</span>, <span class="st">&quot;#EA4335&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span></span>
<span id="cb487-9"><a href="dv-plot.html#cb487-9"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:symbols"></span>
<img src="dv-plot_files/figure-html/symbols-1.png" alt="多边形和符号元素" width="70%" />
<p class="caption">
图 11.8: 多边形和符号元素
</p>
</div>
<p>在介绍各种统计图形之前，先介绍几个绘图函数 <code>plot</code> 和 <code>text</code> 还有 <code>par</code> 参数设置， 作为最简单的开始，尽量依次介绍其中的每个参数的含义并附上图形对比。</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="dv-plot.html#cb488-1"></a>y &lt;-<span class="st"> </span>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span></span>
<span id="cb488-2"><a href="dv-plot.html#cb488-2"></a><span class="kw">plot</span>(x, y, <span class="dt">ann =</span> F, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</span>
<span id="cb488-3"><a href="dv-plot.html#cb488-3"></a><span class="kw">text</span>(x, y,</span>
<span id="cb488-4"><a href="dv-plot.html#cb488-4"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>, <span class="st">&quot;2nd&quot;</span>, <span class="st">&quot;3rd&quot;</span>, <span class="st">&quot;4th&quot;</span>),</span>
<span id="cb488-5"><a href="dv-plot.html#cb488-5"></a>  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>), <span class="dt">offset =</span> <span class="fl">0.6</span></span>
<span id="cb488-6"><a href="dv-plot.html#cb488-6"></a>)</span>
<span id="cb488-7"><a href="dv-plot.html#cb488-7"></a>ahat &lt;-<span class="st"> &quot;sigma&quot;</span></span>
<span id="cb488-8"><a href="dv-plot.html#cb488-8"></a><span class="co"># title(substitute(hat(a) == ahat, list(ahat = ahat)))</span></span>
<span id="cb488-9"><a href="dv-plot.html#cb488-9"></a><span class="kw">title</span>(<span class="kw">bquote</span>(<span class="kw">hat</span>(a) <span class="op">==</span><span class="st"> </span>.(ahat)))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pos"></span>
<img src="dv-plot_files/figure-html/pos-1.png" alt="pos 位置参数" width="55%" />
<p class="caption">
图 11.9: pos 位置参数
</p>
</div>
<p>其中 labels， pos 都是向量化的参数</p>
</div>
<div id="base-lines" class="section level3">
<h3><span class="header-section-number">11.1.3</span> 参考线</h3>
<p>矩形网格线是用做背景参考线的，常常是淡灰色的细密虚线，<code>plot</code> 函数的 <code>panel.first</code> 参数和 <code>grid</code> 函数常用来画这种参考线</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="dv-plot.html#cb489-1"></a><span class="co"># modified from https://yihui.name/cn/2018/02/cohen-s-d/</span></span>
<span id="cb489-2"><a href="dv-plot.html#cb489-2"></a>n &lt;-<span class="st"> </span><span class="dv">30</span> <span class="co"># 样本量（只是一个例子）</span></span>
<span id="cb489-3"><a href="dv-plot.html#cb489-3"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="fl">0.01</span>)</span>
<span id="cb489-4"><a href="dv-plot.html#cb489-4"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>))</span>
<span id="cb489-5"><a href="dv-plot.html#cb489-5"></a><span class="kw">plot</span>(x <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n), <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(x, n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)),</span>
<span id="cb489-6"><a href="dv-plot.html#cb489-6"></a>  <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="dt">d =</span> x <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)),</span>
<span id="cb489-7"><a href="dv-plot.html#cb489-7"></a>  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">panel.first =</span> <span class="kw">grid</span>()</span>
<span id="cb489-8"><a href="dv-plot.html#cb489-8"></a>)</span>
<span id="cb489-9"><a href="dv-plot.html#cb489-9"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:bg-grid-lines"></span>
<img src="dv-plot_files/figure-html/bg-grid-lines-1.png" alt="添加背景参考线" width="70%" />
<p class="caption">
图 11.10: 添加背景参考线
</p>
</div>
</div>
<div id="base-axis" class="section level3">
<h3><span class="header-section-number">11.1.4</span> 坐标轴</h3>
<p>图形控制参数默认设置下 <code>par</code> 通常的一幅图形，改变坐标轴标签是很简单的</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="dv-plot.html#cb490-1"></a>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span></span>
<span id="cb490-2"><a href="dv-plot.html#cb490-2"></a>y &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>, <span class="dv">-2</span>, <span class="dv">2</span>)</span>
<span id="cb490-3"><a href="dv-plot.html#cb490-3"></a><span class="kw">plot</span>(x, y)</span>
<span id="cb490-4"><a href="dv-plot.html#cb490-4"></a><span class="kw">plot</span>(x, y, <span class="dt">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Uniform draws&quot;</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /><img src="dv-plot_files/figure-html/unnamed-chunk-8-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>改变坐标轴标签和标题</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="dv-plot.html#cb491-1"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>) <span class="co"># 保存默认的 par 设置</span></span>
<span id="cb491-2"><a href="dv-plot.html#cb491-2"></a><span class="kw">par</span>(<span class="dt">cex.lab =</span> <span class="fl">1.5</span>, <span class="dt">cex.axis =</span> <span class="fl">1.3</span>)</span>
<span id="cb491-3"><a href="dv-plot.html#cb491-3"></a><span class="kw">plot</span>(x, y, <span class="dt">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Uniform draws&quot;</span>)</span>
<span id="cb491-4"><a href="dv-plot.html#cb491-4"></a></span>
<span id="cb491-5"><a href="dv-plot.html#cb491-5"></a><span class="co"># 设置更大的坐标轴标签内容</span></span>
<span id="cb491-6"><a href="dv-plot.html#cb491-6"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">cex.axis =</span> <span class="fl">1.5</span>, <span class="dt">cex.lab =</span> <span class="dv">2</span>)</span>
<span id="cb491-7"><a href="dv-plot.html#cb491-7"></a><span class="kw">plot</span>(x, y, <span class="dt">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Uniform draws&quot;</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>使用 axis 函数可以更加精细地控制坐标轴</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="dv-plot.html#cb492-1"></a><span class="kw">par</span>(op) <span class="co"># 恢复默认的 par 设置</span></span>
<span id="cb492-2"><a href="dv-plot.html#cb492-2"></a><span class="kw">plot</span>(x, y, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>) <span class="co"># 去掉 x 轴</span></span>
<span id="cb492-3"><a href="dv-plot.html#cb492-3"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">50</span>, <span class="dv">100</span>)) <span class="co"># 添加指定的刻度标签</span></span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>指定刻度标签的内容</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="dv-plot.html#cb493-1"></a><span class="kw">plot</span>(x, y, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb493-2"><a href="dv-plot.html#cb493-2"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Big&quot;</span>))</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>控制刻度线和轴线和刻度标签</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="dv-plot.html#cb494-1"></a><span class="kw">plot</span>(x, y)</span>
<span id="cb494-2"><a href="dv-plot.html#cb494-2"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">75</span>), <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">lwd.ticks =</span> <span class="dv">2</span>, <span class="dt">col.ticks =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>还可以把 box 移除，绘图区域的边框去掉，只保留坐标轴</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="dv-plot.html#cb495-1"></a><span class="kw">plot</span>(x, y, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb495-2"><a href="dv-plot.html#cb495-2"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">20</span>), <span class="dt">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb495-3"><a href="dv-plot.html#cb495-3"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="dv-plot.html#cb496-1"></a><span class="co"># 双Y轴</span></span>
<span id="cb496-2"><a href="dv-plot.html#cb496-2"></a>N &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb496-3"><a href="dv-plot.html#cb496-3"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">length =</span> N)</span>
<span id="cb496-4"><a href="dv-plot.html#cb496-4"></a>y1 &lt;-<span class="st"> </span><span class="kw">sin</span>(x)</span>
<span id="cb496-5"><a href="dv-plot.html#cb496-5"></a>y2 &lt;-<span class="st"> </span><span class="kw">cos</span>(x)</span>
<span id="cb496-6"><a href="dv-plot.html#cb496-6"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>)) <span class="co"># Add some space in the right margin</span></span>
<span id="cb496-7"><a href="dv-plot.html#cb496-7"></a><span class="co"># The default is c(5,4,4,2) + .1</span></span>
<span id="cb496-8"><a href="dv-plot.html#cb496-8"></a>xlim &lt;-<span class="st"> </span><span class="kw">range</span>(x)</span>
<span id="cb496-9"><a href="dv-plot.html#cb496-9"></a>ylim &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb496-10"><a href="dv-plot.html#cb496-10"></a><span class="kw">plot</span>(x, y1,</span>
<span id="cb496-11"><a href="dv-plot.html#cb496-11"></a>  <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb496-12"><a href="dv-plot.html#cb496-12"></a>  <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim,</span>
<span id="cb496-13"><a href="dv-plot.html#cb496-13"></a>  <span class="dt">axes =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Title&quot;</span></span>
<span id="cb496-14"><a href="dv-plot.html#cb496-14"></a>)</span>
<span id="cb496-15"><a href="dv-plot.html#cb496-15"></a><span class="kw">axis</span>(<span class="dv">1</span>)</span>
<span id="cb496-16"><a href="dv-plot.html#cb496-16"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb496-17"><a href="dv-plot.html#cb496-17"></a><span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">TRUE</span>)</span>
<span id="cb496-18"><a href="dv-plot.html#cb496-18"></a><span class="kw">plot</span>(x, y2,</span>
<span id="cb496-19"><a href="dv-plot.html#cb496-19"></a>  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb496-20"><a href="dv-plot.html#cb496-20"></a>  <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim,</span>
<span id="cb496-21"><a href="dv-plot.html#cb496-21"></a>  <span class="dt">axes =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb496-22"><a href="dv-plot.html#cb496-22"></a>)</span>
<span id="cb496-23"><a href="dv-plot.html#cb496-23"></a><span class="kw">axis</span>(<span class="dv">4</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb496-24"><a href="dv-plot.html#cb496-24"></a><span class="kw">mtext</span>(<span class="st">&quot;First Y axis&quot;</span>, <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb496-25"><a href="dv-plot.html#cb496-25"></a><span class="kw">mtext</span>(<span class="st">&quot;Second Y axis&quot;</span>, <span class="dv">4</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb496-26"><a href="dv-plot.html#cb496-26"></a><span class="co"># 1,2,3,4 分别代表下左上右四个位置</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-14-1.png" alt="两个 Y 轴" width="65%" />
<p class="caption">
图 11.11: 两个 Y 轴
</p>
</div>
<p>调整坐标轴标签的距离</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="dv-plot.html#cb497-1"></a><span class="co">## Changing default gap between labels:</span></span>
<span id="cb497-2"><a href="dv-plot.html#cb497-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>)</span>
<span id="cb497-3"><a href="dv-plot.html#cb497-3"></a><span class="kw">title</span>(<span class="kw">quote</span>(<span class="st">&quot;axis(1, .., gap.axis = f),&quot;</span> <span class="op">~</span><span class="st"> </span><span class="er">~</span><span class="st"> </span>f <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>))</span>
<span id="cb497-4"><a href="dv-plot.html#cb497-4"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>), <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">gap.axis =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb497-5"><a href="dv-plot.html#cb497-5"></a>gaps &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="fl">0.1</span>, <span class="dv">0</span>)</span>
<span id="cb497-6"><a href="dv-plot.html#cb497-6"></a>chG &lt;-<span class="st"> </span><span class="kw">paste0</span>(</span>
<span id="cb497-7"><a href="dv-plot.html#cb497-7"></a>  <span class="kw">ifelse</span>(gaps <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;default:  &quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb497-8"><a href="dv-plot.html#cb497-8"></a>  <span class="st">&quot;gap.axis=&quot;</span>, <span class="kw">formatC</span>(gaps)</span>
<span id="cb497-9"><a href="dv-plot.html#cb497-9"></a>)</span>
<span id="cb497-10"><a href="dv-plot.html#cb497-10"></a>jj &lt;-<span class="st"> </span><span class="kw">seq_along</span>(gaps)</span>
<span id="cb497-11"><a href="dv-plot.html#cb497-11"></a>linG &lt;-<span class="st"> </span><span class="fl">-2.5</span> <span class="op">*</span><span class="st"> </span>(jj <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb497-12"><a href="dv-plot.html#cb497-12"></a><span class="cf">for</span> (j <span class="cf">in</span> jj) {</span>
<span id="cb497-13"><a href="dv-plot.html#cb497-13"></a>  isD &lt;-<span class="st"> </span>gaps[j] <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="co"># is default</span></span>
<span id="cb497-14"><a href="dv-plot.html#cb497-14"></a>  <span class="kw">axis</span>(<span class="dv">1</span>,</span>
<span id="cb497-15"><a href="dv-plot.html#cb497-15"></a>    <span class="dt">at =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">0</span><span class="op">:</span><span class="dv">20</span>), <span class="dt">gap.axis =</span> gaps[j], <span class="dt">padj =</span> <span class="dv">-1</span>, <span class="dt">line =</span> linG[j],</span>
<span id="cb497-16"><a href="dv-plot.html#cb497-16"></a>    <span class="dt">col.axis =</span> <span class="cf">if</span> (isD) <span class="st">&quot;forest green&quot;</span> <span class="cf">else</span> <span class="dv">1</span>, <span class="dt">font.axis =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>isD</span>
<span id="cb497-17"><a href="dv-plot.html#cb497-17"></a>  )</span>
<span id="cb497-18"><a href="dv-plot.html#cb497-18"></a>}</span>
<span id="cb497-19"><a href="dv-plot.html#cb497-19"></a><span class="kw">mtext</span>(chG,</span>
<span id="cb497-20"><a href="dv-plot.html#cb497-20"></a>  <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">padj =</span> <span class="dv">-1</span>, <span class="dt">line =</span> linG <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">cex =</span> <span class="dv">3</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>,</span>
<span id="cb497-21"><a href="dv-plot.html#cb497-21"></a>  <span class="dt">col =</span> <span class="kw">ifelse</span>(gaps <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;forest green&quot;</span>, <span class="st">&quot;blue3&quot;</span>)</span>
<span id="cb497-22"><a href="dv-plot.html#cb497-22"></a>)</span>
<span id="cb497-23"><a href="dv-plot.html#cb497-23"></a><span class="co">## now shrink the window (in x- and y-direction) and observe the axis labels drawn</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gap-axis"></span>
<img src="dv-plot_files/figure-html/gap-axis-1.png" alt="gap.axis用法" width="55%" />
<p class="caption">
图 11.12: gap.axis用法
</p>
</div>
<p>旋转坐标轴标签</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="dv-plot.html#cb498-1"></a><span class="co"># Rotated axis labels in R plots</span></span>
<span id="cb498-2"><a href="dv-plot.html#cb498-2"></a><span class="co"># https://menugget.blogspot.com/2014/08/rotated-axis-labels-in-r-plots.html</span></span>
<span id="cb498-3"><a href="dv-plot.html#cb498-3"></a><span class="co"># Example data</span></span>
<span id="cb498-4"><a href="dv-plot.html#cb498-4"></a>tmin &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2000-01-01&quot;</span>)</span>
<span id="cb498-5"><a href="dv-plot.html#cb498-5"></a>tmax &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2001-01-01&quot;</span>)</span>
<span id="cb498-6"><a href="dv-plot.html#cb498-6"></a>tlab &lt;-<span class="st"> </span><span class="kw">seq</span>(tmin, tmax, <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>)</span>
<span id="cb498-7"><a href="dv-plot.html#cb498-7"></a>lab &lt;-<span class="st"> </span><span class="kw">format</span>(tlab, <span class="dt">format =</span> <span class="st">&quot;%Y-%b&quot;</span>)</span>
<span id="cb498-8"><a href="dv-plot.html#cb498-8"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb498-9"><a href="dv-plot.html#cb498-9"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(tmin, tmax, <span class="dt">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb498-10"><a href="dv-plot.html#cb498-10"></a>y &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb498-11"><a href="dv-plot.html#cb498-11"></a></span>
<span id="cb498-12"><a href="dv-plot.html#cb498-12"></a><span class="co"># Plot</span></span>
<span id="cb498-13"><a href="dv-plot.html#cb498-13"></a><span class="co"># png(&quot;plot_w_rotated_axis_labels.png&quot;, height = 3,</span></span>
<span id="cb498-14"><a href="dv-plot.html#cb498-14"></a><span class="co">#     width = 6, units = &quot;in&quot;, res = 300)</span></span>
<span id="cb498-15"><a href="dv-plot.html#cb498-15"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb498-16"><a href="dv-plot.html#cb498-16"></a><span class="kw">plot</span>(x, y, <span class="dt">t =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb498-17"><a href="dv-plot.html#cb498-17"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> tlab, <span class="dt">labels =</span> <span class="ot">FALSE</span>)</span>
<span id="cb498-18"><a href="dv-plot.html#cb498-18"></a><span class="kw">text</span>(</span>
<span id="cb498-19"><a href="dv-plot.html#cb498-19"></a>  <span class="dt">x =</span> tlab, <span class="dt">y =</span> <span class="kw">par</span>()<span class="op">$</span>usr[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">par</span>()<span class="op">$</span>usr[<span class="dv">4</span>] <span class="op">-</span><span class="st"> </span><span class="kw">par</span>()<span class="op">$</span>usr[<span class="dv">3</span>]),</span>
<span id="cb498-20"><a href="dv-plot.html#cb498-20"></a>  <span class="dt">labels =</span> lab, <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">adj =</span> <span class="dv">1</span>, <span class="dt">xpd =</span> <span class="ot">TRUE</span></span>
<span id="cb498-21"><a href="dv-plot.html#cb498-21"></a>)</span>
<span id="cb498-22"><a href="dv-plot.html#cb498-22"></a><span class="kw">par</span>(op)</span>
<span id="cb498-23"><a href="dv-plot.html#cb498-23"></a><span class="co"># dev.off()</span></span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>旋转坐标抽标签的例子来自手册《R FAQ》的第7章第27个问题 <span class="citation">(Hornik <a href="#ref-R-FAQ" role="doc-biblioref">2018</a>)</span>，在基础图形中，旋转坐标轴标签需要 <code>text()</code> 而不是 <code>mtext()</code>，因为后者不支持<code>par("srt")</code></p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="dv-plot.html#cb499-1"></a><span class="co">## Increase bottom margin to make room for rotated labels</span></span>
<span id="cb499-2"><a href="dv-plot.html#cb499-2"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="fl">.5</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</span>
<span id="cb499-3"><a href="dv-plot.html#cb499-3"></a><span class="co">## Create plot with no x axis and no x axis label</span></span>
<span id="cb499-4"><a href="dv-plot.html#cb499-4"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb499-5"><a href="dv-plot.html#cb499-5"></a><span class="co">## Set up x axis with tick marks alone</span></span>
<span id="cb499-6"><a href="dv-plot.html#cb499-6"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>)</span>
<span id="cb499-7"><a href="dv-plot.html#cb499-7"></a><span class="co">## Create some text labels</span></span>
<span id="cb499-8"><a href="dv-plot.html#cb499-8"></a>labels &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Label&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb499-9"><a href="dv-plot.html#cb499-9"></a><span class="co">## Plot x axis labels at default tick marks</span></span>
<span id="cb499-10"><a href="dv-plot.html#cb499-10"></a><span class="kw">text</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>,</span>
<span id="cb499-11"><a href="dv-plot.html#cb499-11"></a>  <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">adj =</span> <span class="dv">1</span>,</span>
<span id="cb499-12"><a href="dv-plot.html#cb499-12"></a>  <span class="dt">labels =</span> labels, <span class="dt">xpd =</span> <span class="ot">TRUE</span></span>
<span id="cb499-13"><a href="dv-plot.html#cb499-13"></a>)</span>
<span id="cb499-14"><a href="dv-plot.html#cb499-14"></a><span class="co">## Plot x axis label at line 6 (of 7)</span></span>
<span id="cb499-15"><a href="dv-plot.html#cb499-15"></a><span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">text =</span> <span class="st">&quot;X Axis Label&quot;</span>, <span class="dt">line =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:rotate-axis-labels"></span>
<img src="dv-plot_files/figure-html/rotate-axis-labels-1.png" alt="旋转坐标轴标签" width="70%" />
<p class="caption">
图 11.13: 旋转坐标轴标签
</p>
</div>
<p><code>srt = 45</code> 表示文本旋转角度， <code>xpd = TRUE</code> 允许文本越出绘图区域，<code>adj = 1</code> to place the right end of text at the tick marks；You can adjust the value of the 0.5 offset as required to move the axis labels up or down relative to the x axis. 详细地参考 <span class="citation">(Murrell <a href="#ref-Paul_2003_Integrating" role="doc-biblioref">2003</a>)</span></p>
</div>
<div id="base-tick" class="section level3">
<h3><span class="header-section-number">11.1.5</span> 刻度线</h3>
<p>通过 <code>par</code> 或 <code>axis</code> 函数实现刻度线的精细操作，tcl 控制刻度线的长度，正值让刻度画在绘图区域内，负值正好相反，画在外面，mgp 参数有三个值，第一个值控制绘图区域和坐标轴标题之间的行数，第二个是绘图区域与坐标轴标签的行数，第三个绘图区域与轴线的行数，行数表示间距</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="dv-plot.html#cb500-1"></a><span class="kw">par</span>(<span class="dt">tcl =</span> <span class="fl">0.4</span>, <span class="dt">mgp =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb500-2"><a href="dv-plot.html#cb500-2"></a><span class="kw">plot</span>(x, y)</span>
<span id="cb500-3"><a href="dv-plot.html#cb500-3"></a><span class="co"># 又一个例子</span></span>
<span id="cb500-4"><a href="dv-plot.html#cb500-4"></a><span class="kw">par</span>(op)</span>
<span id="cb500-5"><a href="dv-plot.html#cb500-5"></a><span class="kw">plot</span>(x, y, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb500-6"><a href="dv-plot.html#cb500-6"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">95</span>, <span class="dv">30</span>), <span class="dt">tcl =</span> <span class="fl">0.4</span>, <span class="dt">lwd.ticks =</span> <span class="dv">3</span>, <span class="dt">mgp =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">0</span>))</span>
<span id="cb500-7"><a href="dv-plot.html#cb500-7"></a><span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">text =</span> <span class="st">&quot;X axis&quot;</span>, <span class="dt">line =</span> <span class="fl">1.5</span>) </span>
<span id="cb500-8"><a href="dv-plot.html#cb500-8"></a><span class="co"># mtext 设置坐标轴标签</span></span>
<span id="cb500-9"><a href="dv-plot.html#cb500-9"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">tcl =</span> <span class="fl">0.3</span>, <span class="dt">lwd.ticks =</span> <span class="dv">3</span>, <span class="dt">col.ticks =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">mgp =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb500-10"><a href="dv-plot.html#cb500-10"></a><span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">text =</span> <span class="st">&quot;Numbers taken randomly&quot;</span>, <span class="dt">line =</span> <span class="fl">2.2</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /><img src="dv-plot_files/figure-html/unnamed-chunk-16-2.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="base-title" class="section level3">
<h3><span class="header-section-number">11.1.6</span> 标题</h3>
<p>添加多个标题</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="dv-plot.html#cb501-1"></a>N &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb501-2"><a href="dv-plot.html#cb501-2"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(N, <span class="dv">-4</span>, <span class="dv">4</span>)</span>
<span id="cb501-3"><a href="dv-plot.html#cb501-3"></a>y &lt;-<span class="st"> </span><span class="kw">sin</span>(x) <span class="op">+</span><span class="st"> </span><span class="fl">.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(N)</span>
<span id="cb501-4"><a href="dv-plot.html#cb501-4"></a><span class="kw">plot</span>(x, y, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb501-5"><a href="dv-plot.html#cb501-5"></a><span class="kw">mtext</span>(<span class="st">&quot;Subtitle&quot;</span>, <span class="dv">3</span>, <span class="dt">line =</span> <span class="fl">.8</span>)</span>
<span id="cb501-6"><a href="dv-plot.html#cb501-6"></a><span class="kw">mtext</span>(<span class="st">&quot;Title&quot;</span>, <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb501-7"><a href="dv-plot.html#cb501-7"></a><span class="kw">mtext</span>(<span class="st">&quot;X axis&quot;</span>, <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb501-8"><a href="dv-plot.html#cb501-8"></a><span class="kw">mtext</span>(<span class="st">&quot;X axis subtitle&quot;</span>, <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">3.7</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-17"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-17-1.png" alt="图标题/子标题 x轴标题/子标题" width="70%" />
<p class="caption">
图 11.14: 图标题/子标题 x轴标题/子标题
</p>
</div>
</div>
<div id="base-annotation" class="section level3">
<h3><span class="header-section-number">11.1.7</span> 注释</h3>
<p>数学符号注释，图<a href="dv-plot.html#fig:math-annotation">11.15</a> 自定义坐标轴 <span class="citation">(Murrell and Ihaka <a href="#ref-Paul_2000_Approach" role="doc-biblioref">2000</a>)</span>。</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="dv-plot.html#cb502-1"></a><span class="co"># 自定义坐标轴</span></span>
<span id="cb502-2"><a href="dv-plot.html#cb502-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>), <span class="kw">c</span>(<span class="op">-</span>pi, pi),</span>
<span id="cb502-3"><a href="dv-plot.html#cb502-3"></a>  <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb502-4"><a href="dv-plot.html#cb502-4"></a>  <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">log =</span> <span class="st">&quot;x&quot;</span></span>
<span id="cb502-5"><a href="dv-plot.html#cb502-5"></a>)</span>
<span id="cb502-6"><a href="dv-plot.html#cb502-6"></a><span class="kw">axis</span>(<span class="dv">1</span>,</span>
<span id="cb502-7"><a href="dv-plot.html#cb502-7"></a>  <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1e2</span>, <span class="fl">1e4</span>, <span class="fl">1e6</span>),</span>
<span id="cb502-8"><a href="dv-plot.html#cb502-8"></a>  <span class="dt">labels =</span> <span class="kw">expression</span>(<span class="dv">1</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">4</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)</span>
<span id="cb502-9"><a href="dv-plot.html#cb502-9"></a>)</span>
<span id="cb502-10"><a href="dv-plot.html#cb502-10"></a><span class="kw">axis</span>(<span class="dv">2</span>,</span>
<span id="cb502-11"><a href="dv-plot.html#cb502-11"></a>  <span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span>pi, <span class="op">-</span>pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">0</span>, pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, pi),</span>
<span id="cb502-12"><a href="dv-plot.html#cb502-12"></a>  <span class="dt">labels =</span> <span class="kw">expression</span>(<span class="op">-</span>pi, <span class="op">-</span>pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">0</span>, pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, pi)</span>
<span id="cb502-13"><a href="dv-plot.html#cb502-13"></a>)</span>
<span id="cb502-14"><a href="dv-plot.html#cb502-14"></a><span class="kw">text</span>(<span class="fl">1e3</span>, <span class="dv">0</span>, <span class="kw">expression</span>(<span class="kw">italic</span>(<span class="st">&quot;Customized Axes&quot;</span>)))</span>
<span id="cb502-15"><a href="dv-plot.html#cb502-15"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:math-annotation"></span>
<img src="dv-plot_files/figure-html/math-annotation-1.png" alt="创建自定义的坐标轴和刻度标签" width="45%" />
<p class="caption">
图 11.15: 创建自定义的坐标轴和刻度标签
</p>
</div>
<p>在标题中添加数学公式</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="dv-plot.html#cb503-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">length =</span> <span class="dv">200</span>)</span>
<span id="cb503-2"><a href="dv-plot.html#cb503-2"></a>y &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb503-3"><a href="dv-plot.html#cb503-3"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb503-4"><a href="dv-plot.html#cb503-4"></a>  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb503-5"><a href="dv-plot.html#cb503-5"></a>  <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb503-6"><a href="dv-plot.html#cb503-6"></a>)</span>
<span id="cb503-7"><a href="dv-plot.html#cb503-7"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="kw">expression</span>(</span>
<span id="cb503-8"><a href="dv-plot.html#cb503-8"></a>  <span class="st">&quot;graph of the function f&quot;</span>(x) <span class="op">==</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb503-9"><a href="dv-plot.html#cb503-9"></a>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-18"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-18-1.png" alt="标题含有数学公式" width="45%" />
<p class="caption">
图 11.16: 标题含有数学公式
</p>
</div>
<p>修改参数使用 <code>substitute</code> 函数批量生成</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="dv-plot.html#cb504-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">length =</span> <span class="dv">200</span>)</span>
<span id="cb504-2"><a href="dv-plot.html#cb504-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) { <span class="co"># 画四个图</span></span>
<span id="cb504-3"><a href="dv-plot.html#cb504-3"></a>  y &lt;-<span class="st"> </span><span class="kw">sqrt</span>(i <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb504-4"><a href="dv-plot.html#cb504-4"></a>  <span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb504-5"><a href="dv-plot.html#cb504-5"></a>    <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb504-6"><a href="dv-plot.html#cb504-6"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb504-7"><a href="dv-plot.html#cb504-7"></a>    <span class="dt">ylab =</span> <span class="kw">substitute</span>(</span>
<span id="cb504-8"><a href="dv-plot.html#cb504-8"></a>      <span class="kw">expression</span>(<span class="kw">sqrt</span>(i <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)),</span>
<span id="cb504-9"><a href="dv-plot.html#cb504-9"></a>      <span class="kw">list</span>(<span class="dt">i =</span> i)</span>
<span id="cb504-10"><a href="dv-plot.html#cb504-10"></a>    )</span>
<span id="cb504-11"><a href="dv-plot.html#cb504-11"></a>  )</span>
<span id="cb504-12"><a href="dv-plot.html#cb504-12"></a>  <span class="kw">title</span>(<span class="dt">main =</span> <span class="kw">substitute</span>(</span>
<span id="cb504-13"><a href="dv-plot.html#cb504-13"></a>    <span class="st">&quot;graph of the function f&quot;</span>(x) <span class="op">==</span><span class="st"> </span><span class="kw">sqrt</span>(i <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb504-14"><a href="dv-plot.html#cb504-14"></a>    <span class="kw">list</span>(<span class="dt">i =</span> i)</span>
<span id="cb504-15"><a href="dv-plot.html#cb504-15"></a>  ))</span>
<span id="cb504-16"><a href="dv-plot.html#cb504-16"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-19"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-19-1.png" alt="批量生成函数图形" width="45%" /><img src="dv-plot_files/figure-html/unnamed-chunk-19-2.png" alt="批量生成函数图形" width="45%" /><img src="dv-plot_files/figure-html/unnamed-chunk-19-3.png" alt="批量生成函数图形" width="45%" /><img src="dv-plot_files/figure-html/unnamed-chunk-19-4.png" alt="批量生成函数图形" width="45%" />
<p class="caption">
图 11.17: 批量生成函数图形
</p>
</div>
<p>基础绘图函数，如 plot 标签 <code>xlab</code> 支持 Unicode 代码表示的希腊字母，常用字母表备查，公式环境下，也可以用在绘图中</p>
<table>
<caption><span id="tab:letters">表 11.1: </span> 希腊字母表</caption>
<thead>
<tr class="header">
<th align="left">希腊字母</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
<th align="left">希腊字母</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="left"><code>\alpha</code></td>
<td align="left"><code>\u03B1</code></td>
<td align="left"><span class="math inline">\(\mu\)</span></td>
<td align="left"><code>\mu</code></td>
<td align="left"><code>\u03BC</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta\)</span></td>
<td align="left"><code>\beta</code></td>
<td align="left"><code>\u03B2</code></td>
<td align="left"><span class="math inline">\(\nu\)</span></td>
<td align="left"><code>\nu</code></td>
<td align="left"><code>\u03BD</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\gamma\)</span></td>
<td align="left"><code>\gamma</code></td>
<td align="left"><code>\u03B3</code></td>
<td align="left"><span class="math inline">\(\xi\)</span></td>
<td align="left"><code>\xi</code></td>
<td align="left"><code>\u03BE</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\delta\)</span></td>
<td align="left"><code>\delta</code></td>
<td align="left"><code>\u03B4</code></td>
<td align="left"><span class="math inline">\(\varphi\)</span></td>
<td align="left"><code>\varphi</code></td>
<td align="left"><code>\u03C6</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\epsilon\)</span></td>
<td align="left"><code>\epsilon</code></td>
<td align="left"><code>\u03B5</code></td>
<td align="left"><span class="math inline">\(\pi\)</span></td>
<td align="left"><code>\pi</code></td>
<td align="left"><code>\u03C0</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\zeta\)</span></td>
<td align="left"><code>\zeta</code></td>
<td align="left"><code>\u03B6</code></td>
<td align="left"><span class="math inline">\(\rho\)</span></td>
<td align="left"><code>\rho</code></td>
<td align="left"><code>\u03C1</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\eta\)</span></td>
<td align="left"><code>\eta</code></td>
<td align="left"><code>\u03B7</code></td>
<td align="left"><span class="math inline">\(\upsilon\)</span></td>
<td align="left"><code>\upsilon</code></td>
<td align="left"><code>\u03C5</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\theta\)</span></td>
<td align="left"><code>\theta</code></td>
<td align="left"><code>\u03B8</code></td>
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="left"><code>\phi</code></td>
<td align="left"><code>\u03C6</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\iota\)</span></td>
<td align="left"><code>\iota</code></td>
<td align="left"><code>\u03B9</code></td>
<td align="left"><span class="math inline">\(\chi\)</span></td>
<td align="left"><code>\chi</code></td>
<td align="left"><code>\u03C7</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\kappa\)</span></td>
<td align="left"><code>\kappa</code></td>
<td align="left"><code>\u03BA</code></td>
<td align="left"><span class="math inline">\(\psi\)</span></td>
<td align="left"><code>\psi</code></td>
<td align="left"><code>\u03C8</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\lambda\)</span></td>
<td align="left"><code>\lambda</code></td>
<td align="left"><code>\u03BB</code></td>
<td align="left"><span class="math inline">\(\omega\)</span></td>
<td align="left"><code>\omega</code></td>
<td align="left"><code>\u03C9</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\sigma\)</span></td>
<td align="left"><code>\sigma</code></td>
<td align="left"><code>\u03C3</code></td>
<td align="left"><span class="math inline">\(\tau\)</span></td>
<td align="left"><code>\tau</code></td>
<td align="left"><code>\u03C4</code></td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:super-sub-script">表 11.2: </span> 数字上下标</caption>
<thead>
<tr class="header">
<th align="left">上标数字</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
<th align="left">下标数字</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\({}^0\)</span></td>
<td align="left"><code>{}^0</code></td>
<td align="left"><code>\u2070</code></td>
<td align="left"><span class="math inline">\({}_0\)</span></td>
<td align="left"><code>{}_0</code></td>
<td align="left"><code>\u2080</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^1\)</span></td>
<td align="left"><code>{}^1</code></td>
<td align="left"><code>\u00B9</code></td>
<td align="left"><span class="math inline">\({}_1\)</span></td>
<td align="left"><code>{}_1</code></td>
<td align="left"><code>\u2081</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^2\)</span></td>
<td align="left"><code>{}^2</code></td>
<td align="left"><code>\u00B2</code></td>
<td align="left"><span class="math inline">\({}_2\)</span></td>
<td align="left"><code>{}_2</code></td>
<td align="left"><code>\u2082</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^3\)</span></td>
<td align="left"><code>{}^3</code></td>
<td align="left"><code>\u00B2</code></td>
<td align="left"><span class="math inline">\({}_3\)</span></td>
<td align="left"><code>{}_3</code></td>
<td align="left"><code>\u2083</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^4\)</span></td>
<td align="left"><code>{}^4</code></td>
<td align="left"><code>\u2074</code></td>
<td align="left"><span class="math inline">\({}_4\)</span></td>
<td align="left"><code>{}_4</code></td>
<td align="left"><code>\u2084</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^5\)</span></td>
<td align="left"><code>{}^5</code></td>
<td align="left"><code>\u2075</code></td>
<td align="left"><span class="math inline">\({}_5\)</span></td>
<td align="left"><code>{}_5</code></td>
<td align="left"><code>\u2085</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^6\)</span></td>
<td align="left"><code>{}^6</code></td>
<td align="left"><code>\u2076</code></td>
<td align="left"><span class="math inline">\({}_6\)</span></td>
<td align="left"><code>{}_6</code></td>
<td align="left"><code>\u2086</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^7\)</span></td>
<td align="left"><code>{}^7</code></td>
<td align="left"><code>\u2077</code></td>
<td align="left"><span class="math inline">\({}_7\)</span></td>
<td align="left"><code>{}_7</code></td>
<td align="left"><code>\u2087</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^8\)</span></td>
<td align="left"><code>{}^8</code></td>
<td align="left"><code>\u2078</code></td>
<td align="left"><span class="math inline">\({}_8\)</span></td>
<td align="left"><code>{}_8</code></td>
<td align="left"><code>\u2088</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^9\)</span></td>
<td align="left"><code>{}^9</code></td>
<td align="left"><code>\u2079</code></td>
<td align="left"><span class="math inline">\({}_9\)</span></td>
<td align="left"><code>{}_9</code></td>
<td align="left"><code>\u2089</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^n\)</span></td>
<td align="left"><code>{}^n</code></td>
<td align="left"><code>\u207F</code></td>
<td align="left"><span class="math inline">\({}_n\)</span></td>
<td align="left"><code>{}_n</code></td>
<td align="left">-</td>
</tr>
</tbody>
</table>
<p>其它字母，请查看 <a href="https://www.ssec.wisc.edu/~tomw/java/unicode.html">Unicode 字母表</a></p>
</div>
<div id="base-legend" class="section level3">
<h3><span class="header-section-number">11.1.8</span> 图例</h3>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="dv-plot.html#cb505-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dt">length =</span> <span class="dv">200</span>)</span>
<span id="cb505-2"><a href="dv-plot.html#cb505-2"></a>y &lt;-<span class="st"> </span><span class="kw">sin</span>(x)</span>
<span id="cb505-3"><a href="dv-plot.html#cb505-3"></a>z &lt;-<span class="st"> </span><span class="kw">cos</span>(x)</span>
<span id="cb505-4"><a href="dv-plot.html#cb505-4"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb505-5"><a href="dv-plot.html#cb505-5"></a>  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,</span>
<span id="cb505-6"><a href="dv-plot.html#cb505-6"></a>  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;angle&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Trigonometric functions&quot;</span></span>
<span id="cb505-7"><a href="dv-plot.html#cb505-7"></a>)</span>
<span id="cb505-8"><a href="dv-plot.html#cb505-8"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb505-9"><a href="dv-plot.html#cb505-9"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb505-10"><a href="dv-plot.html#cb505-10"></a><span class="kw">lines</span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb505-11"><a href="dv-plot.html#cb505-11"></a><span class="kw">legend</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">-1</span>,</span>
<span id="cb505-12"><a href="dv-plot.html#cb505-12"></a>  <span class="dt">yjust =</span> <span class="dv">0</span>,</span>
<span id="cb505-13"><a href="dv-plot.html#cb505-13"></a>  <span class="kw">c</span>(<span class="st">&quot;Sine&quot;</span>, <span class="st">&quot;Cosine&quot;</span>),</span>
<span id="cb505-14"><a href="dv-plot.html#cb505-14"></a>  <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">par</span>(<span class="st">&quot;fg&quot;</span>), <span class="st">&quot;red&quot;</span>)</span>
<span id="cb505-15"><a href="dv-plot.html#cb505-15"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-20"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-20-1.png" alt="三角函数添加图例" width="70%" />
<p class="caption">
图 11.18: 三角函数添加图例
</p>
</div>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="dv-plot.html#cb506-1"></a>xmin &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">1</span>]</span>
<span id="cb506-2"><a href="dv-plot.html#cb506-2"></a>xmax &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">2</span>]</span>
<span id="cb506-3"><a href="dv-plot.html#cb506-3"></a>ymin &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>]</span>
<span id="cb506-4"><a href="dv-plot.html#cb506-4"></a>ymax &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>]</span>
<span id="cb506-5"><a href="dv-plot.html#cb506-5"></a></span>
<span id="cb506-6"><a href="dv-plot.html#cb506-6"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb506-7"><a href="dv-plot.html#cb506-7"></a>  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,</span>
<span id="cb506-8"><a href="dv-plot.html#cb506-8"></a>  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;angle&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Trigonometric functions&quot;</span></span>
<span id="cb506-9"><a href="dv-plot.html#cb506-9"></a>)</span>
<span id="cb506-10"><a href="dv-plot.html#cb506-10"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb506-11"><a href="dv-plot.html#cb506-11"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb506-12"><a href="dv-plot.html#cb506-12"></a><span class="kw">lines</span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb506-13"><a href="dv-plot.html#cb506-13"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb506-14"><a href="dv-plot.html#cb506-14"></a>  <span class="kw">c</span>(<span class="st">&quot;Sine&quot;</span>, <span class="st">&quot;Cosine&quot;</span>),</span>
<span id="cb506-15"><a href="dv-plot.html#cb506-15"></a>  <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">par</span>(<span class="st">&quot;fg&quot;</span>), <span class="st">&quot;red&quot;</span>)</span>
<span id="cb506-16"><a href="dv-plot.html#cb506-16"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-21"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-21-1.png" alt="设置图例的位置" width="70%" />
<p class="caption">
图 11.19: 设置图例的位置
</p>
</div>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="dv-plot.html#cb507-1"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb507-2"><a href="dv-plot.html#cb507-2"></a>  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,</span>
<span id="cb507-3"><a href="dv-plot.html#cb507-3"></a>  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;angle&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Trigonometric functions&quot;</span></span>
<span id="cb507-4"><a href="dv-plot.html#cb507-4"></a>)</span>
<span id="cb507-5"><a href="dv-plot.html#cb507-5"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb507-6"><a href="dv-plot.html#cb507-6"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb507-7"><a href="dv-plot.html#cb507-7"></a><span class="kw">lines</span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb507-8"><a href="dv-plot.html#cb507-8"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb507-9"><a href="dv-plot.html#cb507-9"></a>  <span class="kw">c</span>(<span class="st">&quot;Sine&quot;</span>, <span class="st">&quot;Cosine&quot;</span>),</span>
<span id="cb507-10"><a href="dv-plot.html#cb507-10"></a>  <span class="dt">inset =</span> <span class="kw">c</span>(.<span class="dv">03</span>, <span class="fl">.03</span>),</span>
<span id="cb507-11"><a href="dv-plot.html#cb507-11"></a>  <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">par</span>(<span class="st">&quot;fg&quot;</span>), <span class="st">&quot;red&quot;</span>)</span>
<span id="cb507-12"><a href="dv-plot.html#cb507-12"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-22"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-22-1.png" alt="insert 函数微调图例位置" width="70%" />
<p class="caption">
图 11.20: insert 函数微调图例位置
</p>
</div>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="dv-plot.html#cb508-1"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)</span>
<span id="cb508-2"><a href="dv-plot.html#cb508-2"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb508-3"><a href="dv-plot.html#cb508-3"></a>  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,</span>
<span id="cb508-4"><a href="dv-plot.html#cb508-4"></a>  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;angle&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Trigonometric functions&quot;</span></span>
<span id="cb508-5"><a href="dv-plot.html#cb508-5"></a>)</span>
<span id="cb508-6"><a href="dv-plot.html#cb508-6"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb508-7"><a href="dv-plot.html#cb508-7"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb508-8"><a href="dv-plot.html#cb508-8"></a><span class="kw">lines</span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb508-9"><a href="dv-plot.html#cb508-9"></a><span class="kw">par</span>(<span class="dt">xpd =</span> <span class="ot">TRUE</span>) <span class="co"># Do not clip to the drawing area 关键一行/允许出界</span></span>
<span id="cb508-10"><a href="dv-plot.html#cb508-10"></a>lambda &lt;-<span class="st"> </span><span class="fl">.025</span></span>
<span id="cb508-11"><a href="dv-plot.html#cb508-11"></a><span class="kw">legend</span>(<span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">1</span>],</span>
<span id="cb508-12"><a href="dv-plot.html#cb508-12"></a>  (<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>lambda) <span class="op">*</span><span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>] <span class="op">-</span><span class="st"> </span>lambda <span class="op">*</span><span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>],</span>
<span id="cb508-13"><a href="dv-plot.html#cb508-13"></a>  <span class="kw">c</span>(<span class="st">&quot;Sine&quot;</span>, <span class="st">&quot;Cosine&quot;</span>),</span>
<span id="cb508-14"><a href="dv-plot.html#cb508-14"></a>  <span class="dt">xjust =</span> <span class="dv">0</span>, <span class="dt">yjust =</span> <span class="dv">0</span>,</span>
<span id="cb508-15"><a href="dv-plot.html#cb508-15"></a>  <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">par</span>(<span class="st">&quot;fg&quot;</span>), <span class="st">&quot;red&quot;</span>)</span>
<span id="cb508-16"><a href="dv-plot.html#cb508-16"></a>)</span>
<span id="cb508-17"><a href="dv-plot.html#cb508-17"></a><span class="kw">par</span>(op)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-23"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-23-1.png" alt="将图例放在绘图区域外面" width="70%" />
<p class="caption">
图 11.21: 将图例放在绘图区域外面
</p>
</div>
<p>Hmisc 包的 labcurve 函数可以在曲线上放置名称，而不是遥远的图例上</p>
</div>
<div id="base-par" class="section level3">
<h3><span class="header-section-number">11.1.9</span> 边空</h3>
<p>边空分为内边空和外边空</p>
<div class="figure" style="text-align: center"><span id="fig:par-mai-oma"></span>
<img src="/home/travis/R-bin/lib/R/library/graphics/help/figures/mai.png" alt="边空" width="35%" /><img src="/home/travis/R-bin/lib/R/library/graphics/help/figures/oma.png" alt="边空" width="35%" />
<p class="caption">
图 11.22: 边空
</p>
</div>
<p><code>line</code> 第一行</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="dv-plot.html#cb509-1"></a>N &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb509-2"><a href="dv-plot.html#cb509-2"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(N, <span class="dv">-4</span>, <span class="dv">4</span>)</span>
<span id="cb509-3"><a href="dv-plot.html#cb509-3"></a>y &lt;-<span class="st"> </span><span class="kw">sin</span>(x) <span class="op">+</span><span class="st"> </span><span class="fl">.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(N)</span>
<span id="cb509-4"><a href="dv-plot.html#cb509-4"></a><span class="kw">plot</span>(x, y,</span>
<span id="cb509-5"><a href="dv-plot.html#cb509-5"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb509-6"><a href="dv-plot.html#cb509-6"></a>  <span class="dt">main =</span> <span class="kw">paste</span>(</span>
<span id="cb509-7"><a href="dv-plot.html#cb509-7"></a>    <span class="st">&quot;The </span><span class="ch">\&quot;</span><span class="st">mtext</span><span class="ch">\&quot;</span><span class="st"> function&quot;</span>,</span>
<span id="cb509-8"><a href="dv-plot.html#cb509-8"></a>    <span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&quot; &quot;</span>, <span class="dv">60</span>), <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb509-9"><a href="dv-plot.html#cb509-9"></a>  )</span>
<span id="cb509-10"><a href="dv-plot.html#cb509-10"></a>)</span>
<span id="cb509-11"><a href="dv-plot.html#cb509-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="dv">1</span>)) {</span>
<span id="cb509-12"><a href="dv-plot.html#cb509-12"></a>  <span class="kw">mtext</span>(<span class="kw">paste</span>(<span class="st">&quot;Line&quot;</span>, i), <span class="dv">3</span>, <span class="dt">line =</span> i)</span>
<span id="cb509-13"><a href="dv-plot.html#cb509-13"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-24"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-24-1.png" alt="外边空在图的边缘添加文字" width="70%" />
<p class="caption">
图 11.23: 外边空在图的边缘添加文字
</p>
</div>
<p><code>par</code></p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="dv-plot.html#cb510-1"></a><span class="co"># 多图排列/分屏 page 47</span></span>
<span id="cb510-2"><a href="dv-plot.html#cb510-2"></a><span class="co"># 最常用的是 par mfrow mfcol分别按行/列放置图形</span></span>
<span id="cb510-3"><a href="dv-plot.html#cb510-3"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(</span>
<span id="cb510-4"><a href="dv-plot.html#cb510-4"></a>  <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb510-5"><a href="dv-plot.html#cb510-5"></a>  <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>) <span class="co"># Outer margins</span></span>
<span id="cb510-6"><a href="dv-plot.html#cb510-6"></a>)</span>
<span id="cb510-7"><a href="dv-plot.html#cb510-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb510-8"><a href="dv-plot.html#cb510-8"></a>  <span class="kw">plot</span>(<span class="kw">runif</span>(<span class="dv">20</span>), <span class="kw">runif</span>(<span class="dv">20</span>),</span>
<span id="cb510-9"><a href="dv-plot.html#cb510-9"></a>    <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;random plot (&quot;</span>, i, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb510-10"><a href="dv-plot.html#cb510-10"></a>  )</span>
<span id="cb510-11"><a href="dv-plot.html#cb510-11"></a>}</span>
<span id="cb510-12"><a href="dv-plot.html#cb510-12"></a><span class="kw">par</span>(op)</span>
<span id="cb510-13"><a href="dv-plot.html#cb510-13"></a><span class="kw">mtext</span>(<span class="st">&quot;Four plots, without enough room for this title&quot;</span>,</span>
<span id="cb510-14"><a href="dv-plot.html#cb510-14"></a>  <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">font =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb510-15"><a href="dv-plot.html#cb510-15"></a>) <span class="co"># 总/大标题放不下</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-25"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-25-1.png" alt="多图排列共享一个大标题" width="70%" />
<p class="caption">
图 11.24: 多图排列共享一个大标题
</p>
</div>
<p><code>par</code> 的 oma 用来设置外边空的大小，默认情形下没有外边空的</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="dv-plot.html#cb511-1"></a><span class="kw">par</span>()<span class="op">$</span>oma</span>
<span id="cb511-2"><a href="dv-plot.html#cb511-2"></a><span class="co">#&gt; [1] 0 0 0 0</span></span></code></pre></div>
<p>我们可以自己设置外边空</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="dv-plot.html#cb512-1"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(</span>
<span id="cb512-2"><a href="dv-plot.html#cb512-2"></a>  <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb512-3"><a href="dv-plot.html#cb512-3"></a>  <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>) <span class="co"># Outer margins</span></span>
<span id="cb512-4"><a href="dv-plot.html#cb512-4"></a>)</span>
<span id="cb512-5"><a href="dv-plot.html#cb512-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb512-6"><a href="dv-plot.html#cb512-6"></a>  <span class="kw">plot</span>(<span class="kw">runif</span>(<span class="dv">20</span>), <span class="kw">runif</span>(<span class="dv">20</span>),</span>
<span id="cb512-7"><a href="dv-plot.html#cb512-7"></a>    <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;random plot (&quot;</span>, i, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb512-8"><a href="dv-plot.html#cb512-8"></a>  )</span>
<span id="cb512-9"><a href="dv-plot.html#cb512-9"></a>}</span>
<span id="cb512-10"><a href="dv-plot.html#cb512-10"></a><span class="kw">par</span>(op)</span>
<span id="cb512-11"><a href="dv-plot.html#cb512-11"></a><span class="kw">mtext</span>(<span class="st">&quot;Four plots, with some room for this title&quot;</span>,</span>
<span id="cb512-12"><a href="dv-plot.html#cb512-12"></a>  <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="fl">1.5</span>, <span class="dt">font =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb512-13"><a href="dv-plot.html#cb512-13"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-27"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-27-1.png" alt="设置外边空放置大标题" width="70%" />
<p class="caption">
图 11.25: 设置外边空放置大标题
</p>
</div>
<p>除了内边空还有外边空，内外边空用来放注释说明</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="dv-plot.html#cb513-1"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)</span>
<span id="cb513-2"><a href="dv-plot.html#cb513-2"></a><span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb513-3"><a href="dv-plot.html#cb513-3"></a><span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb513-4"><a href="dv-plot.html#cb513-4"></a><span class="cf">for</span> (side <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb513-5"><a href="dv-plot.html#cb513-5"></a>  inner &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">par</span>()<span class="op">$</span>mar[side], <span class="dv">0</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb513-6"><a href="dv-plot.html#cb513-6"></a>  <span class="cf">for</span> (line <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>inner) {</span>
<span id="cb513-7"><a href="dv-plot.html#cb513-7"></a>    <span class="kw">mtext</span>(<span class="dt">text =</span> <span class="kw">paste0</span>(<span class="st">&quot;Inner line &quot;</span>, line), <span class="dt">side =</span> side, <span class="dt">line =</span> line)</span>
<span id="cb513-8"><a href="dv-plot.html#cb513-8"></a>  }</span>
<span id="cb513-9"><a href="dv-plot.html#cb513-9"></a>  outer &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">par</span>()<span class="op">$</span>oma[side], <span class="dv">0</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb513-10"><a href="dv-plot.html#cb513-10"></a>  <span class="cf">for</span> (line <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>inner) {</span>
<span id="cb513-11"><a href="dv-plot.html#cb513-11"></a>    <span class="kw">mtext</span>(<span class="dt">text =</span> <span class="kw">paste0</span>(<span class="st">&quot;Outer line &quot;</span>, line), <span class="dt">side =</span> side, <span class="dt">line =</span> line, <span class="dt">outer =</span> <span class="ot">TRUE</span>)</span>
<span id="cb513-12"><a href="dv-plot.html#cb513-12"></a>  }</span>
<span id="cb513-13"><a href="dv-plot.html#cb513-13"></a>}</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-28-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>外边空可以用来放图例</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="dv-plot.html#cb514-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb514-2"><a href="dv-plot.html#cb514-2"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</span>
<span id="cb514-3"><a href="dv-plot.html#cb514-3"></a>y &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</span>
<span id="cb514-4"><a href="dv-plot.html#cb514-4"></a>cols &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">hcl.colors</span>(<span class="dv">5</span>), <span class="dt">each =</span> <span class="dv">2</span>)</span>
<span id="cb514-5"><a href="dv-plot.html#cb514-5"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>), <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">pch =</span> <span class="dv">16</span>)</span>
<span id="cb514-6"><a href="dv-plot.html#cb514-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb514-7"><a href="dv-plot.html#cb514-7"></a>  <span class="kw">plot</span>(x, y, <span class="dt">col =</span> cols, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb514-8"><a href="dv-plot.html#cb514-8"></a>}</span>
<span id="cb514-9"><a href="dv-plot.html#cb514-9"></a><span class="kw">mtext</span>(<span class="dt">text =</span> <span class="st">&quot;A common x-axis label&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>)</span>
<span id="cb514-10"><a href="dv-plot.html#cb514-10"></a><span class="kw">mtext</span>(<span class="dt">text =</span> <span class="st">&quot;A common y-axis label&quot;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>)</span>
<span id="cb514-11"><a href="dv-plot.html#cb514-11"></a><span class="kw">legend</span>(</span>
<span id="cb514-12"><a href="dv-plot.html#cb514-12"></a>  <span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="fl">1.2</span>, <span class="dt">legend =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],</span>
<span id="cb514-13"><a href="dv-plot.html#cb514-13"></a>  <span class="dt">col =</span> <span class="kw">unique</span>(cols), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xpd =</span> <span class="ot">NA</span></span>
<span id="cb514-14"><a href="dv-plot.html#cb514-14"></a>)</span>
<span id="cb514-15"><a href="dv-plot.html#cb514-15"></a><span class="kw">par</span>(op)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>坐标轴标签 <code>xlab</code> 和 <code>ylab</code> 的内容很长的时候需要内边空</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="dv-plot.html#cb515-1"></a><span class="kw">par</span>(<span class="dt">cex.lab =</span> <span class="fl">1.7</span>)</span>
<span id="cb515-2"><a href="dv-plot.html#cb515-2"></a><span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb515-3"><a href="dv-plot.html#cb515-3"></a>  <span class="dt">ylab =</span> <span class="st">&quot;A very very long axis title</span><span class="ch">\n</span><span class="st">that need special care&quot;</span>,</span>
<span id="cb515-4"><a href="dv-plot.html#cb515-4"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb515-5"><a href="dv-plot.html#cb515-5"></a>)</span>
<span id="cb515-6"><a href="dv-plot.html#cb515-6"></a></span>
<span id="cb515-7"><a href="dv-plot.html#cb515-7"></a><span class="co"># 增加内边空的大小</span></span>
<span id="cb515-8"><a href="dv-plot.html#cb515-8"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb515-9"><a href="dv-plot.html#cb515-9"></a><span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb515-10"><a href="dv-plot.html#cb515-10"></a>  <span class="dt">ylab =</span> <span class="st">&quot;A very very long axis title</span><span class="ch">\n</span><span class="st">that need special care&quot;</span>,</span>
<span id="cb515-11"><a href="dv-plot.html#cb515-11"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb515-12"><a href="dv-plot.html#cb515-12"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>有时候，仅仅增加内边空还不够，坐标轴标签内容甚至可以出现在绘图区域外面，设置 <code>outer = TRUE</code></p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="dv-plot.html#cb516-1"></a><span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb516-2"><a href="dv-plot.html#cb516-2"></a><span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb516-3"><a href="dv-plot.html#cb516-3"></a><span class="kw">mtext</span>(</span>
<span id="cb516-4"><a href="dv-plot.html#cb516-4"></a>  <span class="dt">text =</span> <span class="st">&quot;A very very long axis title</span><span class="ch">\n</span><span class="st">that need special care&quot;</span>,</span>
<span id="cb516-5"><a href="dv-plot.html#cb516-5"></a>  <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">0</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.7</span></span>
<span id="cb516-6"><a href="dv-plot.html#cb516-6"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-31-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="dv-plot.html#cb517-1"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(</span>
<span id="cb517-2"><a href="dv-plot.html#cb517-2"></a>  <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb517-3"><a href="dv-plot.html#cb517-3"></a>  <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>),</span>
<span id="cb517-4"><a href="dv-plot.html#cb517-4"></a>  <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.1</span> <span class="co"># Margins</span></span>
<span id="cb517-5"><a href="dv-plot.html#cb517-5"></a>)</span>
<span id="cb517-6"><a href="dv-plot.html#cb517-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb517-7"><a href="dv-plot.html#cb517-7"></a>  <span class="kw">plot</span>(<span class="kw">runif</span>(<span class="dv">20</span>), <span class="kw">runif</span>(<span class="dv">20</span>),</span>
<span id="cb517-8"><a href="dv-plot.html#cb517-8"></a>    <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb517-9"><a href="dv-plot.html#cb517-9"></a>    <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;random plot (&quot;</span>, i, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb517-10"><a href="dv-plot.html#cb517-10"></a>  )</span>
<span id="cb517-11"><a href="dv-plot.html#cb517-11"></a>}</span>
<span id="cb517-12"><a href="dv-plot.html#cb517-12"></a><span class="kw">par</span>(op)</span>
<span id="cb517-13"><a href="dv-plot.html#cb517-13"></a><span class="kw">mtext</span>(<span class="st">&quot;Title&quot;</span>,</span>
<span id="cb517-14"><a href="dv-plot.html#cb517-14"></a>  <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="fl">1.5</span>, <span class="dt">font =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb517-15"><a href="dv-plot.html#cb517-15"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-32"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-32-1.png" alt="设置每个子图的边空 mar" width="70%" />
<p class="caption">
图 11.26: 设置每个子图的边空 mar
</p>
</div>
</div>
<div id="base-layer" class="section level3">
<h3><span class="header-section-number">11.1.10</span> 图层</h3>
<p>覆盖图形 <code>add = T</code> or <code>par(new=TRUE)</code></p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="dv-plot.html#cb518-1"></a><span class="kw">plot</span>(<span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>),</span>
<span id="cb518-2"><a href="dv-plot.html#cb518-2"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb518-3"><a href="dv-plot.html#cb518-3"></a>)</span>
<span id="cb518-4"><a href="dv-plot.html#cb518-4"></a><span class="kw">points</span>(<span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>),</span>
<span id="cb518-5"><a href="dv-plot.html#cb518-5"></a>  <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">3</span></span>
<span id="cb518-6"><a href="dv-plot.html#cb518-6"></a>)</span>
<span id="cb518-7"><a href="dv-plot.html#cb518-7"></a><span class="kw">lines</span>(<span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb518-8"><a href="dv-plot.html#cb518-8"></a><span class="kw">segments</span>(<span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>),</span>
<span id="cb518-9"><a href="dv-plot.html#cb518-9"></a>  <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb518-10"><a href="dv-plot.html#cb518-10"></a>)</span>
<span id="cb518-11"><a href="dv-plot.html#cb518-11"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Overlaying points, segments, lines...&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-33"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-33-1.png" alt="添加图层" width="70%" />
<p class="caption">
图 11.27: 添加图层
</p>
</div>
</div>
<div id="base-layout" class="section level3">
<h3><span class="header-section-number">11.1.11</span> 布局</h3>
<p><code>layout</code> 函数布局， 绘制复杂组合图形</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="dv-plot.html#cb519-1"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>))</span>
<span id="cb519-2"><a href="dv-plot.html#cb519-2"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(</span>
<span id="cb519-3"><a href="dv-plot.html#cb519-3"></a>  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb519-4"><a href="dv-plot.html#cb519-4"></a>  <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>,</span>
<span id="cb519-5"><a href="dv-plot.html#cb519-5"></a>  <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span></span>
<span id="cb519-6"><a href="dv-plot.html#cb519-6"></a>), <span class="dt">nr =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))</span>
<span id="cb519-7"><a href="dv-plot.html#cb519-7"></a><span class="kw">hist</span>(<span class="kw">rnorm</span>(n), <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb519-8"><a href="dv-plot.html#cb519-8"></a><span class="kw">hist</span>(<span class="kw">rnorm</span>(n), <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb519-9"><a href="dv-plot.html#cb519-9"></a><span class="kw">hist</span>(<span class="kw">rnorm</span>(n), <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb519-10"><a href="dv-plot.html#cb519-10"></a><span class="kw">hist</span>(<span class="kw">rnorm</span>(n), <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>)</span>
<span id="cb519-11"><a href="dv-plot.html#cb519-11"></a><span class="kw">mtext</span>(<span class="st">&quot;The </span><span class="ch">\&quot;</span><span class="st">layout</span><span class="ch">\&quot;</span><span class="st"> function&quot;</span>,</span>
<span id="cb519-12"><a href="dv-plot.html#cb519-12"></a>  <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>,</span>
<span id="cb519-13"><a href="dv-plot.html#cb519-13"></a>  <span class="dt">font =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">1.2</span></span>
<span id="cb519-14"><a href="dv-plot.html#cb519-14"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-34"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-34-1.png" alt="更加复杂的组合图形" width="70%" />
<p class="caption">
图 11.28: 更加复杂的组合图形
</p>
</div>
</div>
<div id="base-combine" class="section level3">
<h3><span class="header-section-number">11.1.12</span> 组合</h3>
<p><code>par</code> 之 <code>fig</code> 参数很神奇，使得多个图可以叠加在一起，它接受一个数值向量<code>c(x1, x2, y1, y2)</code> ，是图形设备显示区域中的绘图区域的(NDC, normalized device coordinates)坐标。</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="dv-plot.html#cb520-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,</span>
<span id="cb520-2"><a href="dv-plot.html#cb520-2"></a>  <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&#39;fg&#39; : axes, ticks and box in gray&quot;</span>,</span>
<span id="cb520-3"><a href="dv-plot.html#cb520-3"></a>  <span class="dt">fg =</span> <span class="kw">gray</span>(<span class="fl">0.7</span>), <span class="dt">bty =</span> <span class="st">&quot;7&quot;</span>, <span class="dt">sub =</span> R.version.string</span>
<span id="cb520-4"><a href="dv-plot.html#cb520-4"></a>)</span>
<span id="cb520-5"><a href="dv-plot.html#cb520-5"></a><span class="kw">par</span>(<span class="dt">fig =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">10</span>) <span class="op">/</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">new =</span> T)</span>
<span id="cb520-6"><a href="dv-plot.html#cb520-6"></a><span class="kw">plot</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">10</span>,</span>
<span id="cb520-7"><a href="dv-plot.html#cb520-7"></a>  <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb520-8"><a href="dv-plot.html#cb520-8"></a>  <span class="dt">fg =</span> <span class="kw">gray</span>(<span class="fl">0.7</span>), <span class="dt">bty =</span> <span class="st">&quot;7&quot;</span>, <span class="dt">xlab =</span> R.version.string</span>
<span id="cb520-9"><a href="dv-plot.html#cb520-9"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-35"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-35-1.png" alt="多图叠加" width="70%" />
<p class="caption">
图 11.29: 多图叠加
</p>
</div>
<p><code>fig</code> 参数控制图形的位置，用来绘制组合图形</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="dv-plot.html#cb521-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb521-2"><a href="dv-plot.html#cb521-2"></a>x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, <span class="dt">df =</span> <span class="dv">10</span>)</span>
<span id="cb521-3"><a href="dv-plot.html#cb521-3"></a><span class="kw">hist</span>(x,</span>
<span id="cb521-4"><a href="dv-plot.html#cb521-4"></a>  <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>,</span>
<span id="cb521-5"><a href="dv-plot.html#cb521-5"></a>  <span class="dt">probability =</span> <span class="st">&quot;TRUE&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb521-6"><a href="dv-plot.html#cb521-6"></a>  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span> <span class="op">*</span><span class="st"> </span><span class="kw">max</span>(<span class="kw">density</span>(x)<span class="op">$</span>y))</span>
<span id="cb521-7"><a href="dv-plot.html#cb521-7"></a>)</span>
<span id="cb521-8"><a href="dv-plot.html#cb521-8"></a><span class="kw">lines</span>(<span class="kw">density</span>(x),</span>
<span id="cb521-9"><a href="dv-plot.html#cb521-9"></a>  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb521-10"><a href="dv-plot.html#cb521-10"></a>  <span class="dt">lwd =</span> <span class="dv">3</span></span>
<span id="cb521-11"><a href="dv-plot.html#cb521-11"></a>)</span>
<span id="cb521-12"><a href="dv-plot.html#cb521-12"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(</span>
<span id="cb521-13"><a href="dv-plot.html#cb521-13"></a>  <span class="dt">fig =</span> <span class="kw">c</span>(.<span class="dv">02</span>, <span class="fl">.4</span>, <span class="fl">.5</span>, <span class="fl">.98</span>),</span>
<span id="cb521-14"><a href="dv-plot.html#cb521-14"></a>  <span class="dt">new =</span> <span class="ot">TRUE</span></span>
<span id="cb521-15"><a href="dv-plot.html#cb521-15"></a>)</span>
<span id="cb521-16"><a href="dv-plot.html#cb521-16"></a><span class="kw">qqnorm</span>(x,</span>
<span id="cb521-17"><a href="dv-plot.html#cb521-17"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb521-18"><a href="dv-plot.html#cb521-18"></a>  <span class="dt">axes =</span> <span class="ot">FALSE</span></span>
<span id="cb521-19"><a href="dv-plot.html#cb521-19"></a>)</span>
<span id="cb521-20"><a href="dv-plot.html#cb521-20"></a><span class="kw">qqline</span>(x, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb521-21"><a href="dv-plot.html#cb521-21"></a><span class="kw">box</span>(<span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb521-22"><a href="dv-plot.html#cb521-22"></a><span class="kw">par</span>(op)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-36"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-36-1.png" alt="组合图形" width="70%" />
<p class="caption">
图 11.30: 组合图形
</p>
</div>
</div>
<div id="base-screen" class="section level3">
<h3><span class="header-section-number">11.1.13</span> 分屏</h3>
<p><code>split.screen</code> 分屏组合</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="dv-plot.html#cb522-1"></a>random.plot &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb522-2"><a href="dv-plot.html#cb522-2"></a>  N &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb522-3"><a href="dv-plot.html#cb522-3"></a>  f &lt;-<span class="st"> </span><span class="kw">sample</span>(</span>
<span id="cb522-4"><a href="dv-plot.html#cb522-4"></a>    <span class="kw">list</span>(</span>
<span id="cb522-5"><a href="dv-plot.html#cb522-5"></a>      rnorm,</span>
<span id="cb522-6"><a href="dv-plot.html#cb522-6"></a>      <span class="cf">function</span>(x) {</span>
<span id="cb522-7"><a href="dv-plot.html#cb522-7"></a>        <span class="kw">rt</span>(x, <span class="dt">df =</span> <span class="dv">2</span>)</span>
<span id="cb522-8"><a href="dv-plot.html#cb522-8"></a>      },</span>
<span id="cb522-9"><a href="dv-plot.html#cb522-9"></a>      rlnorm,</span>
<span id="cb522-10"><a href="dv-plot.html#cb522-10"></a>      runif</span>
<span id="cb522-11"><a href="dv-plot.html#cb522-11"></a>    ),</span>
<span id="cb522-12"><a href="dv-plot.html#cb522-12"></a>    <span class="dv">1</span></span>
<span id="cb522-13"><a href="dv-plot.html#cb522-13"></a>  ) [[<span class="dv">1</span>]]</span>
<span id="cb522-14"><a href="dv-plot.html#cb522-14"></a>  x &lt;-<span class="st"> </span><span class="kw">f</span>(N)</span>
<span id="cb522-15"><a href="dv-plot.html#cb522-15"></a>  <span class="kw">hist</span>(x, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">axes =</span> F)</span>
<span id="cb522-16"><a href="dv-plot.html#cb522-16"></a>  <span class="kw">axis</span>(<span class="dv">1</span>)</span>
<span id="cb522-17"><a href="dv-plot.html#cb522-17"></a>}</span>
<span id="cb522-18"><a href="dv-plot.html#cb522-18"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb522-19"><a href="dv-plot.html#cb522-19"></a><span class="kw">split.screen</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb522-20"><a href="dv-plot.html#cb522-20"></a><span class="co">#&gt; [1] 1 2</span></span>
<span id="cb522-21"><a href="dv-plot.html#cb522-21"></a><span class="kw">split.screen</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">screen =</span> <span class="dv">2</span>)</span>
<span id="cb522-22"><a href="dv-plot.html#cb522-22"></a><span class="co">#&gt; [1] 3 4 5</span></span>
<span id="cb522-23"><a href="dv-plot.html#cb522-23"></a><span class="kw">screen</span>(<span class="dv">1</span>)</span>
<span id="cb522-24"><a href="dv-plot.html#cb522-24"></a><span class="kw">random.plot</span>()</span>
<span id="cb522-25"><a href="dv-plot.html#cb522-25"></a><span class="co"># screen(2); random.plot() # Screen 2 was split into three screens: 3, 4, 5</span></span>
<span id="cb522-26"><a href="dv-plot.html#cb522-26"></a><span class="kw">screen</span>(<span class="dv">3</span>)</span>
<span id="cb522-27"><a href="dv-plot.html#cb522-27"></a><span class="kw">random.plot</span>()</span>
<span id="cb522-28"><a href="dv-plot.html#cb522-28"></a><span class="kw">screen</span>(<span class="dv">4</span>)</span>
<span id="cb522-29"><a href="dv-plot.html#cb522-29"></a><span class="kw">random.plot</span>()</span>
<span id="cb522-30"><a href="dv-plot.html#cb522-30"></a><span class="kw">screen</span>(<span class="dv">5</span>)</span>
<span id="cb522-31"><a href="dv-plot.html#cb522-31"></a><span class="kw">random.plot</span>()</span>
<span id="cb522-32"><a href="dv-plot.html#cb522-32"></a><span class="kw">close.screen</span>(<span class="dt">all =</span> <span class="ot">TRUE</span>)</span>
<span id="cb522-33"><a href="dv-plot.html#cb522-33"></a><span class="kw">par</span>(op)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-37"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-37-1.png" alt="分屏" width="70%" />
<p class="caption">
图 11.31: 分屏
</p>
</div>
</div>
<div id="identify-locator" class="section level3">
<h3><span class="header-section-number">11.1.14</span> 交互</h3>
<p>辅助绘图 identify locator</p>
</div>
</div>
<div id="plot-gallary" class="section level2">
<h2><span class="header-section-number">11.2</span> 统计图形</h2>
<p>按图的类型划分，最后在小结部分给出各图适用的数据类型</p>
<p>根据数据类型划分： 对于一元数据，可用什么图来描述；多元数据呢，连续数据和离散数据（分类数据）</p>
<p>先找一个不重不漏的划分，指导原则是根据数据类型选择图，根据探索到的数据中的规律，选择图</p>
<p>其它 assocplot fourfoldplot sunflowerplot</p>
<div id="plot-bar" class="section level3">
<h3><span class="header-section-number">11.2.1</span> 条形图</h3>
<p><a href="https://rpubs.com/chidungkt/392980">条形图</a></p>
<p>简单条形图</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="dv-plot.html#cb523-1"></a><span class="kw">data</span>(diamonds, <span class="dt">package =</span> <span class="st">&quot;ggplot2&quot;</span>) <span class="co"># 加载数据</span></span>
<span id="cb523-2"><a href="dv-plot.html#cb523-2"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb523-3"><a href="dv-plot.html#cb523-3"></a>barCenters &lt;-<span class="st"> </span><span class="kw">barplot</span>(<span class="kw">table</span>(diamonds<span class="op">$</span>cut),</span>
<span id="cb523-4"><a href="dv-plot.html#cb523-4"></a>  <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>,</span>
<span id="cb523-5"><a href="dv-plot.html#cb523-5"></a>  <span class="dt">axisnames =</span> <span class="ot">FALSE</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb523-6"><a href="dv-plot.html#cb523-6"></a>)</span>
<span id="cb523-7"><a href="dv-plot.html#cb523-7"></a><span class="kw">text</span>(</span>
<span id="cb523-8"><a href="dv-plot.html#cb523-8"></a>  <span class="dt">y =</span> barCenters, <span class="dt">x =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>],</span>
<span id="cb523-9"><a href="dv-plot.html#cb523-9"></a>  <span class="dt">adj =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="kw">names</span>(<span class="kw">table</span>(diamonds<span class="op">$</span>cut)), <span class="dt">xpd =</span> <span class="ot">TRUE</span></span>
<span id="cb523-10"><a href="dv-plot.html#cb523-10"></a>)</span>
<span id="cb523-11"><a href="dv-plot.html#cb523-11"></a><span class="kw">axis</span>(<span class="dv">1</span>,</span>
<span id="cb523-12"><a href="dv-plot.html#cb523-12"></a>  <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">25000</span>, <span class="dt">by =</span> <span class="dv">5000</span>), <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">25000</span>, <span class="dt">by =</span> <span class="dv">5000</span>),</span>
<span id="cb523-13"><a href="dv-plot.html#cb523-13"></a>  <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb523-14"><a href="dv-plot.html#cb523-14"></a>)</span>
<span id="cb523-15"><a href="dv-plot.html#cb523-15"></a><span class="kw">grid</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diamonds-base-barplot"></span>
<img src="dv-plot_files/figure-html/diamonds-base-barplot-1.png" alt="条形图" width="70%" />
<p class="caption">
图 11.32: 条形图
</p>
</div>
<p>简单柱形图</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="dv-plot.html#cb524-1"></a><span class="kw">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb524-2"><a href="dv-plot.html#cb524-2"></a>barPois &lt;-<span class="st"> </span><span class="kw">table</span>(stats<span class="op">::</span><span class="kw">rpois</span>(<span class="dv">1000</span>, <span class="dt">lambda =</span> <span class="dv">5</span>))</span>
<span id="cb524-3"><a href="dv-plot.html#cb524-3"></a><span class="kw">plot</span>(barPois, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lwd =</span> <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb524-4"><a href="dv-plot.html#cb524-4"></a><span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-38"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-38-1.png" alt="柱形图" width="70%" />
<p class="caption">
图 11.33: 柱形图
</p>
</div>
<p>复合条形图</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="dv-plot.html#cb525-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">0.5</span>, <span class="fl">4.5</span>))</span>
<span id="cb525-2"><a href="dv-plot.html#cb525-2"></a><span class="kw">barplot</span>(VADeaths,</span>
<span id="cb525-3"><a href="dv-plot.html#cb525-3"></a>  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">5</span>),</span>
<span id="cb525-4"><a href="dv-plot.html#cb525-4"></a>  <span class="dt">legend.text =</span> <span class="kw">rownames</span>(VADeaths), <span class="dt">xpd =</span> <span class="ot">TRUE</span>, <span class="dt">beside =</span> <span class="ot">TRUE</span>,</span>
<span id="cb525-5"><a href="dv-plot.html#cb525-5"></a>  <span class="dt">cex.names =</span> <span class="fl">0.9</span>,</span>
<span id="cb525-6"><a href="dv-plot.html#cb525-6"></a>  <span class="dt">args.legend =</span> <span class="kw">list</span>(</span>
<span id="cb525-7"><a href="dv-plot.html#cb525-7"></a>    <span class="dt">x =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb525-8"><a href="dv-plot.html#cb525-8"></a>    <span class="dt">box.col =</span> <span class="ot">NA</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">2</span>, <span class="dv">0</span>),</span>
<span id="cb525-9"><a href="dv-plot.html#cb525-9"></a>    <span class="dt">xpd =</span> <span class="ot">TRUE</span></span>
<span id="cb525-10"><a href="dv-plot.html#cb525-10"></a>  ),</span>
<span id="cb525-11"><a href="dv-plot.html#cb525-11"></a>  <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">nx =</span> <span class="dv">0</span>, <span class="dt">ny =</span> <span class="dv">7</span>)</span>
<span id="cb525-12"><a href="dv-plot.html#cb525-12"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:barplot-VADeaths-1"></span>
<img src="dv-plot_files/figure-html/barplot-VADeaths-1-1.png" alt="复合条形图" width="70%" />
<p class="caption">
图 11.34: 复合条形图
</p>
</div>
<p>堆积条形图</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="dv-plot.html#cb526-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">0.5</span>, <span class="fl">4.5</span>))</span>
<span id="cb526-2"><a href="dv-plot.html#cb526-2"></a><span class="kw">barplot</span>(VADeaths,</span>
<span id="cb526-3"><a href="dv-plot.html#cb526-3"></a>  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">5</span>),</span>
<span id="cb526-4"><a href="dv-plot.html#cb526-4"></a>  <span class="dt">legend.text =</span> <span class="kw">rownames</span>(VADeaths), <span class="dt">xpd =</span> <span class="ot">TRUE</span>, <span class="dt">beside =</span> <span class="ot">FALSE</span>,</span>
<span id="cb526-5"><a href="dv-plot.html#cb526-5"></a>  <span class="dt">cex.names =</span> <span class="fl">0.9</span>,</span>
<span id="cb526-6"><a href="dv-plot.html#cb526-6"></a>  <span class="dt">args.legend =</span> <span class="kw">list</span>(</span>
<span id="cb526-7"><a href="dv-plot.html#cb526-7"></a>    <span class="dt">x =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb526-8"><a href="dv-plot.html#cb526-8"></a>    <span class="dt">box.col =</span> <span class="ot">NA</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">2</span>, <span class="dv">0</span>),</span>
<span id="cb526-9"><a href="dv-plot.html#cb526-9"></a>    <span class="dt">xpd =</span> <span class="ot">TRUE</span></span>
<span id="cb526-10"><a href="dv-plot.html#cb526-10"></a>  ),</span>
<span id="cb526-11"><a href="dv-plot.html#cb526-11"></a>  <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">nx =</span> <span class="dv">0</span>, <span class="dt">ny =</span> <span class="dv">4</span>)</span>
<span id="cb526-12"><a href="dv-plot.html#cb526-12"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:barplot-VADeaths-2"></span>
<img src="dv-plot_files/figure-html/barplot-VADeaths-2-1.png" alt="堆积条形图" width="70%" />
<p class="caption">
图 11.35: 堆积条形图
</p>
</div>
<ul>
<li>堆积条形图 spineplot</li>
</ul>
<p>简单条形图</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="dv-plot.html#cb527-1"></a><span class="kw">barplot</span>(</span>
<span id="cb527-2"><a href="dv-plot.html#cb527-2"></a>  <span class="dt">data =</span> BOD, demand <span class="op">~</span><span class="st"> </span>Time, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>),</span>
<span id="cb527-3"><a href="dv-plot.html#cb527-3"></a>  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">1</span>)</span>
<span id="cb527-4"><a href="dv-plot.html#cb527-4"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/barplot-BOD-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="dv-plot.html#cb528-1"></a>pg_mean &lt;-<span class="st"> </span><span class="kw">aggregate</span>(weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> PlantGrowth, mean)</span>
<span id="cb528-2"><a href="dv-plot.html#cb528-2"></a><span class="kw">barplot</span>(</span>
<span id="cb528-3"><a href="dv-plot.html#cb528-3"></a>  <span class="dt">data =</span> pg_mean, weight <span class="op">~</span><span class="st"> </span>group,</span>
<span id="cb528-4"><a href="dv-plot.html#cb528-4"></a>  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">3</span>)</span>
<span id="cb528-5"><a href="dv-plot.html#cb528-5"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/barplot-PlantGrowth-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Titanic 数据集是 table 数据类型</p>
<p>简单条形图</p>
<p>复合条形图</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="dv-plot.html#cb529-1"></a><span class="kw">barplot</span>(Freq <span class="op">~</span><span class="st"> </span>Class <span class="op">+</span><span class="st"> </span>Survived,</span>
<span id="cb529-2"><a href="dv-plot.html#cb529-2"></a>  <span class="dt">data =</span> Titanic,</span>
<span id="cb529-3"><a href="dv-plot.html#cb529-3"></a>  <span class="dt">subset =</span> Age <span class="op">==</span><span class="st"> &quot;Adult&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Sex <span class="op">==</span><span class="st"> &quot;Male&quot;</span>,</span>
<span id="cb529-4"><a href="dv-plot.html#cb529-4"></a>  <span class="dt">beside =</span> <span class="ot">TRUE</span>,</span>
<span id="cb529-5"><a href="dv-plot.html#cb529-5"></a>  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">4</span>),</span>
<span id="cb529-6"><a href="dv-plot.html#cb529-6"></a>  <span class="dt">args.legend =</span> <span class="kw">list</span>(</span>
<span id="cb529-7"><a href="dv-plot.html#cb529-7"></a>    <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Class&quot;</span>,</span>
<span id="cb529-8"><a href="dv-plot.html#cb529-8"></a>    <span class="dt">box.col =</span> <span class="ot">NA</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>,</span>
<span id="cb529-9"><a href="dv-plot.html#cb529-9"></a>    <span class="dt">xpd =</span> <span class="ot">TRUE</span></span>
<span id="cb529-10"><a href="dv-plot.html#cb529-10"></a>  ),</span>
<span id="cb529-11"><a href="dv-plot.html#cb529-11"></a>  <span class="dt">ylab =</span> <span class="st">&quot;# {passengers}&quot;</span>, <span class="dt">legend =</span> <span class="ot">TRUE</span></span>
<span id="cb529-12"><a href="dv-plot.html#cb529-12"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-39-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>堆积条形图</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="dv-plot.html#cb530-1"></a><span class="kw">barplot</span>(Freq <span class="op">~</span><span class="st"> </span>Class <span class="op">+</span><span class="st"> </span>Survived,</span>
<span id="cb530-2"><a href="dv-plot.html#cb530-2"></a>  <span class="dt">data =</span> Titanic,</span>
<span id="cb530-3"><a href="dv-plot.html#cb530-3"></a>  <span class="dt">subset =</span> Age <span class="op">==</span><span class="st"> &quot;Adult&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Sex <span class="op">==</span><span class="st"> &quot;Male&quot;</span>,</span>
<span id="cb530-4"><a href="dv-plot.html#cb530-4"></a>  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">4</span>),</span>
<span id="cb530-5"><a href="dv-plot.html#cb530-5"></a>  <span class="dt">args.legend =</span> <span class="kw">list</span>(</span>
<span id="cb530-6"><a href="dv-plot.html#cb530-6"></a>    <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Class&quot;</span>,</span>
<span id="cb530-7"><a href="dv-plot.html#cb530-7"></a>    <span class="dt">box.col =</span> <span class="ot">NA</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>,</span>
<span id="cb530-8"><a href="dv-plot.html#cb530-8"></a>    <span class="dt">xpd =</span> <span class="ot">TRUE</span></span>
<span id="cb530-9"><a href="dv-plot.html#cb530-9"></a>  ),</span>
<span id="cb530-10"><a href="dv-plot.html#cb530-10"></a>  <span class="dt">ylab =</span> <span class="st">&quot;# {passengers}&quot;</span>, <span class="dt">legend =</span> <span class="ot">TRUE</span></span>
<span id="cb530-11"><a href="dv-plot.html#cb530-11"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-hist" class="section level3">
<h3><span class="header-section-number">11.2.2</span> 直方图</h3>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="dv-plot.html#cb531-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb531-2"><a href="dv-plot.html#cb531-2"></a>n &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">^</span><span class="dv">24</span></span>
<span id="cb531-3"><a href="dv-plot.html#cb531-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb531-4"><a href="dv-plot.html#cb531-4"></a>delta &lt;-<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb531-5"><a href="dv-plot.html#cb531-5"></a>len &lt;-<span class="st"> </span><span class="kw">diff</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span>delta), n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb531-6"><a href="dv-plot.html#cb531-6"></a>ylim &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1800</span>, <span class="dt">by =</span> <span class="dv">300</span>)</span>
<span id="cb531-7"><a href="dv-plot.html#cb531-7"></a>xlim &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">20</span>)</span>
<span id="cb531-8"><a href="dv-plot.html#cb531-8"></a>p &lt;-<span class="st"> </span><span class="kw">hist</span>(len[len <span class="op">&lt;</span><span class="st"> </span><span class="dv">101</span>], <span class="dt">breaks =</span> <span class="dv">-1</span><span class="op">:</span><span class="dv">100</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</span>
<span id="cb531-9"><a href="dv-plot.html#cb531-9"></a><span class="kw">plot</span>(p, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb531-10"><a href="dv-plot.html#cb531-10"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">labels =</span> xlim, <span class="dt">at =</span> xlim, <span class="dt">las =</span> <span class="dv">1</span>) <span class="co"># x 轴</span></span>
<span id="cb531-11"><a href="dv-plot.html#cb531-11"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">labels =</span> ylim, <span class="dt">at =</span> ylim, <span class="dt">las =</span> <span class="dv">0</span>) <span class="co"># y 轴</span></span>
<span id="cb531-12"><a href="dv-plot.html#cb531-12"></a><span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-41"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-41-1.png" alt="直方图" width="55%" />
<p class="caption">
图 11.36: 直方图
</p>
</div>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="dv-plot.html#cb532-1"></a><span class="kw">with</span>(faithful, <span class="kw">plot</span>(eruptions <span class="op">~</span><span class="st"> </span>waiting, <span class="dt">pch =</span> <span class="dv">16</span>))</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-42-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="dv-plot.html#cb533-1"></a><span class="kw">with</span>(faithful, <span class="kw">hist</span>(waiting,</span>
<span id="cb533-2"><a href="dv-plot.html#cb533-2"></a>  <span class="dt">main =</span> <span class="st">&quot;Time between Old Faithful eruptions&quot;</span>,</span>
<span id="cb533-3"><a href="dv-plot.html#cb533-3"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Minutes&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb533-4"><a href="dv-plot.html#cb533-4"></a>  <span class="dt">cex.main =</span> <span class="fl">1.5</span>, <span class="dt">cex.lab =</span> <span class="fl">1.5</span>, <span class="dt">cex.axis =</span> <span class="fl">1.4</span></span>
<span id="cb533-5"><a href="dv-plot.html#cb533-5"></a>))</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-43-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="dv-plot.html#cb534-1"></a><span class="kw">with</span>(<span class="dt">data =</span> faithful, {</span>
<span id="cb534-2"><a href="dv-plot.html#cb534-2"></a>  <span class="kw">hist</span>(eruptions, <span class="kw">seq</span>(<span class="fl">1.6</span>, <span class="fl">5.2</span>, <span class="fl">0.2</span>),</span>
<span id="cb534-3"><a href="dv-plot.html#cb534-3"></a>    <span class="dt">prob =</span> <span class="ot">TRUE</span>,</span>
<span id="cb534-4"><a href="dv-plot.html#cb534-4"></a>    <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb534-5"><a href="dv-plot.html#cb534-5"></a>  )</span>
<span id="cb534-6"><a href="dv-plot.html#cb534-6"></a>  <span class="kw">lines</span>(<span class="kw">density</span>(eruptions, <span class="dt">bw =</span> <span class="fl">0.1</span>), <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span>)</span>
<span id="cb534-7"><a href="dv-plot.html#cb534-7"></a>  <span class="kw">rug</span>(eruptions, <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span>) <span class="co"># 添加数据点</span></span>
<span id="cb534-8"><a href="dv-plot.html#cb534-8"></a>})</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:eruptions"></span>
<img src="dv-plot_files/figure-html/eruptions-1.png" alt="老忠实泉间歇性喷水的时间间隔分布" width="70%" />
<p class="caption">
图 11.37: 老忠实泉间歇性喷水的时间间隔分布
</p>
</div>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="dv-plot.html#cb535-1"></a><span class="kw">hist</span>(longley<span class="op">$</span>Unemployed,</span>
<span id="cb535-2"><a href="dv-plot.html#cb535-2"></a>  <span class="dt">probability =</span> <span class="ot">TRUE</span>,</span>
<span id="cb535-3"><a href="dv-plot.html#cb535-3"></a>  <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb535-4"><a href="dv-plot.html#cb535-4"></a>)</span>
<span id="cb535-5"><a href="dv-plot.html#cb535-5"></a><span class="co"># 添加密度估计</span></span>
<span id="cb535-6"><a href="dv-plot.html#cb535-6"></a><span class="kw">lines</span>(<span class="kw">density</span>(longley<span class="op">$</span>Unemployed),</span>
<span id="cb535-7"><a href="dv-plot.html#cb535-7"></a>  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb535-8"><a href="dv-plot.html#cb535-8"></a>  <span class="dt">lwd =</span> <span class="dv">3</span></span>
<span id="cb535-9"><a href="dv-plot.html#cb535-9"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-44"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-44-1.png" alt="概率密度分布" width="70%" />
<p class="caption">
图 11.38: 概率密度分布
</p>
</div>
<p>直方图有很多花样的，添加阴影线，angle 控制倾斜的角度</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="dv-plot.html#cb536-1"></a><span class="co"># hist(longley$Unemployed, density = 1, angle = 45)</span></span>
<span id="cb536-2"><a href="dv-plot.html#cb536-2"></a><span class="co"># hist(longley$Unemployed, density = 3, angle = 15)</span></span>
<span id="cb536-3"><a href="dv-plot.html#cb536-3"></a><span class="co"># hist(longley$Unemployed, density = 1, angle = 15)</span></span>
<span id="cb536-4"><a href="dv-plot.html#cb536-4"></a><span class="kw">hist</span>(longley<span class="op">$</span>Unemployed, <span class="dt">density =</span> <span class="dv">3</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-45"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-45-1.png" alt="density 数值越大阴影线越密" width="70%" />
<p class="caption">
图 11.39: density 数值越大阴影线越密
</p>
</div>
</div>
<div id="plot-density" class="section level3">
<h3><span class="header-section-number">11.2.3</span> 密度图</h3>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="dv-plot.html#cb537-1"></a><span class="kw">data</span>(galaxies, <span class="dt">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb537-2"><a href="dv-plot.html#cb537-2"></a>galaxies &lt;-<span class="st"> </span>galaxies <span class="op">/</span><span class="st"> </span><span class="dv">1000</span></span>
<span id="cb537-3"><a href="dv-plot.html#cb537-3"></a><span class="co"># Bandwidth Selection by Pilot Estimation of Derivatives</span></span>
<span id="cb537-4"><a href="dv-plot.html#cb537-4"></a><span class="kw">c</span>(MASS<span class="op">::</span><span class="kw">width.SJ</span>(galaxies, <span class="dt">method =</span> <span class="st">&quot;dpi&quot;</span>), MASS<span class="op">::</span><span class="kw">width.SJ</span>(galaxies))</span>
<span id="cb537-5"><a href="dv-plot.html#cb537-5"></a><span class="co">#&gt; [1] 3.256151 2.566423</span></span></code></pre></div>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="dv-plot.html#cb538-1"></a><span class="kw">plot</span>(</span>
<span id="cb538-2"><a href="dv-plot.html#cb538-2"></a>  <span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">40</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb538-3"><a href="dv-plot.html#cb538-3"></a>  <span class="dt">xlab =</span> <span class="st">&quot;velocity of galaxy (km/s)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;density&quot;</span></span>
<span id="cb538-4"><a href="dv-plot.html#cb538-4"></a>)</span>
<span id="cb538-5"><a href="dv-plot.html#cb538-5"></a><span class="kw">rug</span>(galaxies)</span>
<span id="cb538-6"><a href="dv-plot.html#cb538-6"></a><span class="kw">lines</span>(<span class="kw">density</span>(galaxies, <span class="dt">width =</span> <span class="fl">3.25</span>, <span class="dt">n =</span> <span class="dv">200</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>)</span>
<span id="cb538-7"><a href="dv-plot.html#cb538-7"></a><span class="kw">lines</span>(<span class="kw">density</span>(galaxies, <span class="dt">width =</span> <span class="fl">2.56</span>, <span class="dt">n =</span> <span class="dv">200</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-47-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="dv-plot.html#cb539-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">100</span>, <span class="dt">to =</span> <span class="dv">174</span>, <span class="dt">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb539-2"><a href="dv-plot.html#cb539-2"></a>y1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">145</span>, <span class="dt">sd =</span> <span class="dv">9</span>)</span>
<span id="cb539-3"><a href="dv-plot.html#cb539-3"></a>y2 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">128</span>, <span class="dt">sd =</span> <span class="dv">8</span>)</span>
<span id="cb539-4"><a href="dv-plot.html#cb539-4"></a><span class="kw">plot</span>(x, y1,</span>
<span id="cb539-5"><a href="dv-plot.html#cb539-5"></a>  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;firebrick3&quot;</span>,</span>
<span id="cb539-6"><a href="dv-plot.html#cb539-6"></a> <span class="dt">main =</span> <span class="st">&quot;Systolic Blood Pressure Before and After Treatment&quot;</span>,</span>
<span id="cb539-7"><a href="dv-plot.html#cb539-7"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Systolic Blood Pressure (mmHg)&quot;</span>,</span>
<span id="cb539-8"><a href="dv-plot.html#cb539-8"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Frequency&quot;</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb539-9"><a href="dv-plot.html#cb539-9"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">175</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)</span>
<span id="cb539-10"><a href="dv-plot.html#cb539-10"></a>)</span>
<span id="cb539-11"><a href="dv-plot.html#cb539-11"></a></span>
<span id="cb539-12"><a href="dv-plot.html#cb539-12"></a><span class="kw">lines</span>(x, y2, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>)</span>
<span id="cb539-13"><a href="dv-plot.html#cb539-13"></a><span class="kw">polygon</span>(<span class="kw">c</span>(<span class="dv">117</span>, x, <span class="dv">175</span>), <span class="kw">c</span>(<span class="dv">0</span>, y2, <span class="dv">0</span>),</span>
<span id="cb539-14"><a href="dv-plot.html#cb539-14"></a>  <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>,</span>
<span id="cb539-15"><a href="dv-plot.html#cb539-15"></a>  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb539-16"><a href="dv-plot.html#cb539-16"></a>)</span>
<span id="cb539-17"><a href="dv-plot.html#cb539-17"></a></span>
<span id="cb539-18"><a href="dv-plot.html#cb539-18"></a><span class="kw">polygon</span>(<span class="kw">c</span>(<span class="dv">100</span>, x, <span class="dv">175</span>), <span class="kw">c</span>(<span class="dv">0</span>, y1, <span class="dv">0</span>),</span>
<span id="cb539-19"><a href="dv-plot.html#cb539-19"></a>  <span class="dt">col =</span> <span class="st">&quot;firebrick3&quot;</span>,</span>
<span id="cb539-20"><a href="dv-plot.html#cb539-20"></a>  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb539-21"><a href="dv-plot.html#cb539-21"></a>)</span>
<span id="cb539-22"><a href="dv-plot.html#cb539-22"></a></span>
<span id="cb539-23"><a href="dv-plot.html#cb539-23"></a><span class="kw">axis</span>(<span class="dv">2</span>,</span>
<span id="cb539-24"><a href="dv-plot.html#cb539-24"></a>  <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="fl">0.05</span>, <span class="dt">length.out =</span> <span class="dv">8</span>),</span>
<span id="cb539-25"><a href="dv-plot.html#cb539-25"></a>  <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">175</span>, <span class="dt">by =</span> <span class="dv">25</span>), <span class="dt">las =</span> <span class="dv">1</span></span>
<span id="cb539-26"><a href="dv-plot.html#cb539-26"></a>)</span>
<span id="cb539-27"><a href="dv-plot.html#cb539-27"></a></span>
<span id="cb539-28"><a href="dv-plot.html#cb539-28"></a><span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">100</span>, <span class="dt">y =</span> <span class="fl">0.0445</span>, <span class="st">&quot;Pre-Treatment BP&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.9</span>, <span class="dt">pos =</span> <span class="dv">4</span>)</span>
<span id="cb539-29"><a href="dv-plot.html#cb539-29"></a><span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">100</span>, <span class="dt">y =</span> <span class="fl">0.0395</span>, <span class="st">&quot;Post-Treatment BP&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;firebrick3&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.9</span>, <span class="dt">pos =</span> <span class="dv">4</span>)</span>
<span id="cb539-30"><a href="dv-plot.html#cb539-30"></a><span class="kw">points</span>(<span class="dv">100</span>, <span class="fl">0.0445</span>, <span class="dt">pch =</span> <span class="dv">15</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>)</span>
<span id="cb539-31"><a href="dv-plot.html#cb539-31"></a><span class="kw">points</span>(<span class="dv">100</span>, <span class="fl">0.0395</span>, <span class="dt">pch =</span> <span class="dv">15</span>, <span class="dt">col =</span> <span class="st">&quot;firebrick3&quot;</span>)</span>
<span id="cb539-32"><a href="dv-plot.html#cb539-32"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(<span class="dv">145</span>, <span class="dv">128</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&#39;gray&#39;</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-48-1.png" width="65%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="dv-plot.html#cb540-1"></a>days &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">rnorm</span>(<span class="dv">1000</span>, <span class="dv">80</span>, <span class="dv">125</span>))</span>
<span id="cb540-2"><a href="dv-plot.html#cb540-2"></a><span class="kw">plot</span>(<span class="kw">density</span>(days, <span class="dt">from =</span> <span class="dv">0</span>),</span>
<span id="cb540-3"><a href="dv-plot.html#cb540-3"></a>  <span class="dt">main =</span> <span class="st">&quot;Density plot&quot;</span>,</span>
<span id="cb540-4"><a href="dv-plot.html#cb540-4"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Number of days since trial started&quot;</span></span>
<span id="cb540-5"><a href="dv-plot.html#cb540-5"></a>)</span>
<span id="cb540-6"><a href="dv-plot.html#cb540-6"></a><span class="kw">plot</span>(<span class="kw">density</span>(days, <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">180</span>, <span class="dt">adjust =</span> <span class="fl">0.2</span>),</span>
<span id="cb540-7"><a href="dv-plot.html#cb540-7"></a>  <span class="dt">main =</span> <span class="st">&quot;Density plot - Up to 180 days (86% of data)&quot;</span>,</span>
<span id="cb540-8"><a href="dv-plot.html#cb540-8"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Number of days since trial started&quot;</span></span>
<span id="cb540-9"><a href="dv-plot.html#cb540-9"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-49-1.png" width="55%" style="display: block; margin: auto;" /><img src="dv-plot_files/figure-html/unnamed-chunk-49-2.png" width="55%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="dv-plot.html#cb541-1"></a><span class="kw">library</span>(survival)</span>
<span id="cb541-2"><a href="dv-plot.html#cb541-2"></a>surv.days &lt;-<span class="st"> </span><span class="kw">Surv</span>(days)</span>
<span id="cb541-3"><a href="dv-plot.html#cb541-3"></a>surv.fit &lt;-<span class="st"> </span><span class="kw">survfit</span>(surv.days <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb541-4"><a href="dv-plot.html#cb541-4"></a><span class="kw">plot</span>(surv.fit,</span>
<span id="cb541-5"><a href="dv-plot.html#cb541-5"></a>  <span class="dt">main =</span> <span class="st">&quot;Kaplan-Meier estimate with 95% confidence bounds (86% of data)&quot;</span>,</span>
<span id="cb541-6"><a href="dv-plot.html#cb541-6"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Days since trial started&quot;</span>,</span>
<span id="cb541-7"><a href="dv-plot.html#cb541-7"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">180</span>),</span>
<span id="cb541-8"><a href="dv-plot.html#cb541-8"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Survival function&quot;</span></span>
<span id="cb541-9"><a href="dv-plot.html#cb541-9"></a>)</span>
<span id="cb541-10"><a href="dv-plot.html#cb541-10"></a><span class="kw">grid</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-50-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-ecdf" class="section level3">
<h3><span class="header-section-number">11.2.4</span> 经验图</h3>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="dv-plot.html#cb542-1"></a><span class="kw">with</span>(<span class="dt">data =</span> faithful, {</span>
<span id="cb542-2"><a href="dv-plot.html#cb542-2"></a>  long &lt;-<span class="st"> </span>eruptions[eruptions <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>]</span>
<span id="cb542-3"><a href="dv-plot.html#cb542-3"></a>  <span class="kw">plot</span>(<span class="kw">ecdf</span>(long), <span class="dt">do.points =</span> <span class="ot">FALSE</span>, <span class="dt">verticals =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb542-4"><a href="dv-plot.html#cb542-4"></a>  x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">3</span>, <span class="fl">5.4</span>, <span class="fl">0.01</span>)</span>
<span id="cb542-5"><a href="dv-plot.html#cb542-5"></a>  <span class="kw">lines</span>(x, <span class="kw">pnorm</span>(x, <span class="dt">mean =</span> <span class="kw">mean</span>(long), <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="kw">var</span>(long))), <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb542-6"><a href="dv-plot.html#cb542-6"></a>})</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:faithful"></span>
<img src="dv-plot_files/figure-html/faithful-1.png" alt="累积经验分布图" width="70%" />
<p class="caption">
图 11.40: 累积经验分布图
</p>
</div>
</div>
<div id="plot-qqnorm" class="section level3">
<h3><span class="header-section-number">11.2.5</span> QQ 图</h3>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="dv-plot.html#cb543-1"></a><span class="kw">with</span>(<span class="dt">data =</span> faithful, {</span>
<span id="cb543-2"><a href="dv-plot.html#cb543-2"></a>  long &lt;-<span class="st"> </span>eruptions[eruptions <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>]</span>
<span id="cb543-3"><a href="dv-plot.html#cb543-3"></a>  <span class="kw">par</span>(<span class="dt">pty =</span> <span class="st">&quot;s&quot;</span>) <span class="co"># arrange for a square figure region</span></span>
<span id="cb543-4"><a href="dv-plot.html#cb543-4"></a>  <span class="kw">qqnorm</span>(long, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb543-5"><a href="dv-plot.html#cb543-5"></a>  <span class="kw">qqline</span>(long)</span>
<span id="cb543-6"><a href="dv-plot.html#cb543-6"></a>})</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/faithful-eruptions-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-ts" class="section level3">
<h3><span class="header-section-number">11.2.6</span> 时序图</h3>
<p>时序图最适合用来描述股价走势</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="dv-plot.html#cb544-1"></a><span class="kw">matplot</span>(<span class="kw">time</span>(EuStockMarkets), EuStockMarkets,</span>
<span id="cb544-2"><a href="dv-plot.html#cb544-2"></a>  <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb544-3"><a href="dv-plot.html#cb544-3"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Date&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;closing prices&quot;</span>,</span>
<span id="cb544-4"><a href="dv-plot.html#cb544-4"></a>  <span class="dt">pch =</span> <span class="dv">17</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span></span>
<span id="cb544-5"><a href="dv-plot.html#cb544-5"></a>)</span>
<span id="cb544-6"><a href="dv-plot.html#cb544-6"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="kw">colnames</span>(EuStockMarkets), <span class="dt">pch =</span> <span class="dv">17</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-51"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-51-1.png" alt="1991–1998年间主要欧洲股票市场日闭市价格指数图 
 德国 DAX (Ibis), Switzerland SMI, 法国 CAC 和 英国 FTSE" width="70%" />
<p class="caption">
图 11.41: 1991–1998年间主要欧洲股票市场日闭市价格指数图
德国 DAX (Ibis), Switzerland SMI, 法国 CAC 和 英国 FTSE
</p>
</div>
</div>
<div id="plot-pie" class="section level3">
<h3><span class="header-section-number">11.2.7</span> 饼图</h3>
<p>clockwise 参数</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="dv-plot.html#cb545-1"></a>pie.sales &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.12</span>, <span class="fl">0.3</span>, <span class="fl">0.26</span>, <span class="fl">0.16</span>, <span class="fl">0.04</span>, <span class="fl">0.12</span>)</span>
<span id="cb545-2"><a href="dv-plot.html#cb545-2"></a><span class="kw">names</span>(pie.sales) &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb545-3"><a href="dv-plot.html#cb545-3"></a>  <span class="st">&quot;Blueberry&quot;</span>, <span class="st">&quot;Cherry&quot;</span>,</span>
<span id="cb545-4"><a href="dv-plot.html#cb545-4"></a>  <span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Boston Cream&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Vanilla Cream&quot;</span></span>
<span id="cb545-5"><a href="dv-plot.html#cb545-5"></a>)</span>
<span id="cb545-6"><a href="dv-plot.html#cb545-6"></a><span class="kw">pie</span>(pie.sales, <span class="dt">clockwise =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb545-7"><a href="dv-plot.html#cb545-7"></a><span class="kw">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb545-8"><a href="dv-plot.html#cb545-8"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="st">&quot;init.angle = 90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-52-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-stem-leaf" class="section level3">
<h3><span class="header-section-number">11.2.8</span> 茎叶图</h3>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="dv-plot.html#cb546-1"></a><span class="kw">stem</span>(longley<span class="op">$</span>Unemployed)</span>
<span id="cb546-2"><a href="dv-plot.html#cb546-2"></a><span class="co">#&gt; </span></span>
<span id="cb546-3"><a href="dv-plot.html#cb546-3"></a><span class="co">#&gt;   The decimal point is 2 digit(s) to the right of the |</span></span>
<span id="cb546-4"><a href="dv-plot.html#cb546-4"></a><span class="co">#&gt; </span></span>
<span id="cb546-5"><a href="dv-plot.html#cb546-5"></a><span class="co">#&gt;   1 | 99</span></span>
<span id="cb546-6"><a href="dv-plot.html#cb546-6"></a><span class="co">#&gt;   2 | 134899</span></span>
<span id="cb546-7"><a href="dv-plot.html#cb546-7"></a><span class="co">#&gt;   3 | 46789</span></span>
<span id="cb546-8"><a href="dv-plot.html#cb546-8"></a><span class="co">#&gt;   4 | 078</span></span></code></pre></div>
</div>
<div id="plot-scatter" class="section level3">
<h3><span class="header-section-number">11.2.9</span> 散点图</h3>
<p>在一维空间上，绘制散点图，其实是在看散点的疏密程度随坐标轴的变化</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="dv-plot.html#cb547-1"></a><span class="kw">stripchart</span>(longley<span class="op">$</span>Unemployed, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">jitter =</span> <span class="fl">0.1</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb547-2"><a href="dv-plot.html#cb547-2"></a><span class="kw">stripchart</span>(longley<span class="op">$</span>Unemployed, <span class="dt">method =</span> <span class="st">&quot;overplot&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-54"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-54-1.png" alt="一维散点图" width="70%" /><img src="dv-plot_files/figure-html/unnamed-chunk-54-2.png" alt="一维散点图" width="70%" />
<p class="caption">
图 11.42: 一维散点图
</p>
</div>
<p>气泡图是二维散点图的一种变体，气泡的大小可以用来描述第三个变量，下面以数据集 topo 为例展示气泡图</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="dv-plot.html#cb548-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb548-2"><a href="dv-plot.html#cb548-2"></a><span class="kw">data</span>(topo, <span class="dt">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb548-3"><a href="dv-plot.html#cb548-3"></a><span class="co"># 查看数据集</span></span>
<span id="cb548-4"><a href="dv-plot.html#cb548-4"></a><span class="kw">str</span>(topo)</span>
<span id="cb548-5"><a href="dv-plot.html#cb548-5"></a><span class="co">#&gt; &#39;data.frame&#39;:    52 obs. of  3 variables:</span></span>
<span id="cb548-6"><a href="dv-plot.html#cb548-6"></a><span class="co">#&gt;  $ x: num  0.3 1.4 2.4 3.6 5.7 1.6 2.9 3.4 3.4 4.8 ...</span></span>
<span id="cb548-7"><a href="dv-plot.html#cb548-7"></a><span class="co">#&gt;  $ y: num  6.1 6.2 6.1 6.2 6.2 5.2 5.1 5.3 5.7 5.6 ...</span></span>
<span id="cb548-8"><a href="dv-plot.html#cb548-8"></a><span class="co">#&gt;  $ z: int  870 793 755 690 800 800 730 728 710 780 ...</span></span></code></pre></div>
<p>topo 是空间地形数据集，包含有52行3列，数据点是310平方英尺范围内的海拔高度数据，x 坐标每单位50英尺，y 坐标单位同 x 坐标，海拔高度 z 单位是英尺</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="dv-plot.html#cb549-1"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb549-2"><a href="dv-plot.html#cb549-2"></a>  <span class="dt">cex =</span> (<span class="dv">960</span> <span class="op">-</span><span class="st"> </span>z) <span class="op">/</span><span class="st"> </span>(<span class="dv">960</span> <span class="op">-</span><span class="st"> </span><span class="dv">690</span>) <span class="op">*</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">data =</span> topo,</span>
<span id="cb549-3"><a href="dv-plot.html#cb549-3"></a>  <span class="dt">xlab =</span> <span class="st">&quot;X Coordinates&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Y coordinates&quot;</span></span>
<span id="cb549-4"><a href="dv-plot.html#cb549-4"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-56"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-56-1.png" alt="地形图之海拔高度" width="70%" />
<p class="caption">
图 11.43: 地形图之海拔高度
</p>
</div>
<p>散点图也适合分类数据的展示，在图中用不同颜色或符号标记数据点所属类别，即在普通散点图的基础上添加一分类变量的描述</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="dv-plot.html#cb550-1"></a><span class="kw">plot</span>(mpg <span class="op">~</span><span class="st"> </span>hp,</span>
<span id="cb550-2"><a href="dv-plot.html#cb550-2"></a>  <span class="dt">data =</span> <span class="kw">subset</span>(mtcars, am <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb550-3"><a href="dv-plot.html#cb550-3"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">350</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">35</span>)</span>
<span id="cb550-4"><a href="dv-plot.html#cb550-4"></a>)</span>
<span id="cb550-5"><a href="dv-plot.html#cb550-5"></a><span class="kw">points</span>(mpg <span class="op">~</span><span class="st"> </span>hp,</span>
<span id="cb550-6"><a href="dv-plot.html#cb550-6"></a>  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>,</span>
<span id="cb550-7"><a href="dv-plot.html#cb550-7"></a>  <span class="dt">data =</span> <span class="kw">subset</span>(mtcars, am <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb550-8"><a href="dv-plot.html#cb550-8"></a>)</span>
<span id="cb550-9"><a href="dv-plot.html#cb550-9"></a><span class="kw">legend</span>(<span class="dv">300</span>, <span class="dv">35</span>,</span>
<span id="cb550-10"><a href="dv-plot.html#cb550-10"></a>  <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>),</span>
<span id="cb550-11"><a href="dv-plot.html#cb550-11"></a>  <span class="dt">title =</span> <span class="st">&quot;am&quot;</span>,</span>
<span id="cb550-12"><a href="dv-plot.html#cb550-12"></a>  <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb550-13"><a href="dv-plot.html#cb550-13"></a>  <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">16</span>)</span>
<span id="cb550-14"><a href="dv-plot.html#cb550-14"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:category-base"></span>
<img src="dv-plot_files/figure-html/category-base-1.png" alt="分类散点图" width="70%" />
<p class="caption">
图 11.44: 分类散点图
</p>
</div>
<p>iris 数据</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="dv-plot.html#cb551-1"></a><span class="kw">plot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width, <span class="dt">data =</span> iris, <span class="dt">col =</span> Species, <span class="dt">pch =</span> <span class="dv">16</span>)</span>
<span id="cb551-2"><a href="dv-plot.html#cb551-2"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb551-3"><a href="dv-plot.html#cb551-3"></a>  <span class="dt">legend =</span> <span class="kw">unique</span>(iris<span class="op">$</span>Species), <span class="dt">box.col =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb551-4"><a href="dv-plot.html#cb551-4"></a>  <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">unique</span>(iris<span class="op">$</span>Species)</span>
<span id="cb551-5"><a href="dv-plot.html#cb551-5"></a>)</span>
<span id="cb551-6"><a href="dv-plot.html#cb551-6"></a><span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:iris-scatter"></span>
<img src="dv-plot_files/figure-html/iris-scatter-1.png" alt="分类散点图" width="70%" />
<p class="caption">
图 11.45: 分类散点图
</p>
</div>
<p>分组散点图和平滑</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="dv-plot.html#cb552-1"></a><span class="kw">library</span>(carData)</span>
<span id="cb552-2"><a href="dv-plot.html#cb552-2"></a><span class="kw">library</span>(car)</span>
<span id="cb552-3"><a href="dv-plot.html#cb552-3"></a><span class="kw">scatterplot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width,</span>
<span id="cb552-4"><a href="dv-plot.html#cb552-4"></a>  <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">16</span>),</span>
<span id="cb552-5"><a href="dv-plot.html#cb552-5"></a>  <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">boxplots =</span> <span class="st">&quot;xy&quot;</span>, <span class="dt">groups =</span> iris<span class="op">$</span>Species,</span>
<span id="cb552-6"><a href="dv-plot.html#cb552-6"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Sepal.Width&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Sepal.Length&quot;</span>, <span class="dt">data =</span> iris</span>
<span id="cb552-7"><a href="dv-plot.html#cb552-7"></a>)</span></code></pre></div>
<p>有时为了实现特定的目的，需要高亮其中某些点，按类别或者因子变量分组绘制散点图，这里继续采用 <code>stripchart</code> 函数绘制二维散点图<a href="dv-plot.html#fig:scatter-iris">11.46</a>， 由左图可知，函数 <code>stripchart</code> 提供的参数 <code>pch</code> 不接受向量，实际只是取了前三个值 16 16 17 对应于 Species 的三类，关键是高亮的分界点是有区分意义的</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="dv-plot.html#cb553-1"></a><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)</span>
<span id="cb553-2"><a href="dv-plot.html#cb553-2"></a>pch &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">16</span>, <span class="kw">length</span>(iris<span class="op">$</span>Petal.Length))</span>
<span id="cb553-3"><a href="dv-plot.html#cb553-3"></a>pch[<span class="kw">which</span>(iris<span class="op">$</span>Petal.Length <span class="op">&lt;</span><span class="st"> </span><span class="fl">1.4</span>)] &lt;-<span class="st"> </span><span class="dv">17</span></span>
<span id="cb553-4"><a href="dv-plot.html#cb553-4"></a><span class="kw">stripchart</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species,</span>
<span id="cb553-5"><a href="dv-plot.html#cb553-5"></a>  <span class="dt">data =</span> iris,</span>
<span id="cb553-6"><a href="dv-plot.html#cb553-6"></a>  <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>,</span>
<span id="cb553-7"><a href="dv-plot.html#cb553-7"></a>  <span class="dt">pch =</span> pch</span>
<span id="cb553-8"><a href="dv-plot.html#cb553-8"></a>)</span>
<span id="cb553-9"><a href="dv-plot.html#cb553-9"></a><span class="co"># 对比一下</span></span>
<span id="cb553-10"><a href="dv-plot.html#cb553-10"></a><span class="kw">stripchart</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species,</span>
<span id="cb553-11"><a href="dv-plot.html#cb553-11"></a>  <span class="dt">data =</span> iris, <span class="dt">subset =</span> Petal.Length <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.4</span>,</span>
<span id="cb553-12"><a href="dv-plot.html#cb553-12"></a>  <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>),</span>
<span id="cb553-13"><a href="dv-plot.html#cb553-13"></a>  <span class="dt">pch =</span> <span class="dv">16</span></span>
<span id="cb553-14"><a href="dv-plot.html#cb553-14"></a>)</span>
<span id="cb553-15"><a href="dv-plot.html#cb553-15"></a><span class="kw">stripchart</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species,</span>
<span id="cb553-16"><a href="dv-plot.html#cb553-16"></a>  <span class="dt">data =</span> iris, <span class="dt">subset =</span> Petal.Length <span class="op">&lt;</span><span class="st"> </span><span class="fl">1.4</span>,</span>
<span id="cb553-17"><a href="dv-plot.html#cb553-17"></a>  <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>,</span>
<span id="cb553-18"><a href="dv-plot.html#cb553-18"></a>  <span class="dt">pch =</span> <span class="dv">17</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb553-19"><a href="dv-plot.html#cb553-19"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scatter-iris"></span>
<img src="dv-plot_files/figure-html/scatter-iris-1.png" alt="高亮图中部分散点" width="35%" /><img src="dv-plot_files/figure-html/scatter-iris-2.png" alt="高亮图中部分散点" width="35%" />
<p class="caption">
图 11.46: 高亮图中部分散点
</p>
</div>
<p>如果存在大量散点</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="dv-plot.html#cb554-1"></a><span class="kw">densCols</span>(x,</span>
<span id="cb554-2"><a href="dv-plot.html#cb554-2"></a>  <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">nbin =</span> <span class="dv">128</span>, bandwidth,</span>
<span id="cb554-3"><a href="dv-plot.html#cb554-3"></a>  <span class="dt">colramp =</span> <span class="kw">colorRampPalette</span>(blues9[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)])</span>
<span id="cb554-4"><a href="dv-plot.html#cb554-4"></a>)</span></code></pre></div>
<p><code>densCols</code> 函数根据点的局部密度生成颜色，密度估计采用核平滑法，由 <strong>KernSmooth</strong> 包的 <code>bkde2D</code> 函数实现。参数 <code>colramp</code> 传递一个函数，<code>colorRampPalette</code> 根据给定的几种颜色生成函数，参数 <code>bandwidth</code> 实际上是传给 <code>bkde2D</code> 函数</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="dv-plot.html#cb555-1"></a><span class="kw">plot</span>(faithful, <span class="dt">col =</span> <span class="kw">densCols</span>(faithful), <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">panel.first =</span> <span class="kw">grid</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:densCols"></span>
<img src="dv-plot_files/figure-html/densCols-1.png" alt="根据点的密度生成颜色" width="45%" />
<p class="caption">
图 11.47: 根据点的密度生成颜色
</p>
</div>
<p>气泡图也是散点图的一种</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="dv-plot.html#cb556-1"></a><span class="kw">plot</span>(Volume <span class="op">~</span><span class="st"> </span>Height,</span>
<span id="cb556-2"><a href="dv-plot.html#cb556-2"></a>  <span class="dt">data =</span> trees, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> Girth <span class="op">/</span><span class="st"> </span><span class="dv">8</span>,</span>
<span id="cb556-3"><a href="dv-plot.html#cb556-3"></a>  <span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">terrain.colors</span>(<span class="kw">nrow</span>(trees), <span class="dt">alpha =</span> <span class="fl">.5</span>))</span>
<span id="cb556-4"><a href="dv-plot.html#cb556-4"></a>)</span>
<span id="cb556-5"><a href="dv-plot.html#cb556-5"></a><span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-59"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-59-1.png" alt="气泡图" width="70%" />
<p class="caption">
图 11.48: 气泡图
</p>
</div>
<p>气泡图</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="dv-plot.html#cb557-1"></a><span class="co"># 空白画布</span></span>
<span id="cb557-2"><a href="dv-plot.html#cb557-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb557-3"><a href="dv-plot.html#cb557-3"></a>     <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>)</span>
<span id="cb557-4"><a href="dv-plot.html#cb557-4"></a><span class="co"># 添加坐标轴</span></span>
<span id="cb557-5"><a href="dv-plot.html#cb557-5"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">10</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb557-6"><a href="dv-plot.html#cb557-6"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">10</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb557-7"><a href="dv-plot.html#cb557-7"></a><span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">TRUE</span>) <span class="co"># 在当前图形上添加图形</span></span>
<span id="cb557-8"><a href="dv-plot.html#cb557-8"></a><span class="co"># axes 坐标轴上的刻度 &quot;xaxt&quot; or &quot;yaxt&quot;  ann 坐标轴和标题的标签</span></span>
<span id="cb557-9"><a href="dv-plot.html#cb557-9"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb557-10"><a href="dv-plot.html#cb557-10"></a><span class="kw">plot</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">1</span>), <span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">1</span>),</span>
<span id="cb557-11"><a href="dv-plot.html#cb557-11"></a>  <span class="dt">cex =</span> <span class="kw">runif</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb557-12"><a href="dv-plot.html#cb557-12"></a>  <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">4</span>)[<span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">4</span>), <span class="dv">100</span>)],</span>
<span id="cb557-13"><a href="dv-plot.html#cb557-13"></a>  <span class="dt">bg =</span> <span class="kw">paste0</span>(<span class="st">&quot;gray&quot;</span>, <span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">100</span>), <span class="dv">1</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))),</span>
<span id="cb557-14"><a href="dv-plot.html#cb557-14"></a>  <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">lwd =</span> <span class="dv">2</span></span>
<span id="cb557-15"><a href="dv-plot.html#cb557-15"></a>)</span>
<span id="cb557-16"><a href="dv-plot.html#cb557-16"></a><span class="kw">legend</span>(<span class="st">&quot;top&quot;</span>,</span>
<span id="cb557-17"><a href="dv-plot.html#cb557-17"></a>  <span class="dt">legend =</span> <span class="kw">paste0</span>(<span class="st">&quot;class&quot;</span>, <span class="kw">seq</span>(<span class="dv">4</span>)), <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">4</span>),</span>
<span id="cb557-18"><a href="dv-plot.html#cb557-18"></a>  <span class="dt">pt.lwd =</span> <span class="dv">2</span>, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">box.col =</span> <span class="st">&quot;gray&quot;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span></span>
<span id="cb557-19"><a href="dv-plot.html#cb557-19"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>除了<code>par(new=TRUE)</code>设置外，有些函数本身就具有 <code>add</code> 选项</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="dv-plot.html#cb558-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb558-2"><a href="dv-plot.html#cb558-2"></a><span class="kw">plot</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars, <span class="dt">pch =</span> <span class="dv">17</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</span>
<span id="cb558-3"><a href="dv-plot.html#cb558-3"></a><span class="kw">with</span>(cars, <span class="kw">symbols</span>(dist <span class="op">~</span><span class="st"> </span>speed,</span>
<span id="cb558-4"><a href="dv-plot.html#cb558-4"></a>  <span class="dt">circles =</span> <span class="kw">runif</span>(<span class="kw">length</span>(speed), <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb558-5"><a href="dv-plot.html#cb558-5"></a>  <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">inches =</span> <span class="fl">.5</span>, <span class="dt">add =</span> <span class="ot">TRUE</span></span>
<span id="cb558-6"><a href="dv-plot.html#cb558-6"></a>))</span>
<span id="cb558-7"><a href="dv-plot.html#cb558-7"></a>z &lt;-<span class="st"> </span><span class="kw">lm</span>(dist <span class="op">~</span><span class="st"> </span>speed, <span class="dt">data =</span> cars)</span>
<span id="cb558-8"><a href="dv-plot.html#cb558-8"></a><span class="kw">abline</span>(z, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb558-9"><a href="dv-plot.html#cb558-9"></a><span class="kw">curve</span>(tan, <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">8</span> <span class="op">*</span><span class="st"> </span>pi, <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb558-10"><a href="dv-plot.html#cb558-10"></a><span class="kw">lines</span>(stats<span class="op">::</span><span class="kw">lowess</span>(cars))</span>
<span id="cb558-11"><a href="dv-plot.html#cb558-11"></a><span class="kw">points</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb558-12"><a href="dv-plot.html#cb558-12"></a><span class="kw">text</span>(<span class="dv">10</span>, <span class="dv">80</span>, <span class="st">&quot;text here&quot;</span>, <span class="dt">cex =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-61-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="base-jitter" class="section level3">
<h3><span class="header-section-number">11.2.10</span> 抖动图</h3>
<p>抖动散点图</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="dv-plot.html#cb559-1"></a>mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">colors</span>()), <span class="dt">ncol =</span> <span class="dv">9</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb559-2"><a href="dv-plot.html#cb559-2"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb559-3"><a href="dv-plot.html#cb559-3"></a>  <span class="dt">col =</span> <span class="kw">colors</span>(),</span>
<span id="cb559-4"><a href="dv-plot.html#cb559-4"></a>  <span class="dt">x =</span> <span class="kw">as.integer</span>(<span class="kw">cut</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">colors</span>()), <span class="dv">9</span>)),</span>
<span id="cb559-5"><a href="dv-plot.html#cb559-5"></a>  <span class="dt">y =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">73</span>, <span class="dv">9</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></span>
<span id="cb559-6"><a href="dv-plot.html#cb559-6"></a>)</span>
<span id="cb559-7"><a href="dv-plot.html#cb559-7"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</span>
<span id="cb559-8"><a href="dv-plot.html#cb559-8"></a><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">jitter</span>(x),</span>
<span id="cb559-9"><a href="dv-plot.html#cb559-9"></a>  <span class="dt">data =</span> df, <span class="dt">col =</span> df<span class="op">$</span>col,</span>
<span id="cb559-10"><a href="dv-plot.html#cb559-10"></a>  <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">main =</span> <span class="st">&quot;Visualizing colors() split in 9 groups&quot;</span>,</span>
<span id="cb559-11"><a href="dv-plot.html#cb559-11"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb559-12"><a href="dv-plot.html#cb559-12"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Element of the group (min = 1, max = 73)&quot;</span>,</span>
<span id="cb559-13"><a href="dv-plot.html#cb559-13"></a>  <span class="dt">sub =</span> <span class="st">&quot;x = 3, y = 1 means that it&#39;s the 2 * 73 + 1 = 147th color&quot;</span></span>
<span id="cb559-14"><a href="dv-plot.html#cb559-14"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:jitter-scatter"></span>
<img src="dv-plot_files/figure-html/jitter-scatter-1.png" alt="抖动散点图" width="70%" />
<p class="caption">
图 11.49: 抖动散点图
</p>
</div>
</div>
<div id="plot-box" class="section level3">
<h3><span class="header-section-number">11.2.11</span> 箱线图</h3>
<p>boxplotdbl: Double Box Plot for Two-Axes Correlation. Correlation chart of two set (x and y) of data. Using Quartiles with boxplot style. Visualize the effect of factor.</p>
<p><a href="https://tomizonor.wordpress.com/2013/03/15/double-box-plot/">复合箱线图</a></p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="dv-plot.html#cb560-1"></a>A &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb560-2"><a href="dv-plot.html#cb560-2"></a>  <span class="fl">79.98</span>, <span class="fl">80.04</span>, <span class="fl">80.02</span>, <span class="fl">80.04</span>, <span class="fl">80.03</span>, <span class="fl">80.03</span>, <span class="fl">80.04</span>, <span class="fl">79.97</span>,</span>
<span id="cb560-3"><a href="dv-plot.html#cb560-3"></a>  <span class="fl">80.05</span>, <span class="fl">80.03</span>, <span class="fl">80.02</span>, <span class="dv">80</span>, <span class="fl">80.02</span></span>
<span id="cb560-4"><a href="dv-plot.html#cb560-4"></a>)</span>
<span id="cb560-5"><a href="dv-plot.html#cb560-5"></a>B &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">80.02</span>, <span class="fl">79.94</span>, <span class="fl">79.98</span>, <span class="fl">79.97</span>, <span class="fl">79.97</span>, <span class="fl">80.03</span>, <span class="fl">79.95</span>, <span class="fl">79.97</span>)</span>
<span id="cb560-6"><a href="dv-plot.html#cb560-6"></a><span class="kw">boxplot</span>(A, B)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/boxplot-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="dv-plot.html#cb561-1"></a><span class="kw">with</span>(<span class="dt">data =</span> iris, {</span>
<span id="cb561-2"><a href="dv-plot.html#cb561-2"></a>  op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="fl">.5</span>))</span>
<span id="cb561-3"><a href="dv-plot.html#cb561-3"></a>  <span class="kw">plot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species)</span>
<span id="cb561-4"><a href="dv-plot.html#cb561-4"></a>  <span class="kw">plot</span>(Sepal.Width <span class="op">~</span><span class="st"> </span>Species)</span>
<span id="cb561-5"><a href="dv-plot.html#cb561-5"></a>  <span class="kw">plot</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species)</span>
<span id="cb561-6"><a href="dv-plot.html#cb561-6"></a>  <span class="kw">plot</span>(Petal.Width <span class="op">~</span><span class="st"> </span>Species)</span>
<span id="cb561-7"><a href="dv-plot.html#cb561-7"></a>  <span class="kw">par</span>(op)</span>
<span id="cb561-8"><a href="dv-plot.html#cb561-8"></a>  <span class="kw">mtext</span>(<span class="st">&quot;Edgar Anderson&#39;s Iris Data&quot;</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">4</span>)</span>
<span id="cb561-9"><a href="dv-plot.html#cb561-9"></a>})</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:iris"></span>
<img src="dv-plot_files/figure-html/iris-1.png" alt="安德森的鸢尾花数据" width="70%" />
<p class="caption">
图 11.50: 安德森的鸢尾花数据
</p>
</div>
<p>箱线图的花样也很多</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="dv-plot.html#cb562-1"></a><span class="kw">boxplot</span>(longley<span class="op">$</span>Unemployed)</span>
<span id="cb562-2"><a href="dv-plot.html#cb562-2"></a><span class="co"># 水平放置</span></span>
<span id="cb562-3"><a href="dv-plot.html#cb562-3"></a><span class="kw">boxplot</span>(longley<span class="op">$</span>Unemployed,</span>
<span id="cb562-4"><a href="dv-plot.html#cb562-4"></a>  <span class="dt">horizontal =</span> <span class="ot">TRUE</span>,</span>
<span id="cb562-5"><a href="dv-plot.html#cb562-5"></a>  <span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>,</span>
<span id="cb562-6"><a href="dv-plot.html#cb562-6"></a>  <span class="dt">main =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb562-7"><a href="dv-plot.html#cb562-7"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-62-1.png" width="70%" style="display: block; margin: auto;" /><img src="dv-plot_files/figure-html/unnamed-chunk-62-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="dv-plot.html#cb563-1"></a><span class="kw">data</span>(InsectSprays)</span>
<span id="cb563-2"><a href="dv-plot.html#cb563-2"></a><span class="kw">boxplot</span>(count <span class="op">~</span><span class="st"> </span>spray,</span>
<span id="cb563-3"><a href="dv-plot.html#cb563-3"></a>  <span class="dt">data =</span> InsectSprays,</span>
<span id="cb563-4"><a href="dv-plot.html#cb563-4"></a>  <span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>,</span>
<span id="cb563-5"><a href="dv-plot.html#cb563-5"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Spray&quot;</span>,</span>
<span id="cb563-6"><a href="dv-plot.html#cb563-6"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Count&quot;</span>,</span>
<span id="cb563-7"><a href="dv-plot.html#cb563-7"></a>  <span class="dt">main =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb563-8"><a href="dv-plot.html#cb563-8"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-63-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>水平放置</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="dv-plot.html#cb564-1"></a><span class="kw">boxplot</span>(count <span class="op">~</span><span class="st"> </span>spray,</span>
<span id="cb564-2"><a href="dv-plot.html#cb564-2"></a>  <span class="dt">data =</span> InsectSprays,</span>
<span id="cb564-3"><a href="dv-plot.html#cb564-3"></a>  <span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>,</span>
<span id="cb564-4"><a href="dv-plot.html#cb564-4"></a>  <span class="dt">horizontal =</span> <span class="ot">TRUE</span>,</span>
<span id="cb564-5"><a href="dv-plot.html#cb564-5"></a>  <span class="dt">las =</span> <span class="dv">1</span>, <span class="co"># Horizontal labels</span></span>
<span id="cb564-6"><a href="dv-plot.html#cb564-6"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Count&quot;</span>,</span>
<span id="cb564-7"><a href="dv-plot.html#cb564-7"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Spray&quot;</span>,</span>
<span id="cb564-8"><a href="dv-plot.html#cb564-8"></a>  <span class="dt">main =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb564-9"><a href="dv-plot.html#cb564-9"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-64-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Notched Boxplots</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="dv-plot.html#cb565-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb565-2"><a href="dv-plot.html#cb565-2"></a>n &lt;-<span class="st"> </span><span class="dv">8</span></span>
<span id="cb565-3"><a href="dv-plot.html#cb565-3"></a>g &lt;-<span class="st"> </span><span class="kw">gl</span>(n, <span class="dv">100</span>, n <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="co"># n水平个数 100是重复次数</span></span>
<span id="cb565-4"><a href="dv-plot.html#cb565-4"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">as.numeric</span>(g))</span>
<span id="cb565-5"><a href="dv-plot.html#cb565-5"></a><span class="kw">boxplot</span>(<span class="kw">split</span>(x, g), <span class="dt">col =</span> <span class="kw">hcl.colors</span>(n), <span class="dt">notch =</span> <span class="ot">TRUE</span>)</span>
<span id="cb565-6"><a href="dv-plot.html#cb565-6"></a><span class="kw">title</span>(</span>
<span id="cb565-7"><a href="dv-plot.html#cb565-7"></a>  <span class="dt">main =</span> <span class="st">&quot;Notched Boxplots&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb565-8"><a href="dv-plot.html#cb565-8"></a>  <span class="dt">font.main =</span> <span class="dv">4</span>, <span class="dt">font.lab =</span> <span class="dv">1</span></span>
<span id="cb565-9"><a href="dv-plot.html#cb565-9"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-65-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>真实的情况是这样的</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="dv-plot.html#cb566-1"></a>cumcm2011A &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;cumcm2011A.RDS&quot;</span>)</span>
<span id="cb566-2"><a href="dv-plot.html#cb566-2"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb566-3"><a href="dv-plot.html#cb566-3"></a><span class="kw">with</span>(cumcm2011A, <span class="kw">boxplot</span>(As, <span class="dt">xlab =</span> <span class="st">&quot;As&quot;</span>))</span>
<span id="cb566-4"><a href="dv-plot.html#cb566-4"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="fl">1.8</span>, <span class="fl">3.6</span>, <span class="fl">5.4</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb566-5"><a href="dv-plot.html#cb566-5"></a></span>
<span id="cb566-6"><a href="dv-plot.html#cb566-6"></a><span class="kw">with</span>(cumcm2011A, <span class="kw">boxplot</span>(Cd, <span class="dt">xlab =</span> <span class="st">&quot;Cd&quot;</span>))</span>
<span id="cb566-7"><a href="dv-plot.html#cb566-7"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="dv">70</span>, <span class="dv">130</span>, <span class="dv">190</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb566-8"><a href="dv-plot.html#cb566-8"></a></span>
<span id="cb566-9"><a href="dv-plot.html#cb566-9"></a><span class="kw">with</span>(cumcm2011A, <span class="kw">boxplot</span>(Cr, <span class="dt">xlab =</span> <span class="st">&quot;Cr&quot;</span>))</span>
<span id="cb566-10"><a href="dv-plot.html#cb566-10"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">31</span>, <span class="dv">49</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb566-11"><a href="dv-plot.html#cb566-11"></a></span>
<span id="cb566-12"><a href="dv-plot.html#cb566-12"></a><span class="kw">with</span>(cumcm2011A, <span class="kw">boxplot</span>(Cu, <span class="dt">xlab =</span> <span class="st">&quot;Cu&quot;</span>))</span>
<span id="cb566-13"><a href="dv-plot.html#cb566-13"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="fl">6.0</span>, <span class="fl">13.2</span>, <span class="fl">20.4</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb566-14"><a href="dv-plot.html#cb566-14"></a></span>
<span id="cb566-15"><a href="dv-plot.html#cb566-15"></a><span class="kw">with</span>(cumcm2011A, <span class="kw">boxplot</span>(Hg, <span class="dt">xlab =</span> <span class="st">&quot;Hg&quot;</span>))</span>
<span id="cb566-16"><a href="dv-plot.html#cb566-16"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">35</span>, <span class="dv">51</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb566-17"><a href="dv-plot.html#cb566-17"></a></span>
<span id="cb566-18"><a href="dv-plot.html#cb566-18"></a><span class="kw">with</span>(cumcm2011A, <span class="kw">boxplot</span>(Ni, <span class="dt">xlab =</span> <span class="st">&quot;Ni&quot;</span>))</span>
<span id="cb566-19"><a href="dv-plot.html#cb566-19"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="fl">4.7</span>, <span class="fl">12.3</span>, <span class="fl">19.9</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb566-20"><a href="dv-plot.html#cb566-20"></a></span>
<span id="cb566-21"><a href="dv-plot.html#cb566-21"></a><span class="kw">with</span>(cumcm2011A, <span class="kw">boxplot</span>(Pb, <span class="dt">xlab =</span> <span class="st">&quot;Pb&quot;</span>))</span>
<span id="cb566-22"><a href="dv-plot.html#cb566-22"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">31</span>, <span class="dv">43</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb566-23"><a href="dv-plot.html#cb566-23"></a></span>
<span id="cb566-24"><a href="dv-plot.html#cb566-24"></a><span class="kw">with</span>(cumcm2011A, <span class="kw">boxplot</span>(Zn, <span class="dt">xlab =</span> <span class="st">&quot;Zn&quot;</span>))</span>
<span id="cb566-25"><a href="dv-plot.html#cb566-25"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="dv">41</span>, <span class="dv">69</span>, <span class="dv">97</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-66-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="dv-plot.html#cb567-1"></a><span class="kw">boxplot</span>(As <span class="op">~</span><span class="st"> </span>area,</span>
<span id="cb567-2"><a href="dv-plot.html#cb567-2"></a>  <span class="dt">data =</span> cumcm2011A,</span>
<span id="cb567-3"><a href="dv-plot.html#cb567-3"></a>  <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">5</span>)</span>
<span id="cb567-4"><a href="dv-plot.html#cb567-4"></a>)</span>
<span id="cb567-5"><a href="dv-plot.html#cb567-5"></a><span class="kw">abline</span>(</span>
<span id="cb567-6"><a href="dv-plot.html#cb567-6"></a>  <span class="dt">h =</span> <span class="kw">c</span>(<span class="fl">1.8</span>, <span class="fl">3.6</span>, <span class="fl">5.4</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb567-7"><a href="dv-plot.html#cb567-7"></a>  <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span></span>
<span id="cb567-8"><a href="dv-plot.html#cb567-8"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-67-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="error-bars" class="section level3">
<h3><span class="header-section-number">11.2.12</span> 残差图</h3>
<p>iris 四个测量指标</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="dv-plot.html#cb568-1"></a>vec_mean &lt;-<span class="st"> </span><span class="kw">colMeans</span>(iris[, <span class="dv">-5</span>])</span>
<span id="cb568-2"><a href="dv-plot.html#cb568-2"></a>vec_sd &lt;-<span class="st"> </span><span class="kw">apply</span>(iris[, <span class="dv">-5</span>], <span class="dv">2</span>, sd)</span>
<span id="cb568-3"><a href="dv-plot.html#cb568-3"></a><span class="kw">plot</span>(<span class="kw">seq</span>(<span class="dv">4</span>), vec_mean,</span>
<span id="cb568-4"><a href="dv-plot.html#cb568-4"></a>  <span class="dt">ylim =</span> <span class="kw">range</span>(<span class="kw">c</span>(vec_mean <span class="op">-</span><span class="st"> </span>vec_sd, vec_mean <span class="op">+</span><span class="st"> </span>vec_sd)),</span>
<span id="cb568-5"><a href="dv-plot.html#cb568-5"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Species&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Mean +/- SD&quot;</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">19</span>,</span>
<span id="cb568-6"><a href="dv-plot.html#cb568-6"></a>  <span class="dt">axes =</span> <span class="ot">FALSE</span></span>
<span id="cb568-7"><a href="dv-plot.html#cb568-7"></a>)</span>
<span id="cb568-8"><a href="dv-plot.html#cb568-8"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">4</span>), <span class="dt">labels =</span> <span class="kw">colnames</span>(iris)[<span class="op">-</span><span class="dv">5</span>])</span>
<span id="cb568-9"><a href="dv-plot.html#cb568-9"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">7</span>), <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">7</span>))</span>
<span id="cb568-10"><a href="dv-plot.html#cb568-10"></a><span class="kw">arrows</span>(<span class="kw">seq</span>(<span class="dv">4</span>), vec_mean <span class="op">-</span><span class="st"> </span>vec_sd, <span class="kw">seq</span>(<span class="dv">4</span>), vec_mean <span class="op">+</span><span class="st"> </span>vec_sd,</span>
<span id="cb568-11"><a href="dv-plot.html#cb568-11"></a>  <span class="dt">length =</span> <span class="fl">0.05</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">code =</span> <span class="dv">3</span></span>
<span id="cb568-12"><a href="dv-plot.html#cb568-12"></a>)</span>
<span id="cb568-13"><a href="dv-plot.html#cb568-13"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-68"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-68-1.png" alt="带标准差的均值散点图" width="70%" />
<p class="caption">
图 11.51: 带标准差的均值散点图
</p>
</div>
</div>
<div id="plot-violin" class="section level3">
<h3><span class="header-section-number">11.2.13</span> 提琴图</h3>
<p>Tom Kelly 维护的 vioplot 包 <a href="https://github.com/TomKellyGenetics/vioplot" class="uri">https://github.com/TomKellyGenetics/vioplot</a></p>
</div>
<div id="plot-contour" class="section level3">
<h3><span class="header-section-number">11.2.14</span> 轮廓图</h3>
<p>topo 是地形数据</p>
<p>等高线图</p>
</div>
<div id="plot-line" class="section level3">
<h3><span class="header-section-number">11.2.15</span> 折线图</h3>
<p>函数曲线，样条曲线，核密度曲线，平行坐标图</p>
<ul>
<li>折线图</li>
<li>点线图 <code>plot(type="b")</code> 函数曲线图 <code>curve</code> <code>matplot</code> X 样条曲线 <code>xspline</code></li>
<li>时序图</li>
</ul>
<p>太阳黑子活动数据</p>
<p>sunspot.month Monthly Sunspot Data, from 1749 to “Present”
sunspot.year Yearly Sunspot Data, 1700-1988
sunspots Monthly Sunspot Numbers, 1749-1983</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="dv-plot.html#cb569-1"></a><span class="kw">plot</span>(AirPassengers)</span>
<span id="cb569-2"><a href="dv-plot.html#cb569-2"></a><span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-69"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-69-1.png" alt="折线图" width="70%" />
<p class="caption">
图 11.52: 折线图
</p>
</div>
</div>
<div id="function" class="section level3">
<h3><span class="header-section-number">11.2.16</span> 函数图</h3>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="dv-plot.html#cb570-1"></a><span class="kw">library</span>(pracma)</span>
<span id="cb570-2"><a href="dv-plot.html#cb570-2"></a><span class="co">##  First zero on the critical line s = 0.5 + i t</span></span>
<span id="cb570-3"><a href="dv-plot.html#cb570-3"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dt">len =</span> <span class="dv">1001</span>)</span>
<span id="cb570-4"><a href="dv-plot.html#cb570-4"></a>z &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>1i</span>
<span id="cb570-5"><a href="dv-plot.html#cb570-5"></a>fr &lt;-<span class="st"> </span><span class="kw">Re</span>(<span class="kw">zeta</span>(z))</span>
<span id="cb570-6"><a href="dv-plot.html#cb570-6"></a>fi &lt;-<span class="st"> </span><span class="kw">Im</span>(<span class="kw">zeta</span>(z))</span>
<span id="cb570-7"><a href="dv-plot.html#cb570-7"></a>fa &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">zeta</span>(z))</span>
<span id="cb570-8"><a href="dv-plot.html#cb570-8"></a><span class="kw">plot</span>(x, fa,</span>
<span id="cb570-9"><a href="dv-plot.html#cb570-9"></a>  <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">2.5</span>),</span>
<span id="cb570-10"><a href="dv-plot.html#cb570-10"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Imaginary part (on critical line)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Function value&quot;</span>,</span>
<span id="cb570-11"><a href="dv-plot.html#cb570-11"></a>  <span class="dt">main =</span> <span class="st">&quot;Riemann&#39;s Zeta Function along the critical line&quot;</span></span>
<span id="cb570-12"><a href="dv-plot.html#cb570-12"></a>)</span>
<span id="cb570-13"><a href="dv-plot.html#cb570-13"></a><span class="kw">grid</span>()</span>
<span id="cb570-14"><a href="dv-plot.html#cb570-14"></a><span class="kw">lines</span>(x, fr, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb570-15"><a href="dv-plot.html#cb570-15"></a><span class="kw">lines</span>(x, fi, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb570-16"><a href="dv-plot.html#cb570-16"></a><span class="kw">lines</span>(x, fa, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb570-17"><a href="dv-plot.html#cb570-17"></a><span class="kw">points</span>(<span class="fl">14.1347</span>, <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb570-18"><a href="dv-plot.html#cb570-18"></a><span class="kw">legend</span>(<span class="dv">0</span>, <span class="fl">2.4</span>, <span class="kw">c</span>(<span class="st">&quot;real part&quot;</span>, <span class="st">&quot;imaginary part&quot;</span>, <span class="st">&quot;absolute value&quot;</span>),</span>
<span id="cb570-19"><a href="dv-plot.html#cb570-19"></a>  <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb570-20"><a href="dv-plot.html#cb570-20"></a>)</span></code></pre></div>
<p><img src="dv-plot_files/figure-html/unnamed-chunk-70-1.png" width="65%" style="display: block; margin: auto;" /></p>
<p>还有 eta 函数和 gammaz 函数</p>
</div>
<div id="plot-mosaic" class="section level3">
<h3><span class="header-section-number">11.2.17</span> 马赛克图</h3>
<p>马赛克图 mosaicplot</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="dv-plot.html#cb571-1"></a><span class="kw">plot</span>(HairEyeColor, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-71"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-71-1.png" alt="马赛克图" width="70%" />
<p class="caption">
图 11.53: 马赛克图
</p>
</div>
</div>
<div id="plot-dotchart" class="section level3">
<h3><span class="header-section-number">11.2.18</span> 克利夫兰点图</h3>
<p>dotchart</p>
<p>条件图 coplot</p>
</div>
<div id="plot-matrix" class="section level3">
<h3><span class="header-section-number">11.2.19</span> 矩阵图</h3>
<p>在对角线上添加平滑曲线、密度曲线</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="dv-plot.html#cb572-1"></a><span class="kw">pairs</span>(longley,</span>
<span id="cb572-2"><a href="dv-plot.html#cb572-2"></a>  <span class="dt">gap =</span> <span class="dv">0</span>,</span>
<span id="cb572-3"><a href="dv-plot.html#cb572-3"></a>  <span class="dt">diag.panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb572-4"><a href="dv-plot.html#cb572-4"></a>    <span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">TRUE</span>)</span>
<span id="cb572-5"><a href="dv-plot.html#cb572-5"></a>    <span class="kw">hist</span>(x,</span>
<span id="cb572-6"><a href="dv-plot.html#cb572-6"></a>      <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>,</span>
<span id="cb572-7"><a href="dv-plot.html#cb572-7"></a>      <span class="dt">probability =</span> <span class="ot">TRUE</span>,</span>
<span id="cb572-8"><a href="dv-plot.html#cb572-8"></a>      <span class="dt">axes =</span> <span class="ot">FALSE</span>,</span>
<span id="cb572-9"><a href="dv-plot.html#cb572-9"></a>      <span class="dt">main =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb572-10"><a href="dv-plot.html#cb572-10"></a>    )</span>
<span id="cb572-11"><a href="dv-plot.html#cb572-11"></a>    <span class="kw">lines</span>(<span class="kw">density</span>(x),</span>
<span id="cb572-12"><a href="dv-plot.html#cb572-12"></a>      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb572-13"><a href="dv-plot.html#cb572-13"></a>      <span class="dt">lwd =</span> <span class="dv">3</span></span>
<span id="cb572-14"><a href="dv-plot.html#cb572-14"></a>    )</span>
<span id="cb572-15"><a href="dv-plot.html#cb572-15"></a>    <span class="kw">rug</span>(x)</span>
<span id="cb572-16"><a href="dv-plot.html#cb572-16"></a>  }</span>
<span id="cb572-17"><a href="dv-plot.html#cb572-17"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-72"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-72-1.png" alt="变量关系" width="70%" />
<p class="caption">
图 11.54: 变量关系
</p>
</div>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="dv-plot.html#cb573-1"></a><span class="co"># 自带 layout</span></span>
<span id="cb573-2"><a href="dv-plot.html#cb573-2"></a><span class="kw">plot</span>(iris[, <span class="dv">-5</span>], <span class="dt">col =</span> iris<span class="op">$</span>Species)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-73"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-73-1.png" alt="矩阵图" width="70%" />
<p class="caption">
图 11.55: 矩阵图
</p>
</div>
</div>
<div id="plot-radar" class="section level3">
<h3><span class="header-section-number">11.2.20</span> 雷达图</h3>
<p>星图 stars 多元数据</p>
</div>
<div id="plot-rose" class="section level3">
<h3><span class="header-section-number">11.2.21</span> 玫瑰图</h3>
</div>
<div id="plot-map" class="section level3">
<h3><span class="header-section-number">11.2.22</span> 地形图</h3>
<ul>
<li>轮廓图 contour 等高线图</li>
<li>热图 image</li>
</ul>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="dv-plot.html#cb574-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="st">&quot;spDataLarge&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">.packages</span>(<span class="ot">TRUE</span>)) {</span>
<span id="cb574-2"><a href="dv-plot.html#cb574-2"></a>  <span class="kw">install.packages</span>(<span class="st">&quot;spDataLarge&quot;</span>,</span>
<span id="cb574-3"><a href="dv-plot.html#cb574-3"></a>    <span class="dt">repos =</span> <span class="st">&quot;https://nowosad.github.io/drat/&quot;</span>,</span>
<span id="cb574-4"><a href="dv-plot.html#cb574-4"></a>    <span class="dt">type =</span> <span class="st">&quot;source&quot;</span></span>
<span id="cb574-5"><a href="dv-plot.html#cb574-5"></a>  )</span>
<span id="cb574-6"><a href="dv-plot.html#cb574-6"></a>}</span></code></pre></div>
<p>raster 图形，Elevation raster data from SRTM of the Zion National Park area</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="dv-plot.html#cb575-1"></a><span class="kw">library</span>(sp)</span>
<span id="cb575-2"><a href="dv-plot.html#cb575-2"></a><span class="kw">library</span>(raster)</span>
<span id="cb575-3"><a href="dv-plot.html#cb575-3"></a><span class="kw">library</span>(spDataLarge)</span>
<span id="cb575-4"><a href="dv-plot.html#cb575-4"></a><span class="kw">plot</span>(elevation, <span class="dt">asp =</span> <span class="ot">NA</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-75"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-75-1.png" alt="raster 图形" width="70%" />
<p class="caption">
图 11.56: raster 图形
</p>
</div>
<p>注意与 image 函数区别</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="dv-plot.html#cb576-1"></a><span class="co"># A prettier display of the volcano</span></span>
<span id="cb576-2"><a href="dv-plot.html#cb576-2"></a>x &lt;-<span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(volcano))</span>
<span id="cb576-3"><a href="dv-plot.html#cb576-3"></a>y &lt;-<span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(volcano))</span>
<span id="cb576-4"><a href="dv-plot.html#cb576-4"></a><span class="kw">image</span>(x, y, volcano, <span class="dt">col =</span> <span class="kw">terrain.colors</span>(<span class="dv">100</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span>)</span>
<span id="cb576-5"><a href="dv-plot.html#cb576-5"></a><span class="kw">contour</span>(x, y, volcano,</span>
<span id="cb576-6"><a href="dv-plot.html#cb576-6"></a>  <span class="dt">levels =</span> <span class="kw">seq</span>(<span class="dv">90</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">5</span>),</span>
<span id="cb576-7"><a href="dv-plot.html#cb576-7"></a>  <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;peru&quot;</span></span>
<span id="cb576-8"><a href="dv-plot.html#cb576-8"></a>)</span>
<span id="cb576-9"><a href="dv-plot.html#cb576-9"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">800</span>, <span class="dt">by =</span> <span class="dv">100</span>))</span>
<span id="cb576-10"><a href="dv-plot.html#cb576-10"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">600</span>, <span class="dt">by =</span> <span class="dv">100</span>))</span>
<span id="cb576-11"><a href="dv-plot.html#cb576-11"></a><span class="kw">box</span>()</span>
<span id="cb576-12"><a href="dv-plot.html#cb576-12"></a><span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Maunga Whau Volcano&quot;</span>, <span class="dt">font.main =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-76"></span>
<img src="dv-plot_files/figure-html/unnamed-chunk-76-1.png" alt="image 图形" width="70%" />
<p class="caption">
图 11.57: image 图形
</p>
</div>
</div>
</div>
<div id="plot-session-info" class="section level2">
<h2><span class="header-section-number">11.3</span> 运行环境</h2>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="dv-plot.html#cb577-1"></a>xfun<span class="op">::</span><span class="kw">session_info</span>()</span>
<span id="cb577-2"><a href="dv-plot.html#cb577-2"></a><span class="co">#&gt; R version 4.0.0 (2020-04-24)</span></span>
<span id="cb577-3"><a href="dv-plot.html#cb577-3"></a><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span id="cb577-4"><a href="dv-plot.html#cb577-4"></a><span class="co">#&gt; Running under: Ubuntu 16.04.6 LTS</span></span>
<span id="cb577-5"><a href="dv-plot.html#cb577-5"></a><span class="co">#&gt; </span></span>
<span id="cb577-6"><a href="dv-plot.html#cb577-6"></a><span class="co">#&gt; Locale:</span></span>
<span id="cb577-7"><a href="dv-plot.html#cb577-7"></a><span class="co">#&gt;   LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span id="cb577-8"><a href="dv-plot.html#cb577-8"></a><span class="co">#&gt;   LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span id="cb577-9"><a href="dv-plot.html#cb577-9"></a><span class="co">#&gt;   LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span id="cb577-10"><a href="dv-plot.html#cb577-10"></a><span class="co">#&gt;   LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span id="cb577-11"><a href="dv-plot.html#cb577-11"></a><span class="co">#&gt;   LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span id="cb577-12"><a href="dv-plot.html#cb577-12"></a><span class="co">#&gt;   LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span id="cb577-13"><a href="dv-plot.html#cb577-13"></a><span class="co">#&gt; </span></span>
<span id="cb577-14"><a href="dv-plot.html#cb577-14"></a><span class="co">#&gt; Package version:</span></span>
<span id="cb577-15"><a href="dv-plot.html#cb577-15"></a><span class="co">#&gt;   base64enc_0.1.3    bookdown_0.20      codetools_0.2-16  </span></span>
<span id="cb577-16"><a href="dv-plot.html#cb577-16"></a><span class="co">#&gt;   compiler_4.0.0     curl_4.3           digest_0.6.25     </span></span>
<span id="cb577-17"><a href="dv-plot.html#cb577-17"></a><span class="co">#&gt;   evaluate_0.14      glue_1.4.1         graphics_4.0.0    </span></span>
<span id="cb577-18"><a href="dv-plot.html#cb577-18"></a><span class="co">#&gt;   grDevices_4.0.0    grid_4.0.0         highr_0.8         </span></span>
<span id="cb577-19"><a href="dv-plot.html#cb577-19"></a><span class="co">#&gt;   htmltools_0.5.0    jsonlite_1.7.0     KernSmooth_2.23-16</span></span>
<span id="cb577-20"><a href="dv-plot.html#cb577-20"></a><span class="co">#&gt;   knitr_1.29         lattice_0.20-41    magrittr_1.5      </span></span>
<span id="cb577-21"><a href="dv-plot.html#cb577-21"></a><span class="co">#&gt;   markdown_1.1       MASS_7.3-51.5      Matrix_1.2-18     </span></span>
<span id="cb577-22"><a href="dv-plot.html#cb577-22"></a><span class="co">#&gt;   methods_4.0.0      mime_0.9           pracma_2.2.9      </span></span>
<span id="cb577-23"><a href="dv-plot.html#cb577-23"></a><span class="co">#&gt;   raster_3.3-7       Rcpp_1.0.5         rlang_0.4.6       </span></span>
<span id="cb577-24"><a href="dv-plot.html#cb577-24"></a><span class="co">#&gt;   rmarkdown_2.3      sp_1.4-2           spDataLarge_0.4.1 </span></span>
<span id="cb577-25"><a href="dv-plot.html#cb577-25"></a><span class="co">#&gt;   splines_4.0.0      stats_4.0.0        stringi_1.4.6     </span></span>
<span id="cb577-26"><a href="dv-plot.html#cb577-26"></a><span class="co">#&gt;   stringr_1.4.0      survival_3.1-12    tinytex_0.24      </span></span>
<span id="cb577-27"><a href="dv-plot.html#cb577-27"></a><span class="co">#&gt;   tools_4.0.0        utils_4.0.0        xfun_0.15         </span></span>
<span id="cb577-28"><a href="dv-plot.html#cb577-28"></a><span class="co">#&gt;   yaml_2.2.1</span></span></code></pre></div>

</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references">
<div id="ref-R-FAQ">
<p>Hornik, Kurt. 2018. “R FAQ.” <a href="https://CRAN.R-project.org/doc/FAQ/R-FAQ.html">https://CRAN.R-project.org/doc/FAQ/R-FAQ.html</a>.</p>
</div>
<div id="ref-Paul_2003_Integrating">
<p>Murrell, Paul. 2003. “Integrating Grid Graphics Output with Base Graphics Output.” <em>R News</em> 3 (2): 7–12.</p>
</div>
<div id="ref-Paul_2000_Approach">
<p>Murrell, Paul, and Ross Ihaka. 2000. “An Approach to Providing Mathematical Annotation in Plots.” <em>Journal of Computational and Graphical Statistics</em> 9 (3): 582–99.</p>
</div>
</div>
<script>
window.onload = function() {

  var imgs = document.querySelectorAll('img');

  // Upon clicking an image, open a new window with the
  // dimensions of the image, pointing the `data-url` link
  var on_click = function (e) {
    var d = e.target.dataset || {};
    if (d.url) {
      // Add some extra height for the modebar
      var height = 'height=' + (e.target.clientHeight * 1.05);
      var width = 'width=' + e.target.clientWidth;
      var param = 'location=yes,' + height + ',' + width + ',scrollbars=yes,status=yes';
      window.open(e.target.dataset.url, '_blank', param);
    }
  };

  var on_hover = function (e) {
    var d = e.target.dataset || {};
    if (d.url) {
      e.target.style.cursor = 'pointer';
    }
  };

  for (var i = 0; i < imgs.length; i++) {
    imgs[i].addEventListener('click', on_click);
    imgs[i].addEventListener('mouseover', on_hover);
  }
};
</script>
            </section>

          </div>
        </div>
      </div>
<a href="dc-regular-expressions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dv-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XiangyunHuang/RGraphics/edit/master/dv-plot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r4ds.pdf", "r4ds.epub", "r4ds.mobi", "https://github.com/XiangyunHuang/RGraphics/raw/master/dv-plot.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
